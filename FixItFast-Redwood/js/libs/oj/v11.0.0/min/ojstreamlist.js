/**
 * @license
 * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","preact","ojs/ojvcomponent","ojs/ojdatacollection-common","ojs/ojvcollection","ojs/ojcontext","ojs/ojcore-base","ojs/ojkeyset","ojs/ojtreedataprovider","ojs/ojanimation","ojs/ojthemeutils","ojs/ojdomutils"],function(e,t,s,n,o,i,r,l,a,c,h,d){"use strict";i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;class u extends o.IteratingDataProviderContentHandler{constructor(e,t,s,n,o){super(e,t,s,n,o),this.root=e,this.dataProvider=t,this.callback=s,this.scrollPolicy=n,this.scrollPolicyOptions=o,this.postRender=()=>{if(this.vnodesCache=this.newVnodesCache,this.newVnodesCache=new Map,this.callback){if(this.domScroller){const e=this.root.lastElementChild.querySelectorAll(".oj-stream-list-item");if(e.length>0){const t=this.root.offsetTop,s=e[0].offsetTop-t,n=e[e.length-1].offsetTop+e[e.length-1].offsetHeight-t;this.domScroller.setViewportRange(s,n)}}if(this.domScroller&&!this.domScroller.checkViewport())return}},this.newItemsTracker=new Set,this.vnodesCache=new Map,this.newVnodesCache=new Map}fetchSuccess(e){null!=e&&this.newItemsTracker.clear(),super.fetchSuccess(e)}handleItemsUpdated(e){e.keys.forEach(function(e){this.vnodesCache.delete(e)}.bind(this)),super.handleItemsUpdated(e)}handleItemsRemoved(e){e.keys.forEach(function(e){this.vnodesCache.delete(e)}.bind(this)),super.handleItemsRemoved(e)}handleModelRefresh(){this.vnodesCache.clear(),super.handleModelRefresh()}addItem(e,t,s,n){const o=this.isInitialFetch();null==this.callback.getCurrentItem()&&o&&0==t&&this.callback.setCurrentItem(e);const i=this.renderItem(e,t,s);return this.decorateItem(i,e,t,o,n),i}renderItem(e,t,s){const n=this.callback.getItemRenderer()({data:s,key:e});let o;for(const e of n)if(o=e,o.props)break;const i=[o];return this.newVnodesCache.set(e,{vnodes:i}),i}decorateItem(e,t,s,n,o){const i=e[0];if(null!=i){i.key=t,i.props.role="listitem",i.props.tabIndex=-1,i.props["data-oj-key"]=t,"number"==typeof t&&(i.props["data-oj-key-type"]="number");const e=this.getItemStyleClass(o,this.newItemsTracker.has(t),n),s=i.props.className?"className":"class",r=i.props[s]?[i.props[s],...e]:e;i.props[s]=r.join(" ")}}getItemStyleClass(e,t,s){const n=[];return n.push("oj-stream-list-item"),n}renderSkeletonsForLoadMore(){return this.callback.renderSkeletons(3)}}class p extends o.IteratingTreeDataProviderContentHandler{constructor(e,t,s,n,o){super(e,t,s,n,o),this.root=e,this.dataProvider=t,this.callback=s,this.scrollPolicy=n,this.scrollPolicyOptions=o,this.postRender=()=>{this.vnodesCache=this.newVnodesCache,this.newVnodesCache=new Map;this.root.lastElementChild&&this.checkViewport()},this.getLoadMoreCount=()=>3,this.newItemsTracker=new Set,this.vnodesCache=new Map,this.newVnodesCache=new Map}handleFetchSuccess(e){null!=e&&this.newItemsTracker.clear(),super.handleFetchSuccess(e)}handleItemsUpdated(e){e.keys.forEach(function(e){this.vnodesCache.delete(e)}.bind(this)),super.handleItemsUpdated(e)}handleItemsRemoved(e){e.keys.forEach(function(e){this.vnodesCache.delete(e)}.bind(this)),super.handleItemsRemoved(e)}handleModelRefresh(){this.vnodesCache.clear(),super.handleModelRefresh()}destroy(){super.destroy(),this._resolveCheckViewportBusyState()}_resolveCheckViewportBusyState(){this.viewportResolveFunc&&this.viewportResolveFunc(),this.viewportResolveFunc=null}checkViewport(){if(this.viewportResolveFunc)return;this.viewportResolveFunc=this.addBusyState("checking viewport");const e=this.root.lastElementChild;if(e){i.getContext(e).getBusyContext().whenReady().then(()=>{null!=this.callback&&(super.checkViewport(),this._resolveCheckViewportBusyState())},()=>{this._resolveCheckViewportBusyState()})}}addItem(e,t,s,n){const o=this.isInitialFetch();null==this.callback.getCurrentItem()&&o&&0==t&&this.callback.setCurrentItem(e.key);const i=this.renderItem(e,t,s);return this.decorateItem(i,e,t,o,n),i}renderItem(e,t,s){const n=e.key;let o,i,r;!1===e.isLeaf&&(o=this.callback.getGroupRenderer()),null==o&&(o=this.callback.getItemRenderer()),i=o({data:s,key:e.key,leaf:e.isLeaf,parentKey:e.parentKey,depth:e.treeDepth});for(const e of i)if(r=e,r.props)break;const l=[r];return this.newVnodesCache.set(n,{vnodes:l}),l}decorateItem(e,t,s,n,o){const i=e[0];if(null!=i){i.key=t.key,i.props.role="listitem",i.props.tabIndex=-1,i.props["data-oj-key"]=t.key,"number"==typeof t.key&&(i.props["data-oj-key-type"]="number");const e=this.getItemStyleClass(t,o,this.newItemsTracker.has(t.key),n),s=i.props.className?"className":"class",r=i.props[s]?[i.props[s],...e]:e;if(i.props[s]=r.join(" "),!t.isLeaf){const e=this.callback.getExpanded(),s=e&&e.has(t.key);i.props["aria-expanded"]=!!s}}}getItemStyleClass(e,t,s,n){const o=[];return e.isLeaf?o.push("oj-stream-list-item"):o.push("oj-stream-list-group"),o}renderSkeletonsForLoadMore(){return this.callback.renderSkeletons(3)}renderSkeletonsForExpand(e){return this.callback.renderSkeletons(this.getLoadMoreCount(),!0,e)}}var m,y=function(e,t,s,n){var o,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(r=(i<3?o(r):i>3?o(t,s,r):o(t,s))||r);return i>3&&r&&Object.defineProperty(t,s,r),r};e.StreamList=m=class extends t.Component{constructor(e){super(e),this.restoreFocus=!1,this.actionableMode=!1,this.skeletonHeight=0,this.height=0,this._handleFocusIn=e=>{this._clearFocusoutTimeout();const t=e.target,s=t.closest(".oj-stream-list-item, .oj-stream-list-group");s&&this._isFocusable(t,s)?this._enterActionableMode(t):this.currentItem&&!this.actionableMode&&this.focusInHandler(this.currentItem)},this._handleFocusOut=()=>{this._clearFocusoutTimeout(),this.actionableMode?this._focusoutTimeout=setTimeout(function(){this._doBlur()}.bind(this),100):this._isFocusBlurTriggeredByDescendent(event)||this._doBlur()},this._handleClick=e=>{const t=e.target.closest("."+this.getGroupStyleClass());if(t){const e=this.contentHandler.getKey(t),s=this.props.expanded.has(e);this._handleToggleExpanded(e,s)}this._handleTouchOrClickEvent(e)},this._handleKeyDown=e=>{if(this.currentItem){let t;switch(e.key){case n.KEYBOARD_KEYS._LEFT:case n.KEYBOARD_KEYS._LEFT_IE:case n.KEYBOARD_KEYS._RIGHT:case n.KEYBOARD_KEYS._RIGHT_IE:if(this.currentItem.classList.contains(this.getGroupStyleClass())){const t=this.currentItem,s=this.contentHandler.getKey(t),o=this.props.expanded.has(s);(e.key!==n.KEYBOARD_KEYS._RIGHT&&e.key!==n.KEYBOARD_KEYS._RIGHT_IE||o)&&(e.key!==n.KEYBOARD_KEYS._LEFT&&e.key!==n.KEYBOARD_KEYS._LEFT_IE||!o)||this._handleToggleExpanded(s,o)}break;case n.KEYBOARD_KEYS._UP:case n.KEYBOARD_KEYS._UP_IE:if(!1===this.actionableMode)for(t=this.currentItem.previousElementSibling;t&&t.previousElementSibling&&t.classList.contains("oj-stream-list-skeleton");)t=t.previousElementSibling;break;case n.KEYBOARD_KEYS._DOWN:case n.KEYBOARD_KEYS._DOWN_IE:if(!1===this.actionableMode)for(t=this.currentItem.nextElementSibling;t&&t.nextElementSibling&&t.classList.contains("oj-stream-list-skeleton");)t=t.nextElementSibling;break;case n.KEYBOARD_KEYS._F2:!1===this.actionableMode&&this._enterActionableMode();break;case n.KEYBOARD_KEYS._ESCAPE:case n.KEYBOARD_KEYS._ESCAPE_IE:!0===this.actionableMode&&this._exitActionableMode(!0);break;case n.KEYBOARD_KEYS._TAB:!0===this.actionableMode&&this.currentItem&&(e.shiftKey?n.handleActionablePrevTab(e,this.currentItem)&&e.preventDefault():n.handleActionableTab(e,this.currentItem)&&e.preventDefault())}null!=t&&(t.classList.contains(this.getItemStyleClass())||t.classList.contains(this.getGroupStyleClass()))&&(this._updateCurrentItemAndFocus(t,!0),e.preventDefault())}},this.setRootElement=e=>{this.root=e},this.scrollListener=()=>{const e=this;null==this.getData()||this._ticking||(window.requestAnimationFrame(function(){e._updateScrollPosition(),e._ticking=!1}),this._ticking=!0)},this.state={renderedData:null,outOfRangeData:null,initialSkeleton:!1,initialSkeletonCount:1,expandedToggleKeys:new l.KeySetImpl,expandedSkeletonKeys:new l.KeySetImpl,expandingKeys:new l.KeySetImpl,toCollapse:[],lastExpanded:e.expanded}}_clearFocusoutTimeout(){this._focusoutTimeout&&(clearTimeout(this._focusoutTimeout),this._focusoutTimeout=null)}_handleToggleExpanded(e,t){this.setState(function(s,n){var o,i;let r=s.expandedToggleKeys;if(!r.has(e)){r=r.add([e]);let s=n.expanded;return r.values().forEach(e=>{s=t?s.delete([e]):s.add([e])}),null===(i=(o=this.props).onExpandedChanged)||void 0===i||i.call(o,s),{expandedToggleKeys:r}}return{}}.bind(this))}_touchStartHandler(e){this._handleTouchOrClickEvent(e)}render(){const e=this.state.initialSkeleton,n=this.state.initialSkeletonCount;let o;if(null==this.contentHandler&&e)o=this._renderInitialSkeletons(n);else{const t=this.getData();null!=t&&e||null==t?o=this._renderInitialSkeletons(n,null==t):null!=t&&(o=this.contentHandler.render(t),this.currentItem&&this.currentItem.contains(document.activeElement)&&!this.actionableMode&&(this.restoreFocus=!0))}return t.h(s.Root,{ref:this.setRootElement},t.h("div",{role:"list","data-oj-context":!0,onClick:this._handleClick,onKeyDown:this._handleKeyDown,onfocusin:this._handleFocusIn,onfocusout:this._handleFocusOut},o))}_doBlur(){this.actionableMode&&this._exitActionableMode(!1),this.currentItem&&this.focusOutHandler(this.currentItem)}_isFocusBlurTriggeredByDescendent(e){return void 0===e.relatedTarget||!(null==e.relatedTarget||!this.root.contains(e.relatedTarget))}_renderInitialSkeletons(e,t){if(t){const e=this._getScroller();null!=e&&e===this.root&&(e.scrollTop=0)}return this.renderSkeletons(e)}renderSkeletons(e,t,s){const n=[],o=this._isTreeData();let i;for(let r=0;r<e;r++){let e=t;!t&&o&&r%4&&(e=!0),s&&(i=s+"_"+r),n.push(this._renderSkeleton(e,i))}return n}_renderSkeleton(e,s){let n="oj-stream-list-skeleton";return e&&(n+=" oj-stream-list-child-skeleton"),t.h("div",{class:n,key:s},t.h("div",{class:"oj-stream-list-skeleton-content oj-animation-skeleton"}))}_applySkeletonExitAnimation(e){const t=this.addBusyState("apply skeleton exit animations");return new Promise((s,n)=>{const o=[];e.forEach(e=>{o.push(c.fadeOut(e))}),Promise.all(o).then(function(){t(),s(!0)})})}_isTreeData(){const e=this.props.data;return null!=e&&this.instanceOfTreeDataProvider(e)}instanceOfTreeDataProvider(e){return"getChildDataProvider"in e}_postRender(){this._registerScrollHandler();const e=this.getData(),t=this.state.initialSkeleton;if(null!=e&&t){const e=this.getRootElement().querySelectorAll(".oj-stream-list-skeleton");this._applySkeletonExitAnimation(e).then(function(){this.setState({initialSkeleton:!1})}.bind(this))}else null!=e&&this.contentHandler.postRender();const s=this.root.querySelectorAll(".oj-stream-list-item, .oj-stream-list-group");this._disableAllTabbableElements(s),this._restoreCurrentItem(s)}_getScrollPolicyOptions(){return{fetchSize:this.props.scrollPolicyOptions.fetchSize,maxCount:this.props.scrollPolicyOptions.maxCount,scroller:this._getScroller()}}componentDidMount(){const e=this.props.data;this._isTreeData()?this.contentHandler=new p(this.root,e,this,this.props.scrollPolicy,this._getScrollPolicyOptions()):null!=e&&(this.contentHandler=new u(this.root,e,this,this.props.scrollPolicy,this._getScrollPolicyOptions())),this.height=this.root.clientHeight;const t=this.root.querySelector(".oj-stream-list-skeleton");if(t&&(this.skeletonHeight=this.outerHeight(t),this._delayShowSkeletons()),window.ResizeObserver){const e=this.root,t=new window.ResizeObserver(t=>{t.forEach(t=>{if(t.target===e&&t.contentRect){const e=this.height,s=Math.round(t.contentRect.height);Math.abs(s-e)>1&&(this.height=s,this.contentHandler&&this.contentHandler.checkViewport())}})});t.observe(e),this.resizeObserver=t}d.makeFocusable({applyHighlight:!0,setupHandlers:(e,t)=>{const s=n.getNoJQFocusHandlers(e,t);this.focusInHandler=s.focusIn,this.focusOutHandler=s.focusOut}});const s=this.getRootElement();s&&s.addEventListener("touchstart",e=>this._touchStartHandler(e),{passive:!0}),this._postRender()}getSkeletonHeight(){return this.skeletonHeight}outerHeight(e){let t=e.offsetHeight;const s=getComputedStyle(e);return t+=parseInt(s.marginTop)+parseInt(s.marginBottom),t}componentWillUnmount(){this.contentHandler&&this.contentHandler.destroy(),this.contentHandler=null,this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=null,this._unregisterScrollHandler()}_delayShowSkeletons(){window.setTimeout(()=>{null==this.getData()&&this.setState({initialSkeleton:!0,initialSkeletonCount:Math.max(1,Math.floor(this.height/this.skeletonHeight))})},this._getShowSkeletonsDelay())}_getOptionDefaults(){return null==this.defaultOptions&&(this.defaultOptions=h.parseJSONFromFontFamily("oj-streamlist-option-defaults")),this.defaultOptions}_getShowSkeletonsDelay(){const e=this._getOptionDefaults();if(null==e)return 0;const t=parseInt(e.showIndicatorDelay,10);return isNaN(t)?0:t}getRootElement(){return this.root}componentDidUpdate(e,t){this._isTreeData()&&this.contentHandler.collapse&&this.contentHandler.collapse(this.state.toCollapse);const s=t.expandingKeys;this.state.expandingKeys.values().forEach(function(e){s.has(e)||this.contentHandler.expand(e)}.bind(this)),this.props.data!=e.data&&(this.contentHandler&&this.contentHandler.destroy(),this.setCurrentItem(null),this.setState({renderedData:null,outOfRangeData:null,initialSkeleton:!1,initialSkeletonCount:this.state.initialSkeletonCount,expandedToggleKeys:new l.KeySetImpl,expandedSkeletonKeys:new l.KeySetImpl,expandingKeys:new l.KeySetImpl}),this._isTreeData()?(this.contentHandler=new p(this.root,this.props.data,this,this.props.scrollPolicy,this._getScrollPolicyOptions()),this._delayShowSkeletons()):null!=this.props.data&&(this.contentHandler=new u(this.root,this.props.data,this,this.props.scrollPolicy,this._getScrollPolicyOptions()),this._delayShowSkeletons())),this._postRender(),r.Object.compareValues(this.props.scrollPosition,e.scrollPosition)||r.Object.compareValues(this.props.scrollPosition,this.lastInternalScrollPositionUpdate)||this._syncScrollTopWithProps()}static getDerivedStateFromProps(e,t){let{expandedToggleKeys:s,expandingKeys:n,renderedData:o,expandedSkeletonKeys:i,lastExpanded:r}=t;if(!o)return{};const l=[],a=e.expanded;return a!==r?(s.values().forEach(e=>{r.has(e)!==a.has(e)&&(s=s.delete([e]))}),o.value.metadata.forEach(e=>{const t=e.key,s=e.expanded,o=a.has(t);s&&!o?(l.push(t),e.expanded=!1):!s&&o&&(n=n.add([t]),e.expanded=!0)}),l.forEach(e=>{o=m.collapse(e,o),n=n.delete([e]),i=i.delete([e])}),{renderedData:o,expandingKeys:n,expandedToggleKeys:s,expandedSkeletonKeys:i,toCollapse:l,lastExpanded:a}):{toCollapse:l}}static _findIndex(e,t){for(let s=0;s<e.length;s++)if(r.KeyUtils.equals(t,e[s].key))return s;return-1}_unregisterScrollHandler(){this._getScrollEventElement().removeEventListener("scroll",this.scrollListener)}_registerScrollHandler(){const e=this._getScrollEventElement();this._unregisterScrollHandler(),e.addEventListener("scroll",this.scrollListener)}_updateScrollPosition(){var e,t;const s={},n=this._getScroller().scrollTop,o=this._findClosestElementToTop(n);if(s.y=n,null!=o){const e=o.elem,t=this.contentHandler.getKey(e);s.offsetY=o.offsetY,s.key=t,this._isTreeData()&&e.classList.contains("oj-stream-list-item")?s.parentKey=this._getParentKey(e):s.parentKey=null}this.lastInternalScrollPositionUpdate=s,null===(t=(e=this.props).onScrollPositionChanged)||void 0===t||t.call(e,s)}_syncScrollTopWithProps(){const e=this.props.scrollPosition;let t;const s=e.key;if(s){const n=e.parentKey,o=this._getItemByKey(s,n);if(null==o)return;{const e=this.root;t=o.offsetTop-e.offsetTop}const i=e.offsetY;isNaN(i)||(t+=i)}else{const s=e.y;if(isNaN(s))return;t=s}t>this._getScroller().scrollHeight||(this._getScroller().scrollTop=t)}_getParentKey(e){for(;e;){if(e.classList.contains("oj-stream-list-group"))return this.contentHandler.getKey(e);e=e.previousElementSibling}return null}_getItemByKey(e,t){const s=this.root.querySelectorAll(".oj-stream-list-item, .oj-stream-list-group");for(let n=0;n<s.length;n++){const o=s[n];if(this.contentHandler.getKey(o)===e&&(null==t||this._getParentKey(o)===t))return o}}_getScrollEventElement(){let e=this.props.scrollPolicyOptions.scroller;return null!=e?("string"==typeof e&&(e=document.querySelector(e)),e===document.body||e===document.documentElement?window:e):this.getRootElement()}_getScroller(){let e=this.props.scrollPolicyOptions.scroller;return null!=e?("string"==typeof e&&(e=document.querySelector(e)),e===document.documentElement&&e!==document.scrollingElement?document.body:e):this.getRootElement()}_findClosestElementToTop(e){const t=this.root.querySelectorAll(".oj-stream-list-item, .oj-stream-list-group");if(null==t||0===t.length)return null;const s=this.root.offsetTop,n=Math.max(e,0);let o=0-s,i=n,r=0,l=t[r],a=!1,c={elem:l,offsetY:i};for(;!a&&r>=0&&r<t.length&&(l=t[r],o=l.offsetTop-s,i=Math.abs(n-o),a=i<1||n<=o,!a);)c={elem:l,offsetY:i},r+=1;return c}isAvailable(){return null!=this.contentHandler}getCurrentItem(){return this.currentKey}setCurrentItem(e){this.currentKey=e}getData(){return this.state.renderedData}setData(e){this.setState({renderedData:e})}updateData(e){this.setState(function(t){return e(t.renderedData,t.expandingKeys)}.bind(this))}getExpanded(){return this.props.expanded}setExpanded(e){var t,s;null===(s=(t=this.props).onExpandedChanged)||void 0===s||s.call(t,e)}updateExpand(e){this.setState(function(t,s){return e(t.renderedData,t.expandedSkeletonKeys,t.expandingKeys,s.expanded)}.bind(this))}getExpandingKeys(){return this.state.expandingKeys}setExpandingKeys(e){this.setState({expandingKeys:e})}updateExpandingKeys(e){this.setState(function(t){return{expandingKeys:t.expandingKeys.add([e])}})}getSkeletonKeys(){return this.state.expandedSkeletonKeys}setSkeletonKeys(e){this.setState({expandedSkeletonKeys:e})}updateSkeletonKeys(e){this.setState(function(t){return{expandedSkeletonKeys:t.expandedSkeletonKeys.add([e])}})}getOutOfRangeData(){return this.state.outOfRangeData}setOutOfRangeData(e){this.setState({outOfRangeData:e})}getItemRenderer(){return this.props.itemTemplate}getItemStyleClass(){return"oj-stream-list-item"}getGroupRenderer(){return this.props.groupTemplate}getGroupStyleClass(){return"oj-stream-list-group"}addBusyState(e){const t=this.getRootElement();return i.getContext(t).getBusyContext().addBusyState({description:e})}handleItemRemoved(e){if(e==this.getCurrentItem()){let e=this.currentItem.nextElementSibling;e||(e=this.currentItem.previousElementSibling),e&&this._updateCurrentItemAndFocus(e,this.root.contains(document.activeElement))}}_handleTouchOrClickEvent(e){const t=e.target,s=t.closest(".oj-stream-list-item, .oj-stream-list-group");s&&(this._isFocusable(t,s)?(this._updateCurrentItemAndFocus(s,!1),this._enterActionableMode(t)):this._updateCurrentItemAndFocus(s,!0))}_isFocusable(e,t){return this._isInputElement(e)||this._isInsideFocusableElement(e,t)}_isInputElement(e){return null!=e.nodeName.match(/^INPUT|SELECT|OPTION|TEXTAREA/)&&!e.readOnly}_isInsideFocusableElement(e,t){let s=!1;for(;e!==t&&null!=e;){if(e.classList.contains("oj-form-control")||this._isInFocusableElementsList(e,t)){e.readonly||e.disabled||(s=!0);break}e=e.parentNode}return s}_isInFocusableElementsList(e,t){let s=!1;return n.getFocusableElementsIncludingDisabled(t).forEach(function(t){t===e&&(s=!0)}),s}_resetFocus(e,t){this.actionableMode&&t&&this._exitActionableMode(!1),this.focusOutHandler(e),e.tabIndex=-1}_setFocus(e,t){e.tabIndex=0,t&&(this.focusInHandler(e),e.focus())}_updateCurrentItemAndFocus(e,t){const s=this.currentItem,n=e;this._resetFocus(s,!0),this.currentItem=n;const o=this.contentHandler.getKey(n);this.setCurrentItem(o),this._setFocus(n,t)}_isInViewport(e){const t=e.offsetTop,s=this._getScroller().scrollTop;return t>=s&&t<=s+this.height}_restoreCurrentItem(e){if(null!=this.currentKey)for(const t of e){if(this.contentHandler.getKey(t)==this.currentKey){const e=t;if(this.restoreFocus&&this._isInViewport(e))return void this._updateCurrentItemAndFocus(e,!0);this.currentItem=e,this._setFocus(e,!1);break}}this.restoreFocus=!1}_disableAllTabbableElements(e){e.forEach(e=>{i.getContext(e).getBusyContext().whenReady().then(function(){n.disableAllFocusableElements(e,!0)})})}_enterActionableMode(e){if(this.actionableMode=!0,this.currentItem){const t=n.enableAllFocusableElements(this.currentItem,!0);null==e&&t&&t.length>0&&(t[0].focus(),this._resetFocus(this.currentItem,!1))}}_exitActionableMode(e){this.actionableMode=!1,this.currentItem&&(n.disableAllFocusableElements(this.currentItem,!0),this._setFocus(this.currentItem,e))}},e.StreamList.defaultProps={data:null,expanded:new l.KeySetImpl,scrollPolicy:"loadMoreOnScroll",scrollPolicyOptions:{fetchSize:25,maxCount:500,scroller:null},scrollPosition:{y:0}},e.StreamList.collapse=(e,t)=>{const s=t.value.data,n=t.value.metadata,i=m._findIndex(n,e);if(i>-1){const e=o.IteratingTreeDataProviderContentHandler.getLocalDescendentCount(n,i);s.splice(i+1,e),n.splice(i+1,e)}return{value:{data:s,metadata:n},done:t.done}},e.StreamList.metadata={properties:{data:{type:"object|null"},expanded:{type:"any",writeback:!0},scrollPolicy:{type:"string",enumValues:["loadAll","loadMoreOnScroll"]},scrollPolicyOptions:{type:"object",properties:{fetchSize:{type:"number"},maxCount:{type:"number"},scroller:{type:"Element|string|null"}}},scrollPosition:{type:"object",properties:{y:{type:"number"},key:{type:"any"},offsetY:{type:"number"},parentKey:{type:"any"}},writeback:!0}},slots:{groupTemplate:{data:{}},itemTemplate:{data:{}}},extension:{_WRITEBACK_PROPS:["expanded","scrollPosition"],_READ_ONLY_PROPS:[]}},e.StreamList=m=y([s.customElement("oj-stream-list")],e.StreamList),Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ojstreamlist.js.map