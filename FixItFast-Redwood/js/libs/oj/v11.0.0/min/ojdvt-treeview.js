/**
 * @license
 * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","ojs/ojdvt-toolkit"],function(t,e){"use strict";var i=function(){};e.Obj.createSubclass(i,e.Obj),i._ANIMATION_DELETE_PRIORITY=0,i._ANIMATION_UPDATE_PRIORITY=1,i._ANIMATION_INSERT_PRIORITY=2,i._DEFAULT_FILL_COLOR="#000000",i._DEFAULT_TEXT_SIZE=11,i.__NODE_SELECTED_SHADOW=new e.Shadow(Math.sqrt(2),Math.sqrt(2),5/3,"rgba(0, 0, 0, 0.5)"),i.prototype.Init=function(t,s){this._view=t,this._options=s;var o=this._view.getOptions();this._id=s.id||s.label,this._color=s.color?s.color:i._DEFAULT_FILL_COLOR,this._textStr=s.label,this._labelStyle=s.labelStyle?new e.CSSStyle(s.labelStyle):null,this._pattern=s.pattern,this._selectable=s.selectable,this._shortDesc=s.shortDesc?s.shortDesc:s.tooltip,this._size=s.value;var n=s.drilling;this._drilling="on"==n||"off"==n?n:o.drilling,this._stampId=s.S,this._bArtificialRoot=s.bArtificialRoot,this._alpha=1,this._lastVisitedChild=null,this._isShowingKeyboardFocusEffect=!1,this.IsHover=!1},i.prototype.setChildNodes=function(t){if(null!=t)for(var e=0;e<t.length;e++)t[e]._parent=this;this._children=t},i.prototype.getChildNodes=function(){return this._children?this._children:[]},i.prototype.getDescendantNodes=function(){var t,e,i=[];if(!this.hasChildren())return i;for(var s=0;s<this._children.length;s++)t=(e=this._children[s]).getDescendantNodes(),i.push(e),i=i.concat(t);return i},i.prototype.SetLastVisitedChild=function(t){this._lastVisitedChild=t},i.prototype.GetLastVisitedChild=function(){return this._lastVisitedChild},i.prototype.MarkAsLastVisitedChild=function(){var t=this.GetParent();t&&t.SetLastVisitedChild(this)},i.prototype.isDescendantOf=function(t){return!(!t||!this.GetParent())&&(this.GetParent()==t||this.GetParent().isDescendantOf(t))},i.prototype.GetNodesAtDepth=function(t,e){var i=[];if(e<0)return i;if(0==e)return[this];if(t.hasChildren())for(var s,o=t.getChildNodes(),n=0;n<o.length;n++)s=o[n],i=i.concat(s.GetNodesAtDepth(s,e-1));return i},i.getNodeById=function(t,s){if(e.Obj.compareValues(t.getView().getCtx(),t.getId(),s))return t;for(var o=null,n=t.getChildNodes(),a=n.length,r=null,l=0;l<a;l++)if(r=n[l],o=i.getNodeById(r,s))return o;return null},i.prototype.getView=function(){return this._view},i.prototype.getStampId=function(){return this._stampId},i.prototype.getOptions=function(){return this._options},i.prototype.getCategories=function(){if(this.isArtificialRoot())return[];var t=this.getOptions().categories;if(!t&&!this.getView().hasDataProvider()){var e=this.GetParent(),i=e?e.getCategories():null;(t=i?i.slice():[]).push(this.getId())}return t},i.prototype.getId=function(){return this._id},i.prototype.getSize=function(){return this._size},i.prototype.getColor=function(){return this._color},i.prototype.getDatatip=function(){var t=this._view.getOptions().tooltip,e=t?t.renderer:null;return e?this.getView().getCtx().getTooltipManager().getCustomTooltip(e,this.getDataContext()):this._shortDesc},i.prototype.getDatatipColor=function(){return this._color},i.prototype.getShortDesc=function(){return this._shortDesc},i.getShortDescContext=function(t){var i,s=t.getOptions(),o=s;return s._noTemplate?(i=s._itemData,o=s._itemData):s._itemData&&(i=s._itemData,o=s=e.JsonUtils.clone(s),delete s._itemData),{id:t.getId(),label:t.getLabel(),value:t.getSize(),data:o,itemData:i}},i.prototype.getDataContext=function(){var t,i=this.getOptions(),s=i;return i._noTemplate?(t=i._itemData,s=i._itemData):i._itemData&&(t=i._itemData,s=i=e.JsonUtils.clone(i),delete i._itemData),{id:this.getId(),label:this.getLabel(),value:this.getSize(),color:this.getColor(),data:s,itemData:t,component:this.getView().getOptions()._widgetConstructor}},i.prototype.getIndex=function(){return this.getOptions()._index},i.prototype.getAlpha=function(){return this._alpha},i.prototype.setAlpha=function(t){this._alpha=t,this._shape&&this._shape.setAlpha(this._alpha)},i.prototype.setDisclosed=function(t){this.getOptions()._expanded=t},i.prototype.isDisclosed=function(){return!1!==this.getOptions()._expanded},i.prototype.isArtificialRoot=function(){return this._bArtificialRoot},i.prototype.isDrillReplaceEnabled=function(){return"on"==this._drilling},i.prototype.render=function(t){},i.prototype.renderChildren=function(t){var e=this.getChildNodes();if(null!=e)for(var i=0;i<e.length;i++)e[i].render(t)},i.prototype.getNextNavigable=function(t){return this.MarkAsLastVisitedChild(),this},i.prototype.getKeyboardBoundingBox=function(t){return new e.Rectangle(0,0,0,0)},i.prototype.getTargetElem=function(){return null},i.prototype.showKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!0,this.showHoverEffect(),this.handleMouseOver&&this.handleMouseOver()},i.prototype.hideKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect&&(this._isShowingKeyboardFocusEffect=!1,this.hideHoverEffect()),this.handleMouseOut&&this.handleMouseOut()},i.prototype.isShowingKeyboardFocusEffect=function(){return this._isShowingKeyboardFocusEffect},i.prototype.handleMouseOver=function(){this.IsHover=!0},i.prototype.handleMouseOut=function(){this.IsHover=!1},i.prototype.isSelectable=function(){return"off"!=this._selectable&&null!=this.getView().__getNodeSelection()},i.prototype.isSelected=function(){return this._selected},i.prototype.setSelected=function(t){this._selected=t,this.UpdateAriaLabel()},i.prototype.showHoverEffect=function(){},i.prototype.hideHoverEffect=function(){},i.prototype.highlight=function(t,e){this.setAlpha(e)},i.prototype.isDragAvailable=function(t){return this.getView().__isDragAvailable(t)},i.prototype.getDragTransferable=function(t,e){return this.getView().__getDragTransferable(this)},i.prototype.getDragFeedback=function(t,e){return this.getView().__getDragFeedback()},i.prototype.getDropSiteFeedback=function(){return null},i.prototype.contains=function(t,e){return!1},i.prototype.getNodeUnderPoint=function(t,e){return null},i.prototype.GetAnimationParams=function(){return[]},i.prototype.SetAnimationParams=function(t){},i.prototype.animateUpdate=function(t,s){t.isDrillAnimation()||t.constructAnimation(s.getChildNodes(),this.getChildNodes());var o,n=this.GetAnimationParams(),a=s.GetAnimationParams(n);if(!e.ArrayUtils.equals(a,n)){(o=new e.CustomAnimation(this.getView().getCtx(),this,this.getView().__getAnimationDuration())).getAnimator().addProp(e.Animator.TYPE_NUMBER_ARRAY,this,this.GetAnimationParams,this.SetAnimationParams,n),t.add(o,i._ANIMATION_UPDATE_PRIORITY);var r=this._size!=s._size,l=e.ColorUtils.getRGBA(this._color)!=e.ColorUtils.getRGBA(s._color);this.SetAnimationParams(a);var h=this._view.getOptions().animationUpdateColor;h&&(r||l)&&(this._color=h)}},i.prototype.animateInsert=function(t){if(!t.isDrillAnimation()||!t.isAncestorInsert(this)){this.setAlpha(0);var s=new e.AnimFadeIn(this.getView().getCtx(),this,this.getView().__getAnimationDuration());if(t.add(s,i._ANIMATION_INSERT_PRIORITY),this.hasChildren())for(var o=0;o<this._children.length;o++)this._children[o].animateInsert(t)}},i.prototype.animateDelete=function(t,s){s.addChild(this._shape);var o=new e.AnimFadeOut(this.getView().getCtx(),this,this.getView().__getAnimationDuration());if(t.add(o,i._ANIMATION_DELETE_PRIORITY),!t.isDrillAnimation()&&this.hasChildren())for(var n=0;n<this._children.length;n++)this._children[n].animateDelete(t,s)},i.prototype.hasChildren=function(){return null!=this._children&&this._children.length>0},i.prototype.hasDPChildren=function(){var t=this.getView().getOptions().data;if(t){var e=t.getChildDataProvider(this.getId());return!!e&&"yes"!==e.isEmpty()}return!1},i.prototype.hasPattern=function(){return this._pattern&&"none"!=this._pattern},i.prototype.GetParent=function(){return this._parent},i.prototype.GetDepth=function(){for(var t=0,e=this.GetParent();e;)t++,e=e.GetParent();return t},i.prototype.GetFill=function(){return this.hasPattern()?new e.PatternFill(this._pattern,this._color):new e.SolidFill(this._color)},i.GetNodeTextColor=function(t){return t.hasPattern()?"#000000":e.ColorUtils.getContrastingTextColor(t._color)},i.prototype.ApplyLabelTextStyle=function(t){var s=i.GetNodeTextColor(this);t.setSolidFill(s),t.setCSSStyle(this.getMergedLabelTextStyle()),e.Agent.isHighContrast()&&t.setSolidFill(s)},i.prototype.getMergedLabelTextStyle=function(){var t=new Array;return t.push(this._view.getOptions().nodeDefaults.labelStyle),this._labelStyle&&t.push(this._labelStyle),e.CSSStyle.mergeStyles(t)},i.prototype.GetTextSize=function(){var t=i._DEFAULT_TEXT_SIZE,e=this._view.getOptions().nodeDefaults.labelStyle.getFontSize();return e&&(t=parseFloat(e)),t},i.prototype.getLabelBackgroundColor=function(){var t=this._labelStyle,e=t?t.getStyle("background-color"):null;return e||this._view.getOptions().nodeDefaults.labelStyle.getStyle("background-color")},i.prototype.getDisplayable=function(){return this._shape},i.prototype.getLabel=function(){return this._textStr},i.prototype.GetAfContext=function(){return this.getView().__getAfContext()},i.prototype.GetElAttributes=function(){return this.getOptions()._cf},i.prototype.GetTemplate=function(){return this.getView().__getTemplate(this.getStampId())},i.prototype.isDoubleClickable=function(){return this.isDrillReplaceEnabled()},i.prototype.UpdateAriaLabel=function(){},i.prototype.isRootNode=function(){return e.Obj.compareValues(this.getView().getCtx(),this.getId(),this.getView().getRootNode().getId())||this.isArtificialRoot()};var s=function(t,e,i,s,o){this.Init(i,s,o),this._node=t,this._id=e,this._bDrillable=!1};e.Obj.createSubclass(s,e.SimpleObjPeer),s.prototype.getId=function(){return this._id},s.prototype.isDrillable=function(){return this._bDrillable},s.prototype.setDrillable=function(t){this._bDrillable=t},s.prototype.handleMouseOver=function(){this._node&&this._node.handleMouseOver&&this._node.handleMouseOver()},s.prototype.handleMouseOut=function(){this._node&&this._node.handleMouseOut&&this._node.handleMouseOut()};var o={};e.Obj.createSubclass(o,e.Obj),o.calcMaxDepth=function(t,e){var i=e,s=t.getChildNodes();if(s)for(var n=0;n<s.length;n++){var a=o.calcMaxDepth(s[n],e+1);i=Math.max(i,a)}return i},o.calcNodeCount=function(t){var e=1,i=t.getChildNodes();if(i)for(var s=0;s<i.length;s++)e+=o.calcNodeCount(i[s]);return e},o.getAllNodes=function(t){var e=[];return o._addNodesToArray(t,e),e},o.getAllIds=function(t){return o.getAllNodes(t).map(t=>t.getId())},o.getAllVisibleNodes=function(t){var e=[];return o._addNodesToArray(t,e,!1,!0),e},o.getLeafNodes=function(t){var e=[];return o._addNodesToArray(t,e,!0),e},o.isHiddenNode=function(t,i){return e.ArrayUtils.hasAnyMapItem(t,i.categories)},o._addNodesToArray=function(t,e,i,s){if(t){var n=t.getChildNodes(),a=n?n.length:0;i&&0!=a||s&&!t.getDisplayable()||e.push(t);for(var r=0;r<a;r++)o._addNodesToArray(n[r],e,i,s)}},o.findRootAndAncestors=function(t,i,s,n){for(var a=0;a<i.length;a++){if(e.Obj.compareValues(t,i[a].id,s))return{root:i[a],ancestors:n};if(i[a].nodes){n.unshift(i[a]);var r=o.findRootAndAncestors(t,i[a].nodes,s,n);if(null!=r)return r;n.shift()}}return null};var n=function(t,e){this.Init(t,e)};e.Obj.createSubclass(n,e.DataAnimationHandler),n.prototype.animate=function(t,e,i,s){if(this._bDrill=!1,this._oldRoot=t,this._oldAncestors=i,n._isAncestor(s,t)||n._isAncestor(i,e)){this._bDrill=!0;var o=t.getDescendantNodes(),a=e.getDescendantNodes();o.push(t),a.push(e),this.constructAnimation(o,a)}else this.constructAnimation([t],[e])},n.prototype.isDrillAnimation=function(){return this._bDrill},n.prototype.isAncestorInsert=function(t){return!!this._bDrill&&(e.Obj.compareValues(this.getCtx(),this._oldRoot.getId(),t.getId())||n._isAncestor(this._oldAncestors,t))},n._isAncestor=function(t,e){if(!e||!t)return!1;for(var i=0;i<t.length;i++)if(t[i].id==e.getId())return!0;return!1};var a=new Object;e.Obj.createSubclass(a,e.Obj),a.VERSION_1={labelStyle:e.BaseComponentDefaults.FONT_FAMILY_ALTA_11+"color: #003286;",disabledLabelStyle:e.BaseComponentDefaults.FONT_FAMILY_ALTA_11,__labelGap:4,__labelSeparator:">"},a.calcOptions=function(t){var i=a._getDefaults(t);return t?e.JsonUtils.merge(t,i):i},a._getDefaults=function(t){return e.JsonUtils.clone(a.VERSION_1)},a.getGapSize=function(t,e){return Math.ceil(e*t.layout.gapRatio)};var r=function(t,e,i){this.Init(),this._id=t,this._bDrillable=!1,this._displayable=e,this._displayableText=i,this._truncated=!1};e.Obj.createSubclass(r,e.SimpleObjPeer),r.prototype.getId=function(){return this._id},r.prototype.isDrillable=function(){return this._bDrillable},r.prototype.setDrillable=function(t){this._bDrillable=t},r.prototype.getDisplayable=function(){return this._displayable},r.prototype.getTooltip=function(t){return this._truncated?this._displayableText:null},r.prototype.setTruncated=function(t){this._truncated=t};var l=function(t,e,i,s){this.Init(e,i,s),this._breadcrumbs=t};e.Obj.createSubclass(l,e.EventManager),l.prototype.OnClick=function(t){l.superclass.OnClick.call(this,t),this._processBreadcrumbs(this.GetLogicalObject(t.target))},l.prototype.HandleTouchClickInternal=function(t){this._processBreadcrumbs(this.GetLogicalObject(t.target))},l.prototype._processBreadcrumbs=function(t){if(t&&t instanceof r&&t.isDrillable()){var i=e.EventFactory.newBreadcrumbsDrillEvent(t.getId());this.FireEvent(i,this._breadcrumbs)}},l.prototype.handleKeyboardEvent=function(t){var i=!0,s=t.keyCode;if(s==e.KeyboardEvent.TAB){var o=this._breadcrumbs.updateCrumbFocus(t.shiftKey);-1==o?i=!1:this.UpdateActiveElement(this._breadcrumbs.getCrumb(o))}else if(s==e.KeyboardEvent.ENTER){var n=this._breadcrumbs.getCrumb(this._breadcrumbs.getCurrentCrumbIndex());this._processBreadcrumbs(this.GetLogicalObject(n))}return i&&e.EventManager.consumeEvent(t),i};var h=new Object;e.Obj.createSubclass(h,e.Obj),h._TOUCH_BUFFER=3,h.render=function(t,i,s){for(var o=t.getCtx(),n=t.__getData().items?t.__getData().items:[],a=t.__getOptions(),l=t.getEventManager(),_=[],d=[],u=0;u<n.length;u++){var c=n[u];if(c){var p=c.label?c.label:"",g=h._createLabel(o,p,a,u<n.length-1);_.push(g);var f=new r(c.id,g,p);l.associate(g,f),d.push(f),u<n.length-1&&f.setDrillable(!0)}}t.SetCrumbs(_),e.Agent.isRightToLeft(o)?h._positionLabelsBidi(t,i,s,_,d):h._positionLabels(t,i,s,_,d)},h._createButtonState=function(t,i,s){var o=new e.OutputText(t,i,0,0);o.setMouseEnabled(!1),o.setCSSStyle(s);var n=s.getPadding(e.CSSStyle.PADDING_TOP),a=s.getPadding(e.CSSStyle.PADDING_RIGHT),r=s.getPadding(e.CSSStyle.PADDING_BOTTOM),l=s.getPadding(e.CSSStyle.PADDING_LEFT),h=e.DisplayableUtils.getDimensionsForced(t,o),_=new e.Rect(t,0,0,h.w+l+a,h.h+n+r);return _.setInvisibleFill(),_.setCSSStyle(s),o.setTranslate(l,n),_.addChild(o),_},h._createLabel=function(t,i,s,o){var n;if(o&&(s.labelStyleOver||s.labelStyleDown)){var a=new e.CSSStyle(s.labelStyle),r=new e.CSSStyle(s.labelStyleOver),l=new e.CSSStyle(s.labelStyleDown),_=h._createButtonState(t,i,a),d=h._createButtonState(t,i,r),u=h._createButtonState(t,i,l);(n=new e.Button(t,_,d,u)).setAriaRole("link"),n.setAriaProperty("label",i)}else{var c=o?s.labelStyle:s.disabledLabelStyle,p=new e.CSSStyle(c);p.getPadding(e.CSSStyle.PADDING_LEFT)||p.getPadding(e.CSSStyle.PADDING_RIGHT)||p.getPadding(e.CSSStyle.PADDING_TOP)||p.getPadding(e.CSSStyle.PADDING_BOTTOM)?n=h._createButtonState(t,i,p):(n=new e.OutputText(t,i,0,0)).setCSSStyle(p)}return n},h._getLabelTextString=function(t){return t instanceof e.Button?t.upState.getChildAt(0).getTextString():t instanceof e.Rect?t.getChildAt(0).getTextString():t.getTextString()},h._truncateLabels=function(t,i){if(t instanceof e.Button){var s=t.upState.getChildAt(0);return e.TextUtils.fitText(s,Math.max(i-s.getTranslateX(),0),1/0,s.getParent()),s=t.overState.getChildAt(0),e.TextUtils.fitText(s,Math.max(i-s.getTranslateX(),0),1/0,s.getParent()),s=t.downState.getChildAt(0),void e.TextUtils.fitText(s,Math.max(i-s.getTranslateX(),0),1/0,s.getParent())}if(t instanceof e.Rect){s=t.getChildAt(0);e.TextUtils.fitText(s,Math.max(i-s.getTranslateX(),0),1/0,s.getParent())}else e.TextUtils.fitText(t,i,1/0,t.getParent())},h._positionLabels=function(t,i,s,o,n){for(var a=t.__getOptions(),r=t.getEventManager(),l=[],_=0,d=0;d<o.length;d++){i.addChild(o[d]);var u=o[d].getDimensions();l[d]=u,_=Math.max(u.h,_),i.removeChild(o[d])}var c=0;for(d=0;d<o.length;d++){i.addChild(o[d]);u=l[d];if(o[d].setTranslate(c,.5*(_-u.h)),e.Agent.isTouchDevice()){var p=new e.Rect(i.getCtx(),-h._TOUCH_BUFFER,-h._TOUCH_BUFFER,u.w+2*h._TOUCH_BUFFER,u.h+2*h._TOUCH_BUFFER);p.setInvisibleFill(),o[d].addChild(p),d<n.length&&r.associate(p,n[d])}if(c+u.w>s){var g=h._getLabelTextString(o[d]);return h._truncateLabels(o[d],s-c),void(d<n.length?n[d].setTruncated(!0):r.associate(o[d],new e.SimpleObjPeer(g)))}if(c+=u.w+a.__labelGap,d<o.length-1){var f=h._newSeparator(t);i.addChild(f);var y=f.getDimensions();f.setTranslate(c,.5*(_-y.h));var E=y.w;if(c+E>s)return void i.removeChild(f);c+=E+a.__labelGap}}},h._positionLabelsBidi=function(t,i,s,o,n){for(var a=t.__getOptions(),r=t.getEventManager(),l=s,_=0;_<o.length;_++){i.addChild(o[_]);var d=o[_].getDimensions();if(e.Agent.isTouchDevice()){var u=new e.Rect(i.getCtx(),-h._TOUCH_BUFFER,-h._TOUCH_BUFFER,d.w+2*h._TOUCH_BUFFER,d.h+2*h._TOUCH_BUFFER);u.setInvisibleFill(),o[_].addChild(u),_<n.length&&r.associate(u,n[_])}if(l-d.w<0){var c=h._getLabelTextString(o[_]);return h._truncateLabels(o[_],l),o[_].setTranslateX(0),void(_<n.length?n[_].setTruncated(!0):r.associate(o[_],new e.SimpleObjPeer(c)))}if(o[_].setTranslateX(l-d.w),l-=d.w+a.__labelGap,_<o.length-1){var p=h._newSeparator(t);i.addChild(p);var g=p.getDimensions().w;if(l-g<0)return void i.removeChild(p);p.setTranslateX(l-g),l-=g+a.__labelGap}}},h._newSeparator=function(t){var i=t.__getOptions(),s=new e.OutputText(t.getCtx(),i.__labelSeparator,0,0);return s.setCSSStyle(new e.CSSStyle(i.labelStyle)),s};const _=function(t,e,i,s){this.Init(t,e,i,s)};e.Obj.createSubclass(_,e.Container),_.prototype.Init=function(t,e,i,s){_.superclass.Init.call(this,t),this.setOptions(s),this._eventHandler=new l(this,t,e,i),this._eventHandler.addListeners(this),this.setId("breadcrumbs1000"+Math.floor(1e9*Math.random())),this._curCrumbIdx=-1,this._keyboardFocusRect=null,this._crumbs=null},_.prototype.setOptions=function(t){this._options=a.calcOptions(t)},_.prototype.render=function(t,i){this._data=t?e.JsonUtils.clone(t):this._data,this.removeChildren(),this.SetCrumbs(null),h.render(this,this,i)},_.prototype.__getData=function(){return this._data?this._data:{}},_.prototype.__getOptions=function(){return this._options},_.prototype.getEventManager=function(){return this._eventHandler},_.prototype.hideKeyboardFocusEffect=function(){var t=this._curCrumbIdx;this._curCrumbIdx=-1,this._updateKeyboardFocusEffect(t,this._curCrumbIdx)},_.prototype.getCurrentCrumbIndex=function(){return this._curCrumbIdx},_.prototype.getNumCrumbs=function(){return this._data.items.length},_.prototype.updateCrumbFocus=function(t){var e=this._curCrumbIdx;return this._curCrumbIdx=this._getUpdatedCrumbIndex(e,!t),this._updateKeyboardFocusEffect(e,this._curCrumbIdx),this._curCrumbIdx},_.prototype._getUpdatedCrumbIndex=function(t,e){return-1==t?e?0:this._data.items.length-2:e?t==this._data.items.length-2?-1:++t:0==t?-1:--t},_.prototype._updateKeyboardFocusEffect=function(t,i){var s=this._keyboardFocusRect,o=null,n=this.getCrumb(i);if(n){var a=this._eventHandler.GetLogicalObject(n);if(a&&a.isDrillable&&a.isDrillable()){var r=this.getCtx(),l=n.getDimensions(),h=n.getMatrix();o=new e.KeyboardFocusEffect(r,this,l,h),this._keyboardFocusRect=o}else this._keyboardFocusRect=null}s&&s.hide(),o&&o.show()},_.prototype.getCrumb=function(t){var e=this.GetCrumbs();return t<0||!e||t>=e.length?null:e[t]},_.prototype.getCrumbIndex=function(t){for(var e=this.GetCrumbs(),i=0;i<e.length;i++)if(e[i]==t)return i},_.prototype.SetCrumbs=function(t){this._crumbs=t},_.prototype.GetCrumbs=function(){return this._crumbs};var d=function(t,e){this.Init(t,e);var i=this._view.getOptions().nodeDefaults;this._labelDisplay=e.labelDisplay?e.labelDisplay:i.labelDisplay,this._evaluateExpanded(t,e),this._labelHalign=e.labelHalign?e.labelHalign:i.labelHalign,this._radius=e.radius,this._className=e.className||e.svgClassName,this._style=e.style||e.svgStyle,this._showDisclosure="on"===e.showDisclosure||"off"!==e.showDisclosure&&"on"===i.showDisclosure};e.Obj.createSubclass(d,i),d.TEXT_BUFFER_HORIZ=6,d._EXPAND_ICON_SIZE=16,d._ROOT_NODE_MARGIN=2,d._MIN_ARC_LENGTH=1.5,d._MIN_ANGLE_EXTENT=6e-4,d.TWO_PI=2*Math.PI,d.LARGE_DATASET_THRESHOLD=1e3,d._CENTER_ARTIFICIAL_ROOT_RADIUS=.25,d._CENTER_NODE_RADIUS=.5,d._CENTER_WITH_CONTENT_RADIUS=1,d.prototype.render=function(t){if(this._hasLayout){this._nodeContainer=t,this._shape=this._createShapeNode(),t.addChild(this._shape);var i=this.GetTemplate();if(this._showRootContent()&&i){var s=Math.sqrt(2),o=this._outerRadius*s-2*d._ROOT_NODE_MARGIN,n=o;this._x=-this._outerRadius/s+d._ROOT_NODE_MARGIN,this._y=-this._outerRadius/s+d._ROOT_NODE_MARGIN;var a=this.GetElAttributes(),r=this.GetAfContext();if(r.setELContext(a),o>0&&n>0){r.setAvailableWidth(o),r.setAvailableHeight(n),r.setFontSize(this.GetTextSize());var l=e.AfComponentFactory.parseAndLayout(r,i,this._shape);this._contentRoot=l;var h=l.getDimensions();l.setTranslate(this._x+(o-h.w)/2,this._y+(n-h.h)/2)}}else if(!(this.isRootNode()&&this._createRootNodeContent()||(this._text=this._createTextNode(this._shape),null==this._text))){this._shape.addChild(this._text);var _=this.getLabelBackgroundColor();if(this.hasPattern()||_){var u=this._text.getDimensions();this._textBackground=new e.Rect(this.getView().getCtx(),u.x,u.y,u.w,u.h),_?this._textBackground.setSolidFill(_):this._textBackground.setSolidFill("#FFFFFF"),this._textBackground.setMouseEnabled(!1),this._shape.addChild(this._textBackground);var c=this._text.getMatrix();c.isIdentity()||this._textBackground.setMatrix(c),this._shape.addChild(this._text)}}this._shape.setAriaRole("img"),this._shape.setStyle(this._style),this._shape.setClassName(this._className),this.UpdateAriaLabel(),this.renderChildren(t)}},d.prototype.renderChildren=function(t){var e=this.getChildNodes(),i=this.getView().__getNodeCount()>=d.LARGE_DATASET_THRESHOLD;if(null!=e)for(var s=0,o=0;o<e.length;o++){var n=!0,a=e[o]._angleExtent;if(a>=d._MIN_ANGLE_EXTENT){if(i){var r=e[o]._getOuterRadius(),l=a*r,h=(e[o]._startAngle+a)*r;l<d._MIN_ARC_LENGTH&&Math.abs(s-h)<d._MIN_ARC_LENGTH?n=!1:s=h}n&&e[o].render(t)}}},d.prototype.setSelected=function(t){d.superclass.setSelected.call(this,t),null!=this._shape&&(this.isSelected()?(this._shape.setSelected(!0),this.getView().__moveToSelectedLayer(this._shape)):(this._shape.setSelected(!1),e.Agent.isTouchDevice()&&this._expandButton?this.getView().__moveToSelectedLayer(this._shape):this._nodeContainer&&this._nodeContainer.addChild(this._shape)))},d.prototype.showHoverEffect=function(){this._shape&&this._hasLayout&&(this._shape.showHoverEffect(),this.isSelected()?this.getView().__moveToSelectedLayer(this._shape):this.getView().__moveToHoverLayer(this._shape))},d.prototype.hideHoverEffect=function(){this._shape&&this._hasLayout&&!this.isShowingKeyboardFocusEffect()&&(this._shape.hideHoverEffect(),!this.isSelected()&&this._nodeContainer&&this._nodeContainer.addChild(this._shape))},d.prototype.isExpandCollapseEnabled=function(){return this._showDisclosure},d.prototype.getNextNavigable=function(t){var i,s,o,n,a;if(t.type===e.MouseEvent.CLICK)return d.superclass.getNextNavigable.call(this,t);if((i=t.keyCode)===e.KeyboardEvent.SPACE&&t.ctrlKey)return this;for(a=this;a.GetParent();)a=a.GetParent();o=this.GetNodesAtDepth(a,this.GetDepth()),n=d._findNodeIndex(this,o);var r,l,h=this._startAngle+this._angleExtent/2;switch(h=d._normalizedRadToDeg(h),i){case e.KeyboardEvent.UP_ARROW:if(this===a||h>180){if((r=this.GetLastVisitedChild())&&(l=r._startAngle+r._angleExtent/2,(l=d._normalizedRadToDeg(l))>180))return r;s=e.KeyboardHandler.getNextAdjacentNavigable(this,t,this.getDescendantNodes())}else s=this._navigateToParent();break;case e.KeyboardEvent.DOWN_ARROW:if(this===a||h>=0&&h<=180){if((r=this.GetLastVisitedChild())&&(l=r._startAngle+r._angleExtent/2,(l=d._normalizedRadToDeg(l))>=0&&l<=180))return r;s=e.KeyboardHandler.getNextAdjacentNavigable(this,t,this.getDescendantNodes())}else s=this._navigateToParent();break;case e.KeyboardEvent.LEFT_ARROW:s=1===o.length?this:0===n?o[o.length-1]:o[n-1];break;case e.KeyboardEvent.RIGHT_ARROW:s=1===o.length?this:n===o.length-1?o[0]:o[n+1];break;default:s=this}return s.MarkAsLastVisitedChild(),s},d.prototype._navigateToParent=function(){var t,e=this.GetParent();return e?(t=e,e.MarkAsLastVisitedChild()):t=this,t.MarkAsLastVisitedChild(),t},d._normalizedRadToDeg=function(t){var i=e.Math.radsToDegrees(t);return i<0?i+=360:i>360&&(i-=360),i},d.prototype.getKeyboardBoundingBox=function(t){if(this._shape){var i=this._shape.getDimensions(),s=new e.Point(i.x,i.y);return s=this._shape.localToStage(s),i.x=s.x,i.y=s.y,i}return new e.Rectangle(0,0,0,0)},d.prototype.getTargetElem=function(){return this._shape?this._shape.getElem():null},d.prototype.setLayoutParams=function(t,e,i,s){this._innerRadius=t,this._outerRadius=e,this._startAngle=i,this._angleExtent=s,this._hasLayout=!0},d.prototype.GetFill=function(){return this.isArtificialRoot()?e.SolidFill.invisibleFill():d.superclass.GetFill.call(this)},d.prototype.GetAnimationParams=function(t){var i=e.ColorUtils.getRed(this._color),s=e.ColorUtils.getGreen(this._color),o=e.ColorUtils.getBlue(this._color),n=this._startAngle;if(t&&!isNaN(t[2])){var a=t[2];a-this._startAngle>Math.PI?n+=d.TWO_PI:this._startAngle-a>Math.PI&&(n-=d.TWO_PI)}return[this._innerRadius,this._outerRadius,n,this._angleExtent,i,s,o]},d.prototype.SetAnimationParams=function(t){this.setLayoutParams(t[0],t[1],t[2],t[3]);var i=Math.round(t[4]),s=Math.round(t[5]),o=Math.round(t[6]);this._color=e.ColorUtils.makeRGB(i,s,o),this.updateShapes(!1)},d.prototype.animateUpdate=function(t,e){!this.isRootNode()||e._getOuterRadius()===this._getOuterRadius()&&e.getId()===this.getId()||this._removeRootNodeContentOverlay();var i=e._hasLayout&&e._angleExtent>0,s=this._hasLayout&&this._angleExtent>0;i&&s?d.superclass.animateUpdate.call(this,t,e):s?this.animateInsert(t):i&&this.animateDelete(t,t.getDeleteContainer())},d.prototype.animateInsert=function(t,e){this.isRootNode()&&this._removeRootNodeContentOverlay(),d.superclass.animateInsert.call(this,t,e)},d.prototype.animateDelete=function(t,e){this.isRootNode()&&this._removeRootNodeContentOverlay(),d.superclass.animateDelete.call(this,t,e)},d.prototype.getNodeUnderPoint=function(t,e){if(this.contains(t,e))return this;for(var i=this.getChildNodes(),s=0;s<i.length;s++){var o=i[s].getNodeUnderPoint(t,e);if(o)return o}return null},d.prototype.contains=function(t,e){var i=d._calcRadius(t,e),s=d._calcAngle(t,e);return this.ContainsRadius(i)&&this.ContainsAngle(s)},d.prototype.ContainsAngle=function(t){for(;t<this._startAngle;)t+=d.TWO_PI;for(;t-this._startAngle>d.TWO_PI;)t-=d.TWO_PI;return t>=this._startAngle&&t<=this._startAngle+this._angleExtent},d.prototype.ContainsRadius=function(t){return t>=this._innerRadius&&t<=this._outerRadius},d._calcPointOnArc=function(t,e){return{x:Math.cos(e)*t,y:Math.sin(e)*t}},d._calcAngle=function(t,e){var i=Math.atan2(e,t);return i<0?i+=d.TWO_PI:i>d.TWO_PI&&(i-=d.TWO_PI),i},d._calcRadius=function(t,e){return Math.sqrt(t*t+e*e)},d.prototype._createShapeNode=function(){if(!this._angleExtent||this._angleExtent<=0)return null;var t=this._createPathCmd(),i=new e.Path(this.getView().getCtx(),t);this.getView().getEventManager().associate(i,this),i.setAlpha(this.getAlpha()),i.setFill(this.GetFill());var s=this._view.getOptions().nodeDefaults,o=this.getOptions(),n=o.borderColor||s.borderColor,a=null==o.borderWidth?s.borderWidth:o.borderWidth;if(i.setStroke(new e.Stroke(n,1,a)),"redwood"!==i.getCtx().getThemeBehavior())i.setHoverStroke(new e.Stroke(s.hoverColor,1,3)),i.setSelectedStroke(new e.Stroke(s.selectedInnerColor,1,1.5),new e.Stroke(s.selectedOuterColor,1,3.5)),i.setSelectedHoverStroke(new e.Stroke(s.hoverColor,1,3));else{var r=this.getColor();i.setHoverStroke(new e.Stroke(s.selectedInnerColor,1,1),new e.Stroke(r,1,3.5)),i.setSelectedStroke(new e.Stroke(s.selectedInnerColor,1,1),new e.Stroke(s.selectedOuterColor,1,3.5)),i.setSelectedHoverStroke(new e.Stroke(s.selectedInnerColor,1,1),new e.Stroke(s.selectedOuterColor,1,3.5))}return i.setSelectable(this.isSelectable()),this.isDrillReplaceEnabled()&&i.setCursor("pointer"),this.isArtificialRoot()&&(i.setAlpha(.001),i.setMouseEnabled(!1)),i},d.prototype._createPathCmd=function(){var t,i,s,o,n;return this._angleExtent<d.TWO_PI?(i=d._calcPointOnArc(this._outerRadius,this._startAngle),s=d._calcPointOnArc(this._outerRadius,this._startAngle+this._angleExtent),o=d._calcPointOnArc(this._innerRadius,this._startAngle+this._angleExtent),n=d._calcPointOnArc(this._innerRadius,this._startAngle),t=e.PathUtils.moveTo(i.x,i.y)+e.PathUtils.arcTo(this._outerRadius,this._outerRadius,this._angleExtent,1,s.x,s.y)+e.PathUtils.lineTo(o.x,o.y)+e.PathUtils.arcTo(this._innerRadius,this._innerRadius,this._angleExtent,0,n.x,n.y)+e.PathUtils.closePath()):(i=d._calcPointOnArc(this._outerRadius,this._startAngle),s=d._calcPointOnArc(this._outerRadius,this._startAngle+this._angleExtent/2),o=d._calcPointOnArc(this._innerRadius,this._startAngle),n=d._calcPointOnArc(this._innerRadius,this._startAngle+this._angleExtent/2),t=e.PathUtils.moveTo(i.x,i.y)+e.PathUtils.arcTo(this._outerRadius,this._outerRadius,this._angleExtent/2,1,s.x,s.y)+e.PathUtils.arcTo(this._outerRadius,this._outerRadius,this._angleExtent/2,1,i.x,i.y),this._innerRadius>0&&(t+=e.PathUtils.moveTo(n.x,n.y)+e.PathUtils.arcTo(this._innerRadius,this._innerRadius,this._angleExtent/2,0,o.x,o.y)+e.PathUtils.arcTo(this._innerRadius,this._innerRadius,this._angleExtent/2,0,n.x,n.y)),t+=e.PathUtils.closePath()),t},d.prototype._createExpandCollapseButton=function(t){var e=this.isDisclosed();if(!t||!this.isExpandCollapseEnabled()||!this.hasChildren()&&e||this.getView().hasDataProvider()&&!this.hasDPChildren())return null;var i=e?this._getCollapseButton():this._getExpandButton();this._positionButton(i),t.addChild(i);var o=this.getView().getOptions().translations[this.isDisclosed()?"tooltipCollapse":"tooltipExpand"];return this.getView().getEventManager().associate(i,new s(this,this.getId(),o)),i},d.prototype._positionButton=function(t){var e=d._calcPointOnArc(this._outerRadius,this._startAngle+this._angleExtent/2);t.setTranslate(e.x-d._EXPAND_ICON_SIZE/2,e.y-d._EXPAND_ICON_SIZE/2)},d.prototype._createTextNode=function(t){if(!this._textStr||!t||!this._labelDisplay||"off"===this._labelDisplay)return null;if(this===this.getView().getRootNode()&&this._angleExtent<d.TWO_PI)return null;var i=!1;return"auto"===this._labelDisplay?i="ie"===e.Agent.browser||"edge"===e.Agent.browser||"windows"!==e.Agent.os||e.Agent.isEnvironmentTest():"rotated"===this._labelDisplay&&(i=!0),i&&this._angleExtent<this.getView().__getAngleExtent()?this._createTextRotated(t):this._createTextHoriz(t)},d.prototype._createTextHoriz=function(t){var i;if(0===this._innerRadius)i={x:0,y:0};else{i=d._calcPointOnArc((this._innerRadius+this._outerRadius)/2,this._startAngle+this._angleExtent/2);var s=3*this.GetTextSize()/2,o=d._calcAngle(i.x-s/2,i.y),n=d._calcAngle(i.x+s/2,i.y);this.ContainsAngle(o)&&this.ContainsAngle(n)||(i=null)}if(!i)return null;var a=new e.OutputText(this.getView().getCtx(),this._textStr,i.x,i.y,null);a.setFontSize(this.GetTextSize()),this.ApplyLabelTextStyle(a),a.alignCenter(),a.alignMiddle(),a.setMouseEnabled(!1);for(var r=a.getDimensions(),l=i.x,h=i.x,_=i.y-r.h/2,u=i.y+r.h/2,c=!0;this.contains(l,_)&&this.contains(l,u)&&c;)l--,this._angleExtent>Math.PI&&i.x-l>=r.w&&(c=!1);for(var p=!0;this.contains(h,_)&&this.contains(h,u)&&p;)h++,this._angleExtent>Math.PI&&h-i.x>=r.w&&(p=!1);l+=3,h-=3;var g=2*Math.min(i.x-l,h-i.x);g<r.w&&(a.setX((l+h)/2),g=h-l);var f=this.getView().getOptions().nodeDefaults.labelMinLength;return e.TextUtils.fitText(a,g,r.h,t,f)?a:null},d.prototype._createTextRotated=function(t){var i=Math.max(this._innerRadius,10),s=this._outerRadius-i-d.TEXT_BUFFER_HORIZ,o=this._angleExtent*(i+d.TEXT_BUFFER_HORIZ)*1.1;if(o<=6)return null;var n=new e.OutputText(this.getView().getCtx(),this._textStr,0,0);if(n.setFontSize(this.GetTextSize()),this.ApplyLabelTextStyle(n),!e.TextUtils.fitText(n,s,o,t))return null;var a=(i+this._outerRadius)/2;if("inner"===this._labelHalign||"outer"===this._labelHalign){t.addChild(n);var r=n.getDimensions().w,l=.75*d.TEXT_BUFFER_HORIZ;"inner"===this._labelHalign?a=i+l+r/2:"outer"===this._labelHalign&&(a=this._outerRadius-l-r/2)}var h=d._calcPointOnArc(a,this._startAngle+this._angleExtent/2);n.alignCenter(),n.alignMiddle();var _=this._startAngle+this._angleExtent/2;return(_=(_=_>=d.TWO_PI?_-d.TWO_PI:_)<0?_+d.TWO_PI:_)>.5*Math.PI&&_<1.5*Math.PI&&(_+=Math.PI),n.setRotation(_),n.setTranslate(h.x,h.y),n.setMouseEnabled(!1),n},d._findNodeIndex=function(t,e){for(var i=0;i<e.length;i++)if(t===e[i])return i;return-1},d.prototype.handleMouseOver=function(){this._expandButton||(this._expandButton=this._createExpandCollapseButton(this._shape)),d.superclass.handleMouseOver.call(this)},d.prototype.handleMouseOut=function(){this._expandButton&&this._shape&&(this._shape.removeChild(this._expandButton),this._expandButton=null),d.superclass.handleMouseOut.call(this)},d.prototype.updateShapes=function(t){if(this._shape){var i=this._createPathCmd();if(this._shape.setCmds(i),!this._showRootContent()){this._text&&this._shape.removeChild(this._text),this._text=this._createTextNode(this._shape);var s=this.getLabelBackgroundColor();if(this._text&&(this.hasPattern()||s)){var o=this._text.getDimensions();this._textBackground?this._textBackground.setRect(o.x,o.y,o.w,o.h):(this._textBackground=new e.Rect(this.getView().getCtx(),o.x,o.y,o.w,o.h),s?this._textBackground.setSolidFill(s):this._textBackground.setSolidFill("#FFFFFF"),this._textBackground.setMouseEnabled(!1),this._shape.addChild(this._textBackground));var n=this._text.getMatrix();n.isIdentity()||this._textBackground.setMatrix(n)}else this._textBackground&&(this._shape.removeChild(this._textBackground),this._textBackground=null)}if(e.Agent.isTouchDevice()&&this._expandButton&&this._positionButton(this._expandButton),this._shape.setFill(this.GetFill()),t)for(var a=this.getChildNodes(),r=0;r<a.length;r++)a[r].updateShapes(!0)}},d.prototype.getDropSiteFeedback=function(){return this._shape instanceof e.Circle?new e.Circle(this.getView().getCtx(),this._shape.getCx(),this._shape.getCy(),this._shape.getRadius()):this._shape instanceof e.Path?new e.Path(this.getView().getCtx(),this._shape.getCmds()):null},d.prototype._getExpandButton=function(){return this._getButtonHelper("expand")},d.prototype._getCollapseButton=function(){return this._getButtonHelper("collapse")},d.prototype._getButtonHelper=function(t){var i=this.getView().getCtx(),s=d._EXPAND_ICON_SIZE/2,o=new e.Circle(i,s,s,s+2),n=this.getView().getOptions()._resources[t],a=e.ToolkitUtils.getIconStyle(i,n);return new e.IconButton(i,"outlined",{style:a,size:d._EXPAND_ICON_SIZE},o,null,this.expandCollapse,this)},d.prototype.__isIsolated=function(){return this._bIsolated},d.prototype.expandCollapse=function(t){this.getView().expandCollapseNode(this.getId()),t.stopPropagation()},d.prototype.getExpandCollapseButton=function(){return this._expandButton},d.prototype._showRootContent=function(){return!this._parent&&0===this._innerRadius&&this._angleExtent===d.TWO_PI},d.prototype.hasRootContent=function(){return!!this.GetTemplate()},d.prototype.__getRadius=function(){return null!=this._radius?Number(this._radius):this.GetParent()?1:this.isArtificialRoot()?d._CENTER_ARTIFICIAL_ROOT_RADIUS:this.hasRootContent()?d._CENTER_WITH_CONTENT_RADIUS:d._CENTER_NODE_RADIUS},d.prototype.getAriaLabel=function(){var t=this.getView().getOptions().translations,s=[];return this.isSelectable()&&s.push(t[this.isSelected()?"stateSelected":"stateUnselected"]),this.isExpandCollapseEnabled()&&s.push(t[this.isDisclosed()?"stateExpanded":"stateCollapsed"]),this.isDrillReplaceEnabled()&&s.push(t.stateDrillable),e.Displayable.generateAriaLabel(this.getShortDesc(),s,()=>i.getShortDescContext(this))},d.prototype.UpdateAriaLabel=function(){!e.Agent.deferAriaCreation()&&this._shape&&this._shape.setAriaProperty("label",this.getAriaLabel())},d.prototype.getDataContext=function(){var t=d.superclass.getDataContext.call(this);return t.radius=this.__getRadius(),t},d.prototype._createRootNodeContent=function(){var t=this.getView(),i=t.getOptions(),s=i.rootNodeContent.renderer;if(this._removeRootNodeContentOverlay(),!s)return!1;var o,n=t.getCtx(),a=t.getCenterPoint(),r=this._outerRadius,l=r*Math.sqrt(2),h=this.getOptions(),_=h;h._noTemplate?(o=h._itemData,_=h._itemData):h._itemData&&(o=h._itemData,_=h=e.JsonUtils.clone(h),delete h._itemData);var d={outerBounds:{x:a.x-r,y:a.y-r,width:2*r,height:2*r},innerBounds:{x:a.x-l/2,y:a.y-l/2,width:l,height:l},id:this._id,data:_,itemData:o,component:i._widgetConstructor};d=n.fixRendererContext(d);var u=n.getContainer(),c=s(d);if(!c)return!1;var p=n.createOverlayDiv();Array.isArray(c)?c.forEach(function(t){p.appendChild(t)}):p.appendChild(c),t.rootNodeContent=p,u.appendChild(p);var g=n.getOverlayAttachedCallback();return g&&g(p),!0},d.prototype._getOuterRadius=function(){return this._outerRadius},d.prototype._removeRootNodeContentOverlay=function(){var t=this.getView(),e=t.rootNodeContent;e&&t.getCtx().getContainer().removeChild(e),t.rootNodeContent=null},d.prototype._evaluateExpanded=function(t,i){var s=t.getOptions(),o=s.expanded;i.bArtificialRoot||i._expanded||(o.has?o.has(i.id)||this.setDisclosed(!1):o instanceof Array&&!e.ArrayUtils.hasAnyMapItem(s._expandedNodes,[i.id])&&this.setDisclosed(!1))};var u=function(t,i){this.Init(t,i);var s=this._view.getOptions(),o=s.nodeDefaults,n=o.header,a=i.header?i.header:{};this._groupLabelDisplay=i.groupLabelDisplay?i.groupLabelDisplay:o.groupLabelDisplay,this._labelDisplay=i.labelDisplay?i.labelDisplay:o.labelDisplay,this._labelHalign=i.labelHalign?i.labelHalign:o.labelHalign,this._labelValign=i.labelValign?i.labelValign:o.labelValign,this._headerHalign=a.labelHalign?a.labelHalign:n.labelHalign,this._headerLabelStyle=a.labelStyle?new e.CSSStyle(a.labelStyle):null,this._bHeaderUseNodeColor="on"===(a.useNodeColor?a.useNodeColor:n.useNodeColor),this._className=i.className||i.svgClassName,this._style=i.style||i.svgStyle,this._isolate=a.isolate?a.isolate:n.isolate,"auto"===this._isolate&&(this._isolate=e.Agent.isTouchDevice()?"off":"on"),this._bIsolated=null!=s.isolatedNode&&e.Obj.compareValues(this.getView().getCtx(),s.isolatedNode,this.getId())};e.Obj.createSubclass(u,i),u.TEXT_STYLE_HEADER="header",u.TEXT_STYLE_NODE="node",u.TEXT_STYLE_OFF="off",u.TEXT_BUFFER_HORIZ=5,u.TEXT_BUFFER_VERT=2,u.MIN_TEXT_BUFFER=2,u._LINE_FUDGE_FACTOR=1,u._ANIMATION_ISOLATE_DURATION=.3,u._MIN_TITLE_BAR_HEIGHT=22,u._MIN_TITLE_BAR_HEIGHT_ISOLATE=22,u.DEFAULT_HEADER_BORDER_WIDTH=1,u.DEFAULT_HEADER_WITH_NODE_COLOR_ALPHA=.5,u._ISOLATE_ICON_SIZE=12,u._ISOLATE_GAP_SIZE=4,u._ISOLATE_TOUCH_BUFFER=3,u.DEFAULT_NODE_TOP_BORDER_COLOR="#FFFFFF",u.DEFAULT_NODE_BOTTOM_BORDER_COLOR="#000000",u.DEFAULT_NODE_BORDER_WIDTH=1,u.DEFAULT_NODE_BORDER_OPACITY=.3,u.DEFAULT_NODE_PATTERN_BORDER_OPACITY=.15,u.MIN_SIZE_FOR_BORDER=2*u.DEFAULT_NODE_BORDER_WIDTH,u.GROUP_HOVER_INNER_OPACITY=.8,u.GROUP_HOVER_INNER_WIDTH=3,u.NODE_HOVER_OPACITY=1,u.NODE_SELECTION_WIDTH=2,u.prototype.render=function(t){if(this._hasLayout){var i;if(this._shape=this._createShapeNode(),t.addChild(this._shape),this.hasChildren()?(this._childNodeGroup=new e.Container(this.getView().getCtx()),this._shape.addChild(this._childNodeGroup),this.renderChildren(this._childNodeGroup)):i=this.GetTemplate(),i){var s=this.GetElAttributes(),o=this.GetAfContext();o.setELContext(s);var n=u.DEFAULT_NODE_BORDER_WIDTH+u._LINE_FUDGE_FACTOR,a=u.TEXT_BUFFER_HORIZ,r=u.TEXT_BUFFER_VERT,l=this._width-2*a-n,h=this._height-2*r-n;if(l>0&&h>0){o.setAvailableWidth(l),o.setAvailableHeight(h),o.setFontSize(this.GetTextSize());var _,d=e.AfComponentFactory.parseAndLayout(o,i,this._shape);if(this._contentRoot=d,e.Agent.isRightToLeft(t.getCtx())){var c=d.getDimensions();_=this._x+this._width-a-.5*n-c.w}else _=this._x+a+.5*n;d.setTranslate(_,this._y+r+.5*n)}}else if(!this._createCustomNodeContent()&&(this._text=this._createTextNode(this._shape),null!=this._text)){var p=this.getLabelBackgroundColor();if(this._textStyle!==u.TEXT_STYLE_HEADER&&(this.hasPattern()||p)){var g=this._text.getDimensions();this._textBackground=new e.Rect(this.getView().getCtx(),g.x,g.y,g.w,g.h),p?this._textBackground.setSolidFill(p):this._textBackground.setSolidFill("#FFFFFF"),this._textBackground.setMouseEnabled(!1),this._shape.addChild(this._textBackground),this._addChildText(this._text)}}this.hasChildren()?this._shape.setAriaRole("group"):this._shape.setAriaRole("img"),this.UpdateAriaLabel()}},u.prototype.setSelected=function(t){if(u.superclass.setSelected.call(this,t),this._shape){var s=this.getView().getOptions().nodeDefaults,o=s.header;if(this.isSelected()){var n=this._x,a=this._y+u._LINE_FUDGE_FACTOR,r=Math.max(this._width-u._LINE_FUDGE_FACTOR,0),l=Math.max(this._height-u._LINE_FUDGE_FACTOR,0);"safari"!==e.Agent.browser&&"blink"!==e.Agent.engine||(a-=u._LINE_FUDGE_FACTOR),this._removeChildShape(this._selectionOuter),this._removeChildShape(this._selectionInner),this._selectionOuter=null,this._selectionInner=null,"redwood"===this._shape.getCtx().getThemeBehavior()&&this._textStyle!==u.TEXT_STYLE_HEADER?(this._selectionOuter=new e.Rect(this.getView().getCtx(),n+.5,a+.5,Math.max(r-1,0),Math.max(l-1,0)),this._selectionInner=new e.Rect(this.getView().getCtx(),n+1.5,a+1.5,Math.max(r-3,0),Math.max(l-3,0))):(this._selectionOuter=new e.Rect(this.getView().getCtx(),n,a,r,l),this._selectionInner=new e.Rect(this.getView().getCtx(),n+1,a+1,Math.max(r-2,0),Math.max(l-2,0))),this._selectionOuter.setMouseEnabled(!1),this._selectionOuter.setFill(null),this._selectionOuter.setPixelHinting(!0),this._shape.addChild(this._selectionOuter),this._selectionInner.setMouseEnabled(!1),this._selectionInner.setFill(null),this._selectionInner.setPixelHinting(!0),this._shape.addChild(this._selectionInner),this._textStyle===u.TEXT_STYLE_HEADER?(this.IsHover||this.isShowingKeyboardFocusEffect()?this._innerShape.setSolidFill(o.hoverBackgroundColor):(this._innerShape.setSolidFill(o.selectedBackgroundColor),this._text&&this.ApplyHeaderTextStyle(this._text,"_selectedLabelStyle")),this._selectionOuter.setSolidStroke(o.selectedOuterColor),this._selectionInner.setSolidStroke(o.selectedInnerColor),e.Agent.isTouchDevice()&&(this._isolateButton=this._createIsolateRestoreButton(this._shape))):(this._selectionOuter.setSolidStroke(s.selectedOuterColor),this._selectionInner.setSolidStroke(s.selectedInnerColor),"safari"!==e.Agent.browser&&"firefox"!==e.Agent.browser&&this._shape.addDrawEffect(i.__NODE_SELECTED_SHADOW),this.getView().__moveToSelectedLayer(this._shape))}else if(this._removeChildShape(this._selectionInner),this._selectionInner=null,e.Agent.isTouchDevice()&&this._removeIsolateRestoreButton(),this._textStyle===u.TEXT_STYLE_HEADER)this.IsHover||this.isShowingKeyboardFocusEffect()?this._innerShape.setSolidFill(o.hoverBackgroundColor):(this.ApplyHeaderStyle(this._shape,this._innerShape),this._text&&(this.isDrillReplaceEnabled()?this.ApplyHeaderTextStyle(this._text,"_drillableLabelStyle"):this.ApplyHeaderTextStyle(this._text,"labelStyle"))),this._selectionOuter&&(this.IsHover||this.isShowingKeyboardFocusEffect()?this._selectionOuter.setSolidStroke(o.hoverOuterColor):(this._removeChildShape(this._selectionOuter),this._selectionOuter=null));else{this._shape.removeAllDrawEffects(),this._selectionOuter&&(this._removeChildShape(this._selectionOuter),this._selectionOuter=null);var h=this.GetParent();h&&h._childNodeGroup&&h._childNodeGroup.addChild(this._shape)}}},u.prototype.showHoverEffect=function(){if(this._shape&&this._hasLayout){var t,i,s,o,n,a=this.getView().getOptions().nodeDefaults,r=a.header,l=this._view.__getLastIsolatedNode();if(null==l||l===this||this.isDescendantOf(l))this._textStyle===u.TEXT_STYLE_HEADER?(this._innerShape.setSolidFill(r.hoverBackgroundColor),this._selectionOuter||(i=this._x,s=this._y,o=this._width-u._LINE_FUDGE_FACTOR,n=this._height-u._LINE_FUDGE_FACTOR,this._selectionOuter=new e.Rect(this.getView().getCtx(),i,s,o,n),this._selectionOuter.setMouseEnabled(!1),this._selectionOuter.setFill(null),this._selectionOuter.setPixelHinting(!0),this._shape.addChild(this._selectionOuter)),this._selectionOuter.setSolidStroke(this.isSelected()?r.selectedOuterColor:r.hoverOuterColor),i=this._x+u.GROUP_HOVER_INNER_WIDTH/2,s=this._y+this._titleBarHeight+u.GROUP_HOVER_INNER_WIDTH/2,o=this._width-u.GROUP_HOVER_INNER_WIDTH-u._LINE_FUDGE_FACTOR,n=this._height-this._titleBarHeight-u.GROUP_HOVER_INNER_WIDTH-u._LINE_FUDGE_FACTOR,t=new e.Stroke(r.hoverInnerColor,u.GROUP_HOVER_INNER_OPACITY,u.GROUP_HOVER_INNER_WIDTH),this._text&&(this.isDrillReplaceEnabled()?this.ApplyHeaderTextStyle(this._text,"_drillableHoverLabelStyle"):this.ApplyHeaderTextStyle(this._text,"_hoverLabelStyle"))):("redwood"===this._shape.getCtx().getThemeBehavior()?(i=this._x+1.5,s=this._y+1.5,o=this._width-3-u._LINE_FUDGE_FACTOR,n=this._height-3-u._LINE_FUDGE_FACTOR,t=new e.Stroke(a.selectedInnerColor,1,1)):(i=this._x+u.NODE_SELECTION_WIDTH/2,s=this._y+u.NODE_SELECTION_WIDTH/2,o=this._width-u.NODE_SELECTION_WIDTH-u._LINE_FUDGE_FACTOR,n=this._height-u.NODE_SELECTION_WIDTH-u._LINE_FUDGE_FACTOR,t=new e.Stroke(a.hoverColor,u.NODE_HOVER_OPACITY,u.NODE_SELECTION_WIDTH)),n=Math.max(n,0),o=Math.max(o,0),this.getView().__showHoverEffect(i,s,o,n,t))}},u.prototype.hideHoverEffect=function(){if(this._shape&&this._hasLayout){var t=this.getView().getOptions().nodeDefaults.header;this._textStyle===u.TEXT_STYLE_HEADER&&(this.isSelected()?(this._innerShape.setSolidFill(t.selectedBackgroundColor),this._selectionOuter.setSolidStroke(t.selectedOuterColor),this._text&&(this.isDrillReplaceEnabled()?this.ApplyHeaderTextStyle(this._text,"_drillableSelectedLabelStyle"):this.ApplyHeaderTextStyle(this._text,"_selectedLabelStyle"))):(this.ApplyHeaderStyle(this._shape,this._innerShape),this._selectionOuter&&(this._shape.removeChild(this._selectionOuter),this._selectionOuter=null),this._text&&(this.isDrillReplaceEnabled()?this.ApplyHeaderTextStyle(this._text,"_drillableLabelStyle"):this.ApplyHeaderTextStyle(this._text,"labelStyle")))),this.getView().__hideHoverEffect()}},u.prototype.highlight=function(t,e){this.hasChildren()?(this._text&&this._text.setAlpha(e),this._textStyle===u.TEXT_STYLE_HEADER&&this._bHeaderUseNodeColor&&this._innerShape&&this._innerShape.setAlpha(e)):u.superclass.highlight.call(this,t,e)},u.prototype.isIsolateEnabled=function(){return"off"!==this._isolate&&this._textStyle===u.TEXT_STYLE_HEADER},u.prototype.getNextNavigable=function(t){var i,s,o;if(t.type===e.MouseEvent.CLICK)return u.superclass.getNextNavigable.call(this,t);if((i=t.keyCode)===e.KeyboardEvent.SPACE&&t.ctrlKey)return this;if(i===e.KeyboardEvent.UP_ARROW&&t.altKey||i===e.KeyboardEvent.CLOSE_BRACKET)(s=this.GetParent())&&s.getId()!==this.getView().getRootNode().getId()?(o=s,s.MarkAsLastVisitedChild()):o=this;else if(i===e.KeyboardEvent.DOWN_ARROW&&t.altKey||i===e.KeyboardEvent.OPEN_BRACKET)o=this.GetLastVisitedChild()||(this.hasChildren()?this.getView().__getDefaultNavigable(this.getChildNodes()):this);else{var n=this.getView().__getLastIsolatedNode(),a=0;if(n){if(this!==n)for(s=this.GetParent(),a=1;n!==s;)a++,s=s.GetParent()}else{for(n=this;n.GetParent();)n=n.GetParent();a=this.GetDepth()}var r=this.GetNodesAtDepth(n,a);o=e.KeyboardHandler.getNextNavigable(this,t,r)}return o.MarkAsLastVisitedChild(),o},u.prototype.getKeyboardBoundingBox=function(t){return new e.Rectangle(this._x,this._y,this._width,this._height)},u.prototype.getTargetElem=function(){return this._shape?this._shape.getElem():null},u.prototype.setZIndex=function(t){this._zIndex=t},u.prototype.setLayoutParams=function(t,i,s,o){if(!(s<=0||o<=0)){if(this._hasLayout=!0,this._oldState=this.GetAnimationParams(),this._x=t,this._y=i,this._width=s||0,this._height=o||0,this.hasChildren()?this._textStyle=this._groupLabelDisplay:this._textStyle=this._labelDisplay,this._textStr||(this._textStyle=u.TEXT_STYLE_OFF),this._textStyle===u.TEXT_STYLE_HEADER){this._titleBarHeight=u._MIN_TITLE_BAR_HEIGHT;var n=new e.OutputText(this.getView().getCtx(),this._textStr);n.setFontSize(this.GetTextSize()),this.ApplyHeaderTextStyle(n,"labelStyle");var a=n.getDimensions().h;this._titleBarHeight=Math.max(this._titleBarHeight,a),this.isIsolateEnabled()&&(this._titleBarHeight=Math.max(this._titleBarHeight,u._MIN_TITLE_BAR_HEIGHT_ISOLATE));var r=this._x,l=this._y+this._titleBarHeight,h=this._width,_=this._height-this._titleBarHeight;if(h>=0&&_>=0)return new e.Rectangle(r,l,h,_);this._textStyle=null}return new e.Rectangle(this._x,this._y,this._width,this._height)}},u.prototype.getNodeUnderPoint=function(t,e){if(this.contains(t,e)||!this._hasLayout){for(var i=this.getChildNodes(),s=0;s<i.length;s++)if(i[s].contains(t,e))return i[s].getNodeUnderPoint(t,e);if(this._hasLayout)return this}return null},u.prototype.contains=function(t,e){return t>=this._x&&t<=this._x+this._width&&e>=this._y&&e<=this._y+this._height},u.prototype.GetAnimationParams=function(){var t=e.ColorUtils.getRed(this._color),i=e.ColorUtils.getGreen(this._color),s=e.ColorUtils.getBlue(this._color);return[this._x,this._y,this._width,this._height,t,i,s,this.hasChildren()?0:Math.random()]},u.prototype.SetAnimationParams=function(t){this.setLayoutParams(t[0],t[1],t[2],t[3]);var i=Math.round(t[4]),s=Math.round(t[5]),o=Math.round(t[6]);this._color=e.ColorUtils.makeRGB(i,s,o),this._updateShapes()},u.prototype.getIsolateAnimation=function(){for(var t=[this._getIsolateAnimation()],e=this.getDescendantNodes(),i=0;i<e.length;i++)t.push(e[i]._getIsolateAnimation());return t},u.prototype._getIsolateAnimation=function(){if(this._oldState){var t=new e.CustomAnimation(this.getView().getCtx(),this,u._ANIMATION_ISOLATE_DURATION);return t.getAnimator().addProp(e.Animator.TYPE_NUMBER_ARRAY,this,this.GetAnimationParams,this.SetAnimationParams,this.GetAnimationParams()),this.SetAnimationParams(this._oldState),t}return null},u.prototype.animateUpdate=function(t,e){this._removeAllNodeContent();var i=e._hasLayout&&e._width>0&&e._height>0,s=this._hasLayout&&this._width>0&&this._height>0;return 0===this.GetDepth()||i&&s?u.superclass.animateUpdate.call(this,t,e):s?this.animateInsert(t):i?this.animateDelete(t,t.getDeleteContainer()):null},u.prototype.animateInsert=function(t,e){this._removeAllNodeContent(),u.superclass.animateInsert.call(this,t,e)},u.prototype.animateDelete=function(t,e){this._removeAllNodeContent(),u.superclass.animateDelete.call(this,t,e)},u.prototype._createShapeNode=function(){var t,i=this.getView().getCtx(),s="gaps"===this.getView().getOptions().nodeSeparators;if(this._textStyle===u.TEXT_STYLE_HEADER){if(s){var o=this._getGeometriesWithGaps();t=new e.Rect(i,o._shape.x,o._shape.y,o._shape.w,o._shape.h),this._innerShape=new e.Rect(i,o._innerShape.x,o._innerShape.y,o._innerShape.w,o._innerShape.h),this._backgroundShape=new e.Rect(i,o._backgroundShape.x,o._backgroundShape.y,o._backgroundShape.w,o._backgroundShape.h),this._backgroundShape.setSolidFill("#FFFFFF"),t.addChild(this._backgroundShape)}else t=new e.Rect(i,this._x,this._y,this._width,this._height),this._innerShape=new e.Rect(i,this._x+1,this._y+1,this._width-2,this._height-2);this.ApplyHeaderStyle(t,this._innerShape),this._innerShape.setMouseEnabled(!1),t.addChild(this._innerShape),this.__isIsolated()&&(this._isolateButton=this._createIsolateRestoreButton(t))}else{var n=this.GetFill();if(s){var a=this._getGeometriesWithGaps();(t=new e.Rect(i,a._shape.x,a._shape.y,a._shape.w,a._shape.h)).setFill(this.hasChildren()?e.SolidFill.invisibleFill():n)}else{if(t=new e.Rect(i,this._x,this._y,this._width,this._height),(this.getView().__getNodeCount()<1e3||!e.Agent.isTouchDevice())&&this._width>=u.MIN_SIZE_FOR_BORDER&&this._height>=u.MIN_SIZE_FOR_BORDER){var r=this.getColor(),l=e.ColorUtils.interpolateColor(u.DEFAULT_NODE_TOP_BORDER_COLOR,r,1-u.DEFAULT_NODE_BORDER_OPACITY),h=e.ColorUtils.interpolateColor(u.DEFAULT_NODE_BOTTOM_BORDER_COLOR,r,1-u.DEFAULT_NODE_BORDER_OPACITY),_=Math.min(this._width,this._height);_>=4?(t.setSolidFill(h),this._topLeftShape=new e.Rect(i,this._x,this._y,this._width-1,this._height-1),this._topLeftShape.setSolidFill(l),this._topLeftShape.setMouseEnabled(!1),t.addChild(this._topLeftShape),this._fillShape=new e.Rect(i,this._x+1,this._y+1,this._width-2,this._height-2),this._fillShape.setFill(n),this._fillShape.setMouseEnabled(!1),t.addChild(this._fillShape)):_>=2?(t.setSolidFill(h),this._fillShape=new e.Rect(i,this._x,this._y,this._width-1,this._height-1),this._fillShape.setFill(n),this._fillShape.setMouseEnabled(!1),t.addChild(this._fillShape)):t.setFill(n)}else t.setFill(n)}t.setStyle(this._style),t.setClassName(this._className)}return this.getView().getEventManager().associate(t,this),this.isSelectable()?t.setSelectable(!0):this.isDrillReplaceEnabled()?t.setCursor("pointer"):t.setCursor("default"),t.zIndex=this._zIndex,t},u.prototype._createIsolateRestoreButton=function(t){if(this._textStyle!==u.TEXT_STYLE_HEADER||!this.isIsolateEnabled())return null;var i=null,s=this._x,o=this._x+this._width-u._LINE_FUDGE_FACTOR,n=this._y+u._LINE_FUDGE_FACTOR,a=this._y+this._titleBarHeight;if(o-s-2*u._ISOLATE_GAP_SIZE>u._ISOLATE_ICON_SIZE){var r;if(i=this.__isIsolated()?this._getRestoreButton():this._getIsolateButton(),r=e.Agent.isRightToLeft(t.getCtx())?s+u._ISOLATE_GAP_SIZE:o-u._ISOLATE_ICON_SIZE-u._ISOLATE_GAP_SIZE,i.setTranslate(r,(a+n-u._ISOLATE_ICON_SIZE)/2),t.addChild(i),e.Agent.isTouchDevice()){var l=new e.Rect(t.getCtx(),-u._ISOLATE_TOUCH_BUFFER,-u._ISOLATE_TOUCH_BUFFER,u._ISOLATE_ICON_SIZE+2*u._ISOLATE_TOUCH_BUFFER,u._ISOLATE_ICON_SIZE+2*u._ISOLATE_TOUCH_BUFFER);l.setInvisibleFill(),i.addChild(l)}this.getView().getEventManager().associate(i,this)}return i},u.prototype._removeIsolateRestoreButton=function(){this._isolateButton&&(this._removeChildShape(this._isolateButton),this._isolateButton=null)},u.prototype._createTextNode=function(t){var i=e.Agent.isRightToLeft(t.getCtx());if(!this._textStr||!t||!this._textStyle||this._textStyle===u.TEXT_STYLE_OFF)return null;var o=this._height,n=this.GetTextSize();if(n>o)return null;var a=this._textStyle===u.TEXT_STYLE_NODE?this._labelHalign:this._headerHalign;i&&("start"===a?a="end":"end"===a&&(a="start"));var r,l=this._width-(u.TEXT_BUFFER_HORIZ+u.MIN_TEXT_BUFFER),h=0;if(this.isIsolateEnabled()&&(h=u._ISOLATE_ICON_SIZE+u._ISOLATE_GAP_SIZE,l-="center"===a?2*h:h),l<=0)return null;var _=this.getMergedLabelTextStyle();if(r=this._textStyle===u.TEXT_STYLE_NODE&&o>2*n&&"nowrap"!==_.getStyle(e.CSSStyle.WHITE_SPACE)&&e.TextUtils.getTextStringWidth(this.getView().getCtx(),this._textStr,_)>l?new e.MultilineText(this.getView().getCtx(),this._textStr):new e.OutputText(this.getView().getCtx(),this._textStr),"start"===a?(i?r.setX(this._x+u.TEXT_BUFFER_HORIZ+h):r.setX(this._x+u.TEXT_BUFFER_HORIZ),r.alignLeft()):"center"===a?(r.setX(this._x+this._width/2),r.alignCenter()):"end"===a&&(i?r.setX(this._x+this._width-u.TEXT_BUFFER_HORIZ):r.setX(this._x+this._width-u.TEXT_BUFFER_HORIZ-h),r.alignRight()),this._textStyle===u.TEXT_STYLE_NODE)this.ApplyLabelTextStyle(r),o=this._height-2*u.TEXT_BUFFER_VERT;else if(this._textStyle===u.TEXT_STYLE_HEADER){var d="safari"===e.Agent.browser||"blink"===e.Agent.engine?u._LINE_FUDGE_FACTOR:0;r.setY(this._y+u.DEFAULT_HEADER_BORDER_WIDTH+this._titleBarHeight/2+d),r.alignMiddle(),this.ApplyHeaderTextStyle(r,"labelStyle")}if(this._textStyle===u.TEXT_STYLE_HEADER&&this.isDrillReplaceEnabled()){this.ApplyHeaderTextStyle(r,"_drillableLabelStyle"),r.setCursor("pointer");var c=new s(this,this.getId(),null,this.getDatatip.bind(this),this.getDatatipColor.bind(this));c.setDrillable(!0),this.getView().getEventManager().associate(r,c)}else r.setMouseEnabled(!1);var p=this.getView().getOptions().nodeDefaults.labelMinLength,g=e.TextUtils.fitText(r,l,o,t,p);if(this._textStyle===u.TEXT_STYLE_NODE){var f=r.getDimensions().h;"top"===this._labelValign?r.setY(this._y+u.TEXT_BUFFER_VERT):"center"===this._labelValign?r.setY(this._y+this._height/2-f/2):"bottom"===this._labelValign&&r.setY(this._y+this._height-u.TEXT_BUFFER_VERT-f)}return g?r:null},u.prototype.ApplyHeaderStyle=function(t,i){var s=this.getView().getOptions().nodeDefaults.header;if(this._bHeaderUseNodeColor){var o=this.getColor();i.setSolidFill(o);var n=e.ColorUtils.interpolateColor(s.borderColor,o,1-u.DEFAULT_HEADER_WITH_NODE_COLOR_ALPHA);t.setSolidFill(n)}else t.setSolidFill(s.borderColor),i.setSolidFill(s.backgroundColor);this._backgroundShape&&this._backgroundShape.setFill(i.getFill())},u.prototype.ApplyHeaderTextStyle=function(t,s){var o=[];this.GetDepth()<=1&&this.getView().__getMaxDepth()>=3&&o.push(new e.CSSStyle("font-weight:bold;")),o.push(this.getView().getOptions().nodeDefaults.header._labelStyle),o.push(this.getView().getOptions().nodeDefaults.header[s]),this._headerLabelStyle&&o.push(this._headerLabelStyle),o.push(new e.CSSStyle(this.getView().getOptions().nodeDefaults.header.labelStyle)),!this._bHeaderUseNodeColor||"labelStyle"!==s&&"_drillableLabelStyle"!==s||o.push(new e.CSSStyle("color: "+i.GetNodeTextColor(this))),t.setCSSStyle(e.CSSStyle.mergeStyles(o))},u.prototype.handleMouseOver=function(){this._isolateButton||e.Agent.isTouchDevice()||(this._isolateButton=this._createIsolateRestoreButton(this._shape)),u.superclass.handleMouseOver.call(this)},u.prototype.handleMouseOut=function(){!0===this.__isIsolated()||e.Agent.isTouchDevice()||this._removeIsolateRestoreButton(),u.superclass.handleMouseOut.call(this)},u.prototype._getGeometriesWithGaps=function(){var t={};if(this._textStyle===u.TEXT_STYLE_HEADER){t._shape=new e.Rectangle(this._x,this._y,this._width-1,this._titleBarHeight),t._innerShape=new e.Rectangle(this._x+1,this._y+1,this._width-3,this._titleBarHeight-1);var i=Math.max(this._width-1,0),s=Math.max(this._height-this._titleBarHeight-1,0);t._backgroundShape=new e.Rectangle(this._x,this._y+this._titleBarHeight,i,s)}else if(this.hasChildren())t._shape=new e.Rectangle(this._x,this._y,0,0);else{var o=Math.max(this._width-1,0),n=Math.max(this._height-1,0);t._shape=new e.Rectangle(this._x,this._y,o,n)}return t},u.prototype._updateShapes=function(){if(this._shape){var t=this.getView().getOptions();if("gaps"===t.nodeSeparators){var e=this._getGeometriesWithGaps();this._shape.setRect(e._shape),this._innerShape&&this._innerShape.setRect(e._innerShape),this._backgroundShape&&this._backgroundShape.setRect(e._backgroundShape)}else this._shape.setRect(this._x,this._y,this._width,this._height),this._innerShape&&this._innerShape.setRect(this._x+1,this._y+1,this._width-2,this._height-2);(this._textStyle!==u.TEXT_STYLE_HEADER||this._bHeaderUseNodeColor)&&this._shape.setFill(this.GetFill()),this.isSelected()&&this.setSelected(!1),this._removeChildShape(this._fillShape),this._removeChildShape(this._topLeftShape),this._fillShape=null,this._topLeftShape=null,this._removeIsolateRestoreButton(),this.GetTemplate()?(this._removeChildShape(this._contentRoot),this._contentRoot=null):t.nodeContent&&t.nodeContent.renderer&&this._textStyle!==u.TEXT_STYLE_HEADER?this._removeAllNodeContent():(this._removeChildShape(this._textBackground),this._textBackground=null,this._text&&this._text.getParent().removeChild(this._text),this._text=this._createTextNode(this._shape))}},u.prototype.getDropSiteFeedback=function(){return this._shape?new e.Rect(this.getView().getCtx(),this._shape.getX(),this._shape.getY(),this._shape.getWidth(),this._shape.getHeight()):null},u.prototype._addChildText=function(t){this._textStyle===u.TEXT_STYLE_NODE&&this.hasChildren()?this.getView().__getGroupTextLayer().addChild(t):this._shape.addChild(t)},u.prototype._removeChildShape=function(t){t&&this._shape.removeChild(t)},u.prototype._getIsolateButton=function(){return this._getButtonHelper("isolate",this.__isolateNode)},u.prototype._getRestoreButton=function(){return this._getButtonHelper("restore",this.__restoreNode)},u.prototype._getButtonHelper=function(t,i){var s=this.getView().getCtx(),o=this.getView().getOptions()._resources[t],n=e.ToolkitUtils.getIconStyle(s,o),a=new e.IconButton(s,"borderless",{style:n,size:u._ISOLATE_ICON_SIZE});return a.addEvtListener(e.MouseEvent.CLICK,i,!1,this),a},u.prototype.__isIsolated=function(){return this._bIsolated},u.prototype.__isolateNode=function(t){this._bIsolated=!0,this._removeAllNodeContent(),this.hideHoverEffect(),this.getView().__isolate(this),this._removeIsolateRestoreButton(),this.UpdateAriaLabel(),t&&t.stopPropagation()},u.prototype.__restoreNode=function(t){this._bIsolated=!1,this.hideHoverEffect(),this.getView().__restore(),this._removeIsolateRestoreButton(),this.UpdateAriaLabel(),t&&t.stopPropagation()},u.prototype.getIsolateRestoreButton=function(){return this._isolateButton},u.prototype.getDatatip=function(t,i,s){return t&&t instanceof e.IconButton?null:u.superclass.getDatatip.call(this,t,i,s)},u.prototype.getDatatipColor=function(t){return t&&t instanceof e.IconButton?null:u.superclass.getDatatipColor.call(this,t)},u.prototype.getTooltip=function(t){return t&&t instanceof e.IconButton?this.getView().getOptions().translations[this.__isIsolated()?"tooltipRestore":"tooltipIsolate"]:null},u.prototype.getAriaLabel=function(){var t=this.getView().getOptions().translations,s=[];return this.isSelectable()&&s.push(t[this.isSelected()?"stateSelected":"stateUnselected"]),this.__isIsolated()&&s.push(t.stateIsolated),this.isDrillReplaceEnabled()&&s.push(t.stateDrillable),e.Displayable.generateAriaLabel(this.getShortDesc(),s,()=>i.getShortDescContext(this))},u.prototype.UpdateAriaLabel=function(){!e.Agent.deferAriaCreation()&&this._shape&&this._shape.setAriaProperty("label",this.getAriaLabel())},u.prototype._createCustomNodeContent=function(){var t=this.getView(),i=t.getOptions(),s=this.getId();this._removeNodeContent(s);var o=i.nodeContent.renderer;if(!o||this.hasChildren())return!1;var n=t.getIsolatedNodes();if(n.length<=0||this.isDescendantOf(n[t._isolatedNodes.length-1])){var a,r=t.getCtx(),l=this.getOptions(),h=l;l._noTemplate?(a=l._itemData,h=l._itemData):l._itemData&&(a=l._itemData,h=l=e.JsonUtils.clone(l),delete l._itemData);var _={bounds:{x:this._x,y:this._y,width:this._width-u.DEFAULT_NODE_BORDER_WIDTH,height:this._height-u.DEFAULT_NODE_BORDER_WIDTH},id:s,data:h,itemData:a,component:l._widgetConstructor};_=r.fixRendererContext(_);var d=r.getContainer(),c=o(_);if(!c)return!1;var p=r.createOverlayDiv();Array.isArray(c)?c.forEach(function(t){p.appendChild(t)}):p.appendChild(c),t.getNodeContent()[s]=p,d.appendChild(p);var g=r.getOverlayAttachedCallback();g&&g(p)}return!0},u.prototype._removeNodeContent=function(t){var e=this.getView(),i=e.getNodeContent(),s=i[t];s&&(e.getCtx().getContainer().removeChild(s),delete i[t])},u.prototype._removeAllNodeContent=function(){for(var t in this.getView().getNodeContent())this._removeNodeContent(t)};var c=function(t){this._treeView=t};e.Obj.createSubclass(c,e.Automation),c.NODE_ID_PREFIX="node",c.BREADCRUMBS_PREFIX="breadcrumbs",c.DISCLOSURE_SUFFIX="disclosure",c.ISOLATE_SUFFIX="isolate",c.RESTORE="restore",c.prototype.GetSubIdForDomElement=function(t){var o,n=this._treeView.getLogicalObject(t),a=this._treeView.getRootNode(),r=t instanceof e.Button||t instanceof e.IconButton;if(((o=t.getParent())instanceof e.Button||o instanceof e.IconButton)&&(t=o,r=!0),!n)return(o=t.getParent())instanceof _?c.BREADCRUMBS_PREFIX+"["+o.getCrumbIndex(t)+"]":null;var l=null;if(n instanceof s&&r){var h=n._node;return l=this.GetSubIdForDomElement(h.getDisplayable()),this._getSubIdForButton(l,h,t)}if(n instanceof i){var d=n,u="";if(!a.isArtificialRoot()){if(d==a)return c.NODE_ID_PREFIX+"[0]";u+="[0]"}var p=this._getIndicesFromNode(d,a.getChildNodes());return(u=p?u+p:u).length>0&&(l=c.NODE_ID_PREFIX+u),r?this._getSubIdForButton(l,n,t):l}return null},c.prototype._getSubIdForButton=function(t,e,i){if(t){if(e instanceof u){var s=i.getAriaProperty("label"),o=e.getView().getOptions().translations.stateIsolated;return s.indexOf(o)>=0?c.RESTORE:t+":"+c.ISOLATE_SUFFIX}if(e instanceof d)return t+":"+c.DISCLOSURE_SUFFIX}return null},c.prototype._getIndicesFromNode=function(t,e){if(e&&e.length>0)for(var i=0;i<e.length;i++){if(e[i]==t)return"["+i+"]";var s=this._getIndicesFromNode(t,e[i].getChildNodes());if(s)return"["+i+"]"+s}return null},c.prototype.getDomElementForSubId=function(t){if(!t)return null;var i=this._treeView.getRootNode();if(t==e.Automation.TOOLTIP_SUBID)return this.GetTooltipElement(this._treeView);if(0==t.indexOf(c.BREADCRUMBS_PREFIX)){var s=t.substring(t.indexOf("[")+1,t.indexOf("]")),o=i.getView().getBreadcrumbs().getCrumb(s);return o?o.getElem():null}if(t==c.RESTORE){var n=this._treeView._restoreNode||this._treeView.__getLastIsolatedNode();if(n)return n.getIsolateRestoreButton().getElem()}i.isArtificialRoot()||(t=t.substring(0,t.indexOf("["))+t.substring(t.indexOf("]")+1));var a=-1==t.indexOf("[")?i:this._getNodeFromSubId(i,t);if(a){var r=t.indexOf(":");if(!(r>=0))return a.getDisplayable().getElem();if(t=t.substring(r+1),a instanceof d&&t==c.DISCLOSURE_SUFFIX){var l=a.getExpandCollapseButton();if(l)return l.getElem()}if(a instanceof u&&t==c.ISOLATE_SUFFIX){var h=a.getIsolateRestoreButton();if(h)return h.getElem()}}return null},c.prototype._getNodeFromSubId=function(t,e){var i=e.indexOf("["),s=e.indexOf("]");if(i>=0&&s>=0){var o=e.substring(i+1,s),n=(e=e.substring(s+1)).indexOf("["),a=e.indexOf("]"),r=c._getNodeByIndex(t.getChildNodes(),o);return r&&n>=0&&a>=0?this._getNodeFromSubId(r,e):r}},c.prototype._getNodeFromPath=function(t,e){var i=e.shift(),s=c._getNodeByIndex(t.getChildNodes(),i);return 0==e.length?s:e.length>0?this._getNodeFromPath(s,e):null},c.prototype.getNode=function(t){var e=this._treeView.getRootNode();if(!e)return null;e.isArtificialRoot()||0!=t[0]||t.shift();var i=0==t.length?e:this._getNodeFromPath(e,t);return i?{color:i.getColor(),label:i.getLabel(),selected:null!=i.isSelected()&&i.isSelected(),size:i.getSize(),tooltip:i.getShortDesc()}:null},c._getNodeByIndex=function(t,e){for(var i=0;i<t.length;i++)if(e==t[i].getIndex())return t[i];return null};var p=function(){};e.Obj.createSubclass(p,e.Obj),p._COMPONENT_GAP=6,p._ENABLED_INLINE_STYLE="color: #003286;",p.render=function(t,i,s,o){var n=t.getCtx(),a=t.getOptions().styleDefaults,r=new Array;r.push(new e.CSSStyle(p._ENABLED_INLINE_STYLE)),r.push(a._drillTextStyle);var l=e.CSSStyle.mergeStyles(r).toString(),h=l+"text-decoration: underline;",d=new Array;d.push(a._currentTextStyle);var u={labelStyle:l,labelStyleOver:h,labelStyleDown:h,disabledLabelStyle:e.CSSStyle.mergeStyles(d).toString()},c=new _(n,t.__processBreadcrumbsEvent,t,u);t.addChild(c);var g=s.slice(0).reverse();g.push({label:o});var f={items:g};c.render(f,i.w);var y=c.getDimensions();c.setTranslate(i.x,i.y);var E=y.h+p._COMPONENT_GAP;return i.y+=E,i.h-=E,t.removeChild(c),c};var g=function(t,e){g.superclass.constructor.call(this,t,e),this._tree=e};e.Obj.createSubclass(g,e.CategoryRolloverHandler,"DvtTreeCategoryRolloverHandler"),g.prototype.GetRolloverCallback=function(t,i,s,o){return e.Obj.createCallback(this,function(){this.SetHighlightMode(!0),this._processHighlighting(),this.FireCallback(t)})},g.prototype._highlightDescendants=function(t){for(var i,s,n=new Set(o.getAllIds(t)),a=o.getAllNodes(this._tree.getRootNode()),r=0;r<a.length;r++)i=a[r],s=t&&!n.has(i.getId()),i.highlight(s,s?e.CategoryRolloverHandler._FADE_OUT_OPACITY:1)},g.prototype.GetRolloutCallback=function(t,i,s,o){return e.Obj.createCallback(this,function(){this.SetHighlightModeTimeout(),this._processHighlighting(),this.FireCallback(t)})},g.prototype._processHighlighting=function(){var t=this._tree,i=t.getOptions();if("descendants"===i.highlightMode){var s=t.EventManager.getCurrentHoverObj();this._highlightDescendants(s)}else e.CategoryRolloverHandler.highlight(i.highlightedCategories,o.getAllNodes(t.getRootNode()),"any"==i.highlightMatch)};var f=function(t,e,i,s){this.Init(e,i,s,t),this._view=t};e.Obj.createSubclass(f,e.EventManager),f.prototype.GetView=function(){return this._view},f.prototype.OnDblClickInternal=function(t){var e=this.GetLogicalObject(t.target);e&&e.isSelectable&&e.isSelectable()&&this._processDrill(e,t.shiftKey)},f.prototype.OnClick=function(t){f.superclass.OnClick.call(this,t);var e=this.GetLogicalObject(t.target);this._processNodeLabel(e),!e||e.isSelectable&&e.isSelectable()||this._processDrill(e,t.shiftKey)},f.prototype.OnMouseOver=function(t){f.superclass.OnMouseOver.call(this,t);var e=this.GetLogicalObject(t.target);e&&e.handleMouseOver&&e.handleMouseOver()},f.prototype.OnMouseOut=function(t){f.superclass.OnMouseOut.call(this,t);var i=this.GetLogicalObject(t.target);if(i&&i.handleMouseOut){var s=this.GetLogicalObject(t.relatedTarget),o=s&&s.getId?s.getId():null;null!=i.getId()&&e.Obj.compareValues(this.getCtx(),o,i.getId())||i.handleMouseOut()}},f.prototype.ProcessKeyboardEvent=function(t){var i=!1,s=t.keyCode,o=this.getFocus();return s!=e.KeyboardEvent.ENTER||t.ctrlKey?i=f.superclass.ProcessKeyboardEvent.call(this,t):((o=this.getFocus()).isDrillReplaceEnabled&&o.isDrillReplaceEnabled()&&(t.shiftKey&&(o=this._view.getRootNode()),this._view.__drill(o.getId(),t.shiftKey)),e.EventManager.consumeEvent(t),i=!0),i},f.prototype.HandleTouchClickInternal=function(t){var e=t.target,s=this.GetLogicalObject(e);this._processNodeLabel(s),this._currentHoverItem&&this._currentHoverItem!=s&&(this._currentHoverItem.handleMouseOut(),this._currentHoverItem=null),s&&(s instanceof i&&this._currentHoverItem!=s&&(this._currentHoverItem=s,s.handleMouseOver()),s.isSelectable&&s.isSelectable()||this._processDrill(s,t.shiftKey))},f.prototype.HandleTouchDblClickInternal=function(t){var e=t.target,i=this.GetLogicalObject(e);i&&i.isSelectable&&i.isSelectable()&&this._processDrill(i,!1)},f.prototype._processNodeLabel=function(t){t&&t instanceof s&&t.isDrillable()&&this._view.__drill(t.getId(),!1)},f.prototype._processDrill=function(t,e){t.isDrillReplaceEnabled&&t.isDrillReplaceEnabled()&&this._view.__drill(t.getId(),e)},f.prototype.ProcessRolloverEvent=function(t,i,s){var n=this._view.getOptions();if("dim"==n.hoverBehavior){this._currentHoverItem=s?i:null;var a=i.getCategories?i.getCategories():[];n.highlightedCategories=s?a.slice():null;var r=e.EventFactory.newCategoryHighlightEvent(n.highlightedCategories,s),l=o.getAllNodes(this.GetView().getRootNode()),h=e.CSSStyle.getTimeMilliseconds(n.hoverBehaviorDelay);this.RolloverHandler.processEvent(r,l,h,"any"==n.highlightMatch)}},f.prototype.CreateCategoryRolloverHandler=function(t,e){return new g(t,e)},f.prototype.getCurrentHoverObj=function(){return this._currentHoverItem},f.prototype.GetTouchResponse=function(){return this._view.getOptions().touchResponse};var y=function(t){this.Init(t)};e.Obj.createSubclass(y,e.KeyboardHandler),y.prototype.isSelectionEvent=function(t){return this.isNavigationEvent(t)&&!t.ctrlKey},y.prototype.isMultiSelectEvent=function(t){return t.keyCode==e.KeyboardEvent.SPACE&&t.ctrlKey};var E=function(){};e.Obj.createSubclass(E,e.Obj),E._LEGEND_GAP=4,E._LEGEND_LABEL_GAP=7,E._LEGEND_SECTION_GAP=24,E._LABEL_SIZE=11,E._LABEL_INLINE_STYLE="color:"+(E._LABEL_COLOR="#636363")+";",E.render=function(t,i){var s=t.getOptions(),o=s.sizeLabel,n=s.colorLabel;if(null!=o&&""!=o||null!=n&&""!=n){var a=t.getCtx(),r=(t.getEventManager(),new e.Container(a));t.addChild(r);var l=E._renderLabels(a,t,r,i.w,o,n);(new Array).push(s.styleDefaults._labelStyle);var h=l?l.getDimensions():null;l&&l.setTranslateX(i.y+(i.w-h.w)/2);var _=r.getDimensions();return r.setTranslateY(i.y+i.h-_.h),i.h-=_.h+E._LEGEND_GAP,t.removeChild(r),r}},E._renderLabels=function(t,i,s,o,n,a){var r=e.Agent.isRightToLeft(t),l=i.getEventManager(),h=i.getOptions().styleDefaults,_=null;if(n||a){_=new e.Container(t),s.addChild(_);var d=new Array;d.push(h._attributeTypeTextStyle);var u=e.CSSStyle.mergeStyles(d);(d=new Array).push(h._attributeValueTextStyle);var c,p,g,f,y,S,v,C,b=e.CSSStyle.mergeStyles(d),A=0;if(n){var T=i.getOptions().translations.labelSize;(c=new e.OutputText(t,T,0,0)).setCSSStyle(u),_.addChild(c),g=c.getDimensions().w,(p=new e.OutputText(t,n,0,0)).setCSSStyle(b),_.addChild(p),A=g+(f=p.getDimensions().w)+E._LEGEND_LABEL_GAP}var O=0;if(a){var I=i.getOptions().translations.labelColor;(y=new e.OutputText(t,I,0,0)).setCSSStyle(u),_.addChild(y),v=y.getDimensions().w,(S=new e.OutputText(t,a,0,0)).setCSSStyle(b),_.addChild(S),O=v+(C=S.getDimensions().w)+E._LEGEND_LABEL_GAP}if(A+O>(o-=E._LEGEND_SECTION_GAP)){var R=o/2;if(A>R&&O>R){var x=R-g-E._LEGEND_LABEL_GAP;e.TextUtils.fitText(p,x,1/0,_)?(f=p.getDimensions().w,l.associate(p,new e.SimpleObjPeer(n))):(_.removeChild(c),_.removeChild(p),p=null,f=0);var D=R-v-E._LEGEND_LABEL_GAP;e.TextUtils.fitText(S,D,1/0,_)?(C=S.getDimensions().w,l.associate(S,new e.SimpleObjPeer(a))):(_.removeChild(y),_.removeChild(S),S=null,C=0)}else A>O?e.TextUtils.fitText(p,o-O-g-E._LEGEND_LABEL_GAP,1/0,_)?(f=p.getDimensions().w,l.associate(p,new e.SimpleObjPeer(n))):(_.removeChild(c),_.removeChild(p),p=null,f=0):e.TextUtils.fitText(S,o-A-v-E._LEGEND_LABEL_GAP,1/0,_)?(C=S.getDimensions().w,l.associate(S,new e.SimpleObjPeer(a))):(_.removeChild(y),_.removeChild(S),S=null,C=0)}var m=0;r?(S&&(S.setX(m),m+=C+E._LEGEND_LABEL_GAP,y.setX(m),m+=v+E._LEGEND_SECTION_GAP),p&&(p.setX(m),m+=f+E._LEGEND_LABEL_GAP,c.setX(m))):(p&&(c.setX(m),m+=g+E._LEGEND_LABEL_GAP,p.setX(m),m+=f+E._LEGEND_SECTION_GAP),S&&(y.setX(m),m+=v+E._LEGEND_LABEL_GAP,S.setX(m)))}return _};var S=function(){};e.Obj.createSubclass(S,e.BaseComponent),S.prototype.Init=function(t,e,i){S.superclass.Init.call(this,t,e,i),this.EventManager=this.CreateEventManager(this,t,this.dispatchEvent,this),this.EventManager.addListeners(this),this._legend=null,this._hasFocus=!1,this._navigableIdToFocus=null},S.prototype.SetOptions=function(t){if(t){if(this.Options=this.Defaults.calcOptions(t),e.Agent.isEnvironmentTest()&&(this.Options.animationOnDisplay="none",this.Options.animationOnDataChange="none"),this.Options._nodes=this.Options.nodes,this.Options.rootNode){this.Options._ancestors=null;var i=o.findRootAndAncestors(this.getCtx(),this.Options.nodes,this.Options.rootNode,[]);i&&i.root&&(this.Options.nodes=[i.root]),i&&i.ancestors&&(this.Options._ancestors=i.ancestors)}}else this.Options||(this.Options=this.GetDefaults())},S.prototype.render=function(t,i,s){var o=t||!this.Options;this.SetOptions(t);var a=this._processNodes();this.ApplyParsedProperties({root:a}),isNaN(i)||isNaN(s)||(this.Width=i,this.Height=s),this.EventManager&&this.EventManager.hideTooltip();var r=new e.Rectangle(0,0,this.Width,this.Height);this.Layout(r);var l=new e.Container(this.getCtx());this.addChild(l),this._templates&&(this._afContext=new e.AfContext(this.getCtx(),this.EventManager),this._afContext.setRmIfNotFit(!0)),this.Render(l,r),this.StopAnimation();var h=this.getOptions().animationOnDataChange,_=new e.Rectangle(0,0,this.Width,this.Height),d=!1;if(this._container){if(h&&o)if(e.BlackBoxAnimationHandler.isSupported(h))this.Animation=e.BlackBoxAnimationHandler.getCombinedAnimation(this.getCtx(),h,this._container,l,_,this.AnimationDuration),d=!0;else if(this._oldRoot&&"auto"==h){this._deleteContainer=this.GetDeleteContainer(),this.addChild(this._deleteContainer);var u=new n(this.getCtx(),this._deleteContainer);u.animate(this._oldRoot,this._root,this._oldAncestors,this._ancestors),this.Animation=u.getAnimation(!0)}}else this.Animation=this.GetDisplayAnimation(l,_);this._oldRoot=null,this._oldAncestors=null,this.Animation&&(this.EventManager.removeListeners(this),this.Animation.setOnEnd(this.OnAnimationEnd,this),this.Animation.play()),d?this._oldContainer=this._container:this._container&&this.removeChild(this._container),this._container=l,o?this._processInitialSelections():this.ReselectNodes(),this._processInitialFocus(!this.Animation),this.Animation||this._processInitialHighlighting(),this.UpdateAriaAttributes(),this.Animation||this.RenderComplete()},S.prototype.Parse=function(t){return null},S.prototype.Layout=function(t){},S.prototype.Render=function(t,e){},S.prototype.RenderBackground=function(t,i){var s=new e.Rect(this.getCtx(),0,0,this.Width,this.Height);s.setInvisibleFill(),t.addChild(s)},S.prototype.LayoutBreadcrumbs=function(t){if(this._ancestors.length>0){var e=this._root?this._root.getLabel():null;this._breadcrumbs&&this.EventManager.removeComponentKeyboardHandler(this._breadcrumbs.getEventManager()),this._breadcrumbs=p.render(this,t,this._ancestors,e),this.EventManager.addComponentKeyboardHandlerAt(this._breadcrumbs.getEventManager(),0)}else this._breadcrumbs&&this.EventManager.removeComponentKeyboardHandler(this._breadcrumbs.getEventManager()),this._breadcrumbs=null},S.prototype.RenderBreadcrumbs=function(t){this._breadcrumbs&&t.addChild(this._breadcrumbs)},S.prototype.LayoutLegend=function(t){this._legend=E.render(this,t,this._legendSource)},S.prototype.RenderLegend=function(t){this._legend&&(t.addChild(this._legend),this._legend=null)},S.prototype.RenderEmptyText=function(t){var i=this.getOptions(),s=i.emptyText;s||(s=i.translations.labelNoData),this.renderEmptyText(t,s,new e.Rectangle(0,0,this.Width,this.Height),this.getEventManager(),i._statusMessageStyle)},S.prototype.HasValidData=function(){return this._root&&this._root.getSize()>0},S.prototype.GetDisplayAnimation=function(t,i){var s=this.getOptions().animationOnDisplay;return e.BlackBoxAnimationHandler.isSupported(s)?e.BlackBoxAnimationHandler.getInAnimation(this.getCtx(),s,t,i,this.AnimationDuration):null},S.prototype.OnAnimationEnd=function(){this._deleteContainer&&(this.removeChild(this._deleteContainer),this._deleteContainer=null),this._oldContainer&&(this.removeChild(this._oldContainer),this._oldContainer=null),this.EventManager.addListeners(this),this._processInitialFocus(!0),this._processInitialHighlighting(),this.AnimationStopped||this.RenderComplete(),this.Animation=null,this.AnimationStopped=!1},S.prototype.GetDeleteContainer=function(){return new e.Container(this.getCtx())},S.prototype.CreateKeyboardHandler=function(t){return new y(t)},S.prototype.CreateEventManager=function(t,e,i,s){return new f(t,e,i,s)},S.prototype.GetInitialFocusedItem=function(t){if(t&&t.isArtificialRoot()){var e=t.getChildNodes();if(e&&e.length>0)return e[0]}return t},S.prototype.highlight=function(t){this.getOptions().highlightedCategories=e.JsonUtils.clone(t),e.CategoryRolloverHandler.highlight(t,o.getAllNodes(this._root),"any"==this.getOptions().highlightMatch)},S.prototype.select=function(t){var i=this.getOptions();if(i.selection=e.JsonUtils.clone(t),this._selectionHandler){var s=o.getAllNodes(this._root);this._selectionHandler.processInitialSelections(i.selection,s)}},S.prototype.__getMaxDepth=function(){return this._maxDepth},S.prototype.__getNodeCount=function(){return this._nodeCount},S.prototype.ApplyParsedProperties=function(t){var i=this.getOptions();this._oldRoot=this._root,this._oldAncestors=this._ancestors,this._root=t.root,this._ancestors=i._ancestors?i._ancestors:[],this._nodeCount=this._root?o.calcNodeCount(this._root):0,this._maxDepth=this._root?o.calcMaxDepth(this._root,0):0,this.AnimationDuration=e.CSSStyle.getTimeMilliseconds(i.animationDuration)/1e3,this._styles=t.styles?t.styles:{},"none"==i.selectionMode?this._nodeSelection=null:"single"==i.selectionMode?this._nodeSelection=e.SelectionHandler.TYPE_SINGLE:this._nodeSelection=e.SelectionHandler.TYPE_MULTIPLE,this._nodeSelection?(this._selectionHandler=new e.SelectionHandler(this.getCtx(),this._nodeSelection),this._initialSelection=i.selection):this._selectionHandler=null,this.EventManager.setSelectionHandler(this._selectionHandler),this.EventManager.setKeyboardHandler(this.CreateKeyboardHandler(this.EventManager)),this._legendSource=null;var s=i._templates;if(s)for(var n in this._templates={},s){var a=e.AfComponentFactory.parseJsonElement(s[n]);this._templates[n]=a}},S.prototype.ReselectNodes=function(){for(var t=this._selectionHandler?this._selectionHandler.getSelection():new Array,e=0;e<t.length;e++)t[e].setSelected(!0)},S.prototype._processInitialSelections=function(){if(this._selectionHandler&&this._initialSelection){var t=o.getAllNodes(this._root);this._selectionHandler.processInitialSelections(this._initialSelection,t),this._initialSelection=null}},S.prototype._processInitialHighlighting=function(){var t=this.getOptions().highlightedCategories;t&&t.length>0&&this.highlight(t)},S.prototype._processInitialFocus=function(t){var e=null,s=this.__getNavigableIdToFocus();s&&(e=i.getNodeById(this._root,s),this.EventManager.setFocus(e)),t&&this.__setNavigableIdToFocus(null),e||(e=this.GetInitialFocusedItem(this._root),this.EventManager.setFocus(e)),t&&this.setFocused(this.isFocused())},S.prototype.setFocused=function(t){this._hasFocus=t,this.EventManager.setFocused(t)},S.prototype.isFocused=function(){return this._hasFocus},S.prototype.__getAnimationDuration=function(){return this.AnimationDuration},S.prototype.__getTemplate=function(t){return this._templates?this._templates[t]:null},S.prototype.__getAfContext=function(){return this._afContext},S.prototype.__getNodeUnderPoint=function(t,e){return this._root.getNodeUnderPoint(t,e)},S.prototype.__isDragAvailable=function(t){return this._selectionHandler?t[0]:null},S.prototype.__getDragTransferable=function(t){t.isSelected()||(this._selectionHandler.processClick(t,!1),this.EventManager.fireSelectionEvent());for(var e=[],i=this._selectionHandler.getSelection(),s=0;s<i.length;s++)e.push(i[s].getId());return e},S.prototype.__getDragFeedback=function(){for(var t=[],e=this._selectionHandler.getSelection(),i=0;i<e.length;i++)t.push(e[i].getDisplayable());return t},S.prototype.__showDropSiteFeedback=function(t){if(this._dropSiteFeedback&&(this.removeChild(this._dropSiteFeedback),this._dropSiteFeedback=null),t&&(this._dropSiteFeedback=t.getDropSiteFeedback(),this._dropSiteFeedback)){var e=this.getOptions().styleDefaults;this._dropSiteFeedback.setSolidFill(e._dropSiteFillColor,e._dropSiteOpacity),this._dropSiteFeedback.setSolidStroke(e._dropSiteBorderColor),this.addChild(this._dropSiteFeedback)}return this._dropSiteFeedback},S.prototype.__processBreadcrumbsEvent=function(t){"breadcrumbsDrill"===t.type&&this.__drill(t.id,!1)},S.prototype.__drill=function(t,i){var s=this.getOptions()._widgetConstructor;i&&this._root&&t==this._root.getId()&&this._ancestors.length>0?(this.__setNavigableIdToFocus(t),this.dispatchEvent(e.EventFactory.newTreeDrillEvent(this._ancestors[0].id,o.findRootAndAncestors(this.getCtx(),this.getOptions()._nodes,this._ancestors[0].id,[]).root,s))):i||this.dispatchEvent(e.EventFactory.newTreeDrillEvent(t,o.findRootAndAncestors(this.getCtx(),this.getOptions()._nodes,t,[]).root,s)),this.getCtx().getTooltipManager().hideTooltip()},S.prototype.getLogicalObject=function(t){return this.EventManager.GetLogicalObject(t)},S.prototype.getRootNode=function(){return this._root},S.prototype.__getNavigableIdToFocus=function(){return this._navigableIdToFocus},S.prototype.__setNavigableIdToFocus=function(t){this._navigableIdToFocus=t},S.prototype.__getNodeSelection=function(){return this._nodeSelection},S.prototype.CreateNode=function(t){return null},S.prototype.getAutomation=function(){return new c(this)},S.prototype.getBreadcrumbs=function(){return this._breadcrumbs},S.prototype._processNodes=function(){var t=this.getOptions();if(null==t.nodes||0==t.displayLevels)return null;var i=[],s=e.ArrayUtils.createBooleanMap(t.hiddenCategories);for(r=0;r<t.nodes.length;r++){var o=t.nodes[r];o._index=r;var n=this._processNode(s,o,t.displayLevels);n&&i.push(n)}if(1==i.length)return i[0];for(var a=0,r=0;r<i.length;r++)a+=i[r].getSize();var l={value:a,bArtificialRoot:!0,id:this._id},h=this.CreateNode(l);return h.setChildNodes(i),h},S.prototype._processNode=function(t,e,i){if(o.isHiddenNode(t,e))return null;var s=this.CreateNode(e);if(s.isDisclosed()&&i>1){for(var n=[],a=e.nodes?e.nodes:[],r=0;r<a.length;r++){var l=a[r];l._index=r;var h=this._processNode(t,l,null!=i?i-1:i);h&&n.push(h)}s.setChildNodes(n)}return s},S.prototype.UpdateAriaNavigation=function(t){if(e.Agent.isTouchDevice()||e.Agent.isEnvironmentTest())for(var i=o.getAllVisibleNodes(t),s=0;s<i.length-1;s++){var n=this.getId()+(i[s+1].getId()?i[s+1].getId():i[s+1].getLabel());n=n.replace(/\s+/g,""),i[s+1].getDisplayable().setId(n,!0),i[s].getDisplayable().setAriaProperty("flowto",n)}},S.prototype.hasDataProvider=function(){return!!this.getOptions().data};var v=function(){};e.Obj.createSubclass(v,e.BaseComponentDefaults),v.SKIN_ALTA={skin:e.CSSStyle.SKIN_ALTA,animationDuration:500,animationOnDataChange:"none",animationOnDisplay:"none",drilling:"off",displayLevels:Number.MAX_VALUE,highlightMatch:"all",hoverBehavior:"none",hoverBehaviorDelay:200,nodeDefaults:{labelStyle:new e.CSSStyle(e.BaseComponentDefaults.FONT_FAMILY_ALTA_11),labelMinLength:1},selectionMode:"multiple",sorting:"off",_statusMessageStyle:new e.CSSStyle(e.BaseComponentDefaults.FONT_FAMILY_ALTA),styleDefaults:{_attributeTypeTextStyle:new e.CSSStyle(e.BaseComponentDefaults.FONT_FAMILY_ALTA_BOLD_12+"color:#4F4F4F"),_attributeValueTextStyle:new e.CSSStyle(e.BaseComponentDefaults.FONT_FAMILY_ALTA_12),_currentTextStyle:new e.CSSStyle(e.BaseComponentDefaults.FONT_FAMILY_ALTA_12),_drillTextStyle:new e.CSSStyle(e.BaseComponentDefaults.FONT_FAMILY_ALTA_12),_labelStyle:new e.CSSStyle(e.BaseComponentDefaults.FONT_FAMILY_ALTA)},touchResponse:"auto",_resources:{}},v.prototype.Init=function(t,i){var s={alta:e.JsonUtils.merge(t.alta,v.SKIN_ALTA)};v.superclass.Init.call(this,s,i)},v.prototype.getAnimationDuration=function(t){return t.animationDuration};var C=function(t){this.Init({alta:C.SKIN_ALTA},t)};e.Obj.createSubclass(C,v),C.SKIN_ALTA={nodeDefaults:{borderColor:"rgba(255,255,255,0.3)",borderWidth:1,hoverColor:"#FFFFFF",labelDisplay:"auto",labelHalign:"center",selectedInnerColor:"#FFFFFF",selectedOuterColor:"#000000"},rootNodeContent:{},rotation:"on",expanded:"all",startAngle:90};var b=function(t,e,i,s){f.call(this,t,e,i,s)};e.Obj.createSubclass(b,f),b.ROTATION_ID="_rotationShape",b.prototype.OnMouseDown=function(t){var e=this.GetLogicalObject(t.target);if(e&&e.getId&&e.getId()===b.ROTATION_ID&&!this._bRotating){this._bRotating=!0;var i=this._context.pageToStageCoords(t.pageX,t.pageY);this.GetView().__startRotation(i.x,i.y)}else b.superclass.OnMouseDown.call(this,t)},b.prototype.OnMouseMove=function(t){if(this._bRotating){var e=this._context.pageToStageCoords(t.pageX,t.pageY);this.GetView().__continueRotation(e.x,e.y)}else b.superclass.OnMouseMove.call(this,t)},b.prototype.OnMouseUp=function(t){this._bRotating?(this._bRotating=!1,this.GetView().__endRotation()):b.superclass.OnMouseUp.call(this,t)},b.prototype.ProcessKeyboardEvent=function(t){var i=!0,s=t.keyCode,o=this.getFocus(),n=this.GetView();if(o.isExpandCollapseEnabled()&&(e.KeyboardEvent.isPlus(t)&&!o.isDisclosed()||e.KeyboardEvent.isMinus(t)&&o.isDisclosed()||t.ctrlKey&&s===e.KeyboardEvent.ENTER))n.expandCollapseNode(o.getId()),e.EventManager.consumeEvent(t);else if(n&&n.__isRotationEnabled()&&(s===e.KeyboardEvent.LEFT_ARROW||s===e.KeyboardEvent.RIGHT_ARROW)&&!t.ctrlKey&&t.altKey&&t.shiftKey){var a;a=s===e.KeyboardEvent.LEFT_ARROW?Math.PI/180*-5:Math.PI/180*5,n.__setRotationAnchor(0),n.__rotate(a),n.__endRotation(),e.EventManager.consumeEvent(t)}else i=b.superclass.ProcessKeyboardEvent.call(this,t);return i},b.ROTATE_KEY="rotateKey",b.prototype.HandleImmediateTouchStartInternal=function(t){var e=this.GetLogicalObject(t.target);e&&e.getId&&e.getId()===b.ROTATION_ID&&this.TouchManager.processAssociatedTouchAttempt(t,b.ROTATE_KEY,this.RotateStartTouch,this)},b.prototype.HandleImmediateTouchMoveInternal=function(t){this.TouchManager.processAssociatedTouchMove(t,b.ROTATE_KEY)},b.prototype.HandleImmediateTouchEndInternal=function(t){this.TouchManager.processAssociatedTouchEnd(t,b.ROTATE_KEY)},b.prototype.RotateStartTouch=function(t,e){if(this.TouchManager.getTouchIdsForObj(b.ROTATE_KEY).length<=1){this.TouchManager.saveProcessedTouch(e.identifier,b.ROTATE_KEY,null,b.ROTATE_KEY,b.ROTATE_KEY,this.RotateMoveTouch,this.RotateEndTouch,this),this.TouchManager.setTooltipEnabled(e.identifier,!1);var i=this._context.pageToStageCoords(e.pageX,e.pageY);this.GetView().__startRotation(i.x,i.y),t.blockTouchHold()}},b.prototype.RotateMoveTouch=function(t,e){var i=this._context.pageToStageCoords(e.pageX,e.pageY);this.GetView().__continueRotation(i.x,i.y),t.preventDefault()},b.prototype.RotateEndTouch=function(t,e){this.GetView().__endRotation()};var A=new Object;e.Obj.createSubclass(A,e.Obj),A.layout=function(t,e,i,s,o){var n=t/A._calcLargestRadius(e);A._layout(n,e,i,s,o,0)},A._layout=function(t,i,s,o,n,a){var r=a+i.__getRadius()*t;i.setLayoutParams(a,r,s,o);var l=i.getChildNodes();if(null!=l&&i.isDisclosed()){var h,_=s;"on"===n&&(l=l.slice(0)).sort(function(t,e){return e.getSize()-t.getSize()}),e.Agent.isRightToLeft(i.getView().getCtx())&&(l=l.slice(0).reverse());var d=0;for(h=0;h<l.length;h++)d+=l[h].getSize()>0?l[h].getSize():0;for(h=0;h<l.length;h++){var u=l[h];if(u.getSize()>0){var c=u.getSize()/d*o;A._layout(t,u,_,c,n,r),_+=c}}}},A._calcLargestRadius=function(t){var e=0,i=t.getChildNodes();if(i&&i.length>0){for(var s=0;s<i.length;s++){var o=A._calcLargestRadius(i[s]);e=Math.max(e,o)}return e+t.__getRadius()}return t.__getRadius()};const T=function(t,e,i){this.Init(t,e,i)};e.Obj.createSubclass(T,S),T._ROTATION_SHAPE_RADIUS=15,T._ROTATION_SHAPE_RADIUS_TOUCH=60,T._ANIMATION_TYPE_FAN="fan",T._BACKGROUND_INLINE_DEFAULT="",T._BUFFER_SPACE=3,T._MIN_BUFFER_SPACE=2,T.newInstance=function(t,e,i){return new T(t,e,i)},T.prototype.Init=function(t,e,i){T.superclass.Init.call(this,t,e,i),this.Defaults=new C(t),this._angleExtent=2*Math.PI,this.setId("sunburst")},T.prototype.ApplyParsedProperties=function(t){T.superclass.ApplyParsedProperties.call(this,t);var i=this.getOptions();"ie"===e.Agent.browser||"edge"===e.Agent.browser?this._rotateCursor="url("+i._resources.rotateCursor+"), auto":this._rotateCursor="url("+i._resources.rotateCursor+") 8 8, auto",this._startAngle=(360-i.startAngle)*d.TWO_PI/360,this._startAngle>Math.PI&&(this._startAngle-=d.TWO_PI),"auto"===i.animationOnDisplay&&(i.animationOnDisplay="fan")},T.prototype.Layout=function(t){var e=Math.max(Math.ceil(T._BUFFER_SPACE*Math.min(t.w,t.h)/400),T._MIN_BUFFER_SPACE);t.x+=e,t.y+=e,t.w-=2*e,t.h-=2*e,this.LayoutBreadcrumbs(t),this.LayoutLegend(t),this._totalRadius=Math.floor(Math.min(t.w,t.h)/2),this._root&&A.layout(this._totalRadius,this._root,this._startAngle,this._angleExtent,this.getOptions().sorting)},T.prototype.Render=function(t,i){if(this.RenderBackground(t,T._BACKGROUND_INLINE_DEFAULT),this.RenderBreadcrumbs(t),this.RenderLegend(t),this._translatePt=new e.Point(i.x+i.w/2,i.y+i.h/2),this.__isRotationEnabled()&&this.HasValidData()){var o=e.Agent.isTouchDevice()?T._ROTATION_SHAPE_RADIUS_TOUCH:T._ROTATION_SHAPE_RADIUS,n=new e.Circle(this.getCtx(),i.x+i.w/2,i.y+i.h/2,this._totalRadius+o);n.setInvisibleFill(),n.setCursor(this._rotateCursor),t.addChild(n),this.getEventManager().associate(n,new s(null,b.ROTATION_ID))}var a=new e.Container(this.getCtx());if(a.setTranslate(this._translatePt.x,this._translatePt.y),t.addChild(a),this.HasValidData()){var r=new e.Container(this.getCtx());a.addChild(r),this._root.render(r),this.UpdateAriaNavigation(this._root),this._selectedLayer=new e.Container(this.getCtx()),a.addChild(this._selectedLayer),this._hoverLayer=new e.Container(this.getCtx()),a.addChild(this._hoverLayer)}else this.RenderEmptyText(t)},T.prototype.CreateEventManager=function(t,e,i,s){return new b(t,e,i,s)},T.prototype.GetDisplayAnimation=function(t,i){if(this.getOptions().animationOnDisplay===T._ANIMATION_TYPE_FAN&&this.HasValidData()){this._animateAngleExtent(0);var s=new e.CustomAnimation(this.getCtx(),this,this.AnimationDuration);return s.getAnimator().addProp(e.Animator.TYPE_NUMBER,this,this.__getAngleExtent,this._animateAngleExtent,2*Math.PI),s}return T.superclass.GetDisplayAnimation.call(this,t,i)},T.prototype.GetDeleteContainer=function(){var t=T.superclass.GetDeleteContainer.call(this);return t&&t.setTranslate(this._translatePt.x,this._translatePt.y),t},T.prototype.OnAnimationEnd=function(){if(!this.AnimationStopped){this._container.removeChildren();var t=new e.Rectangle(0,0,this.Width,this.Height);this.Layout(t),this.Render(this._container,t);for(var i=this._selectionHandler?this._selectionHandler.getSelection():[],s=0;s<i.length;s++)i[s].setSelected(!0)}this._angleExtent<2*Math.PI&&this._animateAngleExtent(2*Math.PI),T.superclass.OnAnimationEnd.call(this)},T.prototype.__moveToHoverLayer=function(t){this._hoverLayer.addChild(t)},T.prototype.__moveToSelectedLayer=function(t){this._selectedLayer.addChild(t),"safari"!==e.Agent.browser&&"firefox"!==e.Agent.browser&&(this._selectedLayer.removeAllDrawEffects(),this._selectedLayer.addDrawEffect(i.__NODE_SELECTED_SHADOW))},T.prototype.__getAngleExtent=function(){return this._angleExtent},T.prototype._animateAngleExtent=function(t){this._angleExtent=t;var i=new e.Rectangle(0,0,this.Width,this.Height);this.Layout(i),this._root&&this._root.updateShapes(!0)},T.prototype.__startRotation=function(t,e){this.__setRotationAnchor(this._calcAngle(t,e))},T.prototype.__setRotationAnchor=function(t){this._currentAngle=t,this._rotationMask=new e.Rect(this.getCtx(),0,0,this.Width,this.Height),this._rotationMask.setInvisibleFill(),this._rotationMask.setCursor(this._rotateCursor),this.addChild(this._rotationMask),this.getEventManager().associate(this._rotationMask,new s(null,b.ROTATION_ID))},T.prototype.__continueRotation=function(t,e){this.__rotate(this._calcAngle(t,e))},T.prototype.__rotate=function(t){var i=t-this._currentAngle;this._currentAngle=t,this._updateStartAngle(i);var s=360-Math.round(180*this._startAngle/Math.PI);this.dispatchEvent(e.EventFactory.newSunburstRotationEvent(s,!1))},T.prototype.__endRotation=function(){this._currentAngle=null,this.removeChild(this._rotationMask),this._rotationMask=null;var t=360-Math.round(180*this._startAngle/Math.PI);this.dispatchEvent(e.EventFactory.newSunburstRotationEvent(t,!1)),this.dispatchEvent(e.EventFactory.newSunburstRotationEvent(t,!0))},T.prototype.SetOptions=function(t){T.superclass.SetOptions.call(this,t),this.Options.expanded instanceof Array&&(this.Options._expandedNodes=e.ArrayUtils.createBooleanMap(this.Options.expanded))},T.prototype.expandCollapseNode=function(t){var s=this.getRootNode(),n=!i.getNodeById(s,t).isDisclosed(),a=this.getOptions().expanded;if("all"===a){for(var r=o.getAllNodes(this._root),l=0;l<r.length;l++)r[l]=r[l].getId();a=r}if(a instanceof Array)if(n)a.push(t);else{var h=a.indexOf(t);h>-1&&a.splice(h,1)}else a.has&&(a=n?a.add([t]):a.delete([t]));var _=o.findRootAndAncestors(this.getCtx(),this.getOptions()._nodes,t,[]).root;this.dispatchEvent(new e.EventFactory.newExpandCollapseEvent(n?"expand":"collapse",t,_,this.getOptions()._widgetConstructor,a)),this.__setNavigableIdToFocus(t)},T.prototype._calcAngle=function(t,e){return Math.atan2(e-this._translatePt.y,t-this._translatePt.x)},T.prototype._updateStartAngle=function(t){this._startAngle+=t,this._startAngle<-Math.PI?this._startAngle+=2*Math.PI:this._startAngle>Math.PI&&(this._startAngle-=2*Math.PI);var i=new e.Rectangle(0,0,this.Width,this.Height);this.Layout(i),this._root&&this._root.updateShapes(!0)},T.prototype.__getNodeUnderPoint=function(t,e){return this._root.getNodeUnderPoint(t-this._translatePt.x,e-this._translatePt.y)},T.prototype.__showDropSiteFeedback=function(t){var e=T.superclass.__showDropSiteFeedback.call(this,t);return e&&e.setTranslate(this._translatePt.x,this._translatePt.y),e},T.prototype.__isRotationEnabled=function(){return"off"!==this.getOptions().rotation},T.prototype.CreateNode=function(t){return new d(this,t)},T.prototype.getCenterPoint=function(){return this._translatePt};var O=function(t){this.Init({alta:O.SKIN_ALTA},t)};e.Obj.createSubclass(O,v),O.SKIN_ALTA={groupGaps:"outer",nodeDefaults:{header:{backgroundColor:"#FFFFFF",borderColor:"#d6dfe6",hoverBackgroundColor:"#ebeced",hoverOuterColor:"#ebeced",hoverInnerColor:"#d6d7d8",isolate:"auto",labelHalign:"start",_labelStyle:new e.CSSStyle(e.BaseComponentDefaults.FONT_FAMILY_ALTA_12+"color:#252525;"),selectedBackgroundColor:"#dae9f5",selectedInnerColor:"#FFFFFF",selectedOuterColor:"#000000",useNodeColor:"off",_hoverLabelStyle:new e.CSSStyle("color:#252525;"),_selectedLabelStyle:new e.CSSStyle("color:#252525;"),_drillableLabelStyle:new e.CSSStyle("color:#145c9e;"),_drillableHoverLabelStyle:new e.CSSStyle("color:#145c9e;"),_drillableSelectedLabelStyle:new e.CSSStyle("color:#145c9e;")},hoverColor:"#ebeced",groupLabelDisplay:"header",labelDisplay:"node",labelHalign:"center",labelValign:"center",selectedInnerColor:"#FFFFFF",selectedOuterColor:"#000000"},nodeSeparators:"gaps",nodeContent:{}};var I=function(t,e,i,s){f.call(this,t,e,i,s)};e.Obj.createSubclass(I,f),I.prototype.ProcessKeyboardEvent=function(t){var i=!0;if(t.keyCode===e.KeyboardEvent.ENTER&&t.ctrlKey){var s=this.getFocus();s.isIsolateEnabled()&&(s.__isIsolated()?s.__restoreNode():s.__isolateNode()),e.EventManager.consumeEvent(t)}else i=I.superclass.ProcessKeyboardEvent.call(this,t);return i};var R=function(t){this.Init(t)};e.Obj.createSubclass(R,y),R.prototype.isNavigationEvent=function(t){var i=R.superclass.isNavigationEvent.call(this,t);if(!i){var s=t.keyCode;s!==e.KeyboardEvent.OPEN_BRACKET&&s!==e.KeyboardEvent.CLOSE_BRACKET||(i=!0)}return i};var x=function(){this.Init()};e.Obj.createSubclass(x,e.Obj),x._GROUP_GAP=2,x.prototype.Init=function(){this._zIndex=0},x.prototype.layout=function(t,e,i,s,o,n,a){},x.prototype.setNodeBounds=function(t,i,s,o,n,a){if(t.setZIndex(this._zIndex),this._zIndex++,!a||!t.hasChildren()){var r=this.getGapSize(t.getView(),t.GetDepth()),l=Math.round(i+r),h=Math.round(s+r),_=Math.round(i+o-r)-l,d=Math.round(s+n-r)-h,u=t.setLayoutParams(l,h,_,d);if(u)return u}return new e.Rectangle(i,s,o,n)},x.prototype.getGapSize=function(t,e){var i=t.getOptions().groupGaps;return"outer"===i?1===e&&t.__getMaxDepth()>=2?x._GROUP_GAP:0:"all"===i&&e<t.__getMaxDepth()?x._GROUP_GAP:0};var D=function(t){this.Init(),this._isHoriz=t};e.Obj.createSubclass(D,x),D.prototype.layout=function(t,e,i,s,o,n,a){var r=!a;this._layout(this._isHoriz,t,e,i,s,o,n,r)},D.prototype._layout=function(t,i,s,o,n,a,r,l){var h=i.getOptions(),_=this.setNodeBounds(s,o,n,a,r,l),d=s.getChildNodes();if(null!=d){var u,c=_.x,p=_.y,g=_.w,f=_.h,y=0;for(u=0;u<d.length;u++)y+=d[u].getSize()>0?d[u].getSize():0;for("on"===h.sorting&&(d=d.slice(0)).sort(function(t,e){return e.getSize()-t.getSize()}),t&&e.Agent.isRightToLeft(i.getCtx())&&(d=d.slice(0).reverse()),u=0;u<d.length;u++){var E=d[u];if(E.getSize()>0){var S=E.getSize()/y;t?g=_.w*S:f=_.h*S,this._layout(!t,i,E,c,p,g,f,!1),t?c+=g:p+=f}}}};var m=function(){this.Init()};e.Obj.createSubclass(m,x),m.prototype.layout=function(t,e,i,s,o,n,a){var r=!a;this._layout(e,i,s,o,n,r)},m.prototype._layout=function(t,i,s,o,n,a){var r=this.setNodeBounds(t,i,s,o,n,a),l=t.getChildNodes();if(null!=l&&l.length>0){this._calcPixelSize(l,r.w*r.h),l=l.slice(0).sort(function(t,e){return t.getSize()-e.getSize()});var h=Math.min(r.w,r.h),_=new e.Rectangle(r.x,r.y,r.w,r.h);this._squarify(l,[],h,_,1/0)}},m.prototype._calcPixelSize=function(t,e){for(var i=0,s=0;s<t.length;s++)i+=t[s].getSize()>0?t[s].getSize():0;for(var o=0===e?0:e/i,n=0;n<t.length;n++){var a=t[n];a.__pxSize=a.getSize()*o}},m.prototype._squarify=function(t,e,i,s,o){if(null!=t&&0!==t.length)for(;t.length>0;){var n=t.pop();if(n.__pxSize<0)return void this._layoutRow(e,i,s);e.push(n);var a=this._getWorst(e,i);if(a>o)return t.push(n),e.pop(),s=this._layoutRow(e,i,s),void this._squarify(t,[],Math.min(s.w,s.h),s,1/0);if(0===t.length)return void this._layoutRow(e,i,s);o=a}else this._layoutRow(e,i,s)},m.prototype._getWorst=function(t,e){for(var i=0,s=1/0,o=-1/0,n=0;n<t.length;n++)i+=t[n].__pxSize,s=Math.min(s,t[n].__pxSize),o=Math.max(o,t[n].__pxSize);var a=i*i,r=e*e;return Math.max(r*o/a,a/(r*s))},m.prototype._layoutRow=function(t,i,s){var o,n=0;for(o=0;o<t.length;o++)n+=t[o].__pxSize;var a,r,l=s.x,h=s.y;if(i===s.w){for(r=0===i?0:n/i,o=0;o<t.length;o++)a=t[o].__pxSize/r,this._layout(t[o],l,h,a,r,!1),l+=a;return new e.Rectangle(s.x,s.y+r,s.w,s.h-r)}for(a=0===i?0:n/i,o=0;o<t.length;o++)r=t[o].__pxSize/a,this._layout(t[o],l,h,a,r,!1),h+=r;return new e.Rectangle(s.x+a,s.y,s.w-a,s.h)};const N=function(t,e,i){this.Init(t,e,i)};e.Obj.createSubclass(N,S),N._BUFFER_SPACE=7,N._MIN_BUFFER_SPACE=1,N._BACKGROUND_INLINE_DEFAULT="background-color:"+(N._BACKGROUND_FILL_COLOR="#EBEFF5")+";border-color:"+(N._BACKGROUND_BORDER_COLOR="#DBE0EA")+";border-width:2px",N.newInstance=function(t,e,i){return new N(t,e,i)},N.prototype.Init=function(t,e,i){N.superclass.Init.call(this,t,e,i),this.Defaults=new O(t),this._nodeContent={},this.setId("treemap1000"+Math.floor(1e9*Math.random()))},N.prototype.ApplyParsedProperties=function(t){N.superclass.ApplyParsedProperties.call(this,t);var e=this.getOptions();"sliceAndDiceHorizontal"===e.layout?this._layout=new D(!0):"sliceAndDiceVertical"===e.layout?this._layout=new D(!1):this._layout=new m,this._isolatedNodes=[],this._processInitialIsolate(e.isolatedNode),"auto"===e.animationOnDisplay&&(e.animationOnDisplay="alphaFade")},N.prototype.Layout=function(t){var e=N._MIN_BUFFER_SPACE;e=Math.max(Math.ceil(e*Math.min(t.w,t.h)/400),N._MIN_BUFFER_SPACE),t.x+=e,t.y+=e,t.w-=2*e,t.h-=2*e;var i=this._layout.getGapSize(this,1);t.x+=i,t.w-=2*i,this.LayoutBreadcrumbs(t),this.LayoutLegend(t),t.x-=i,t.w+=2*i;var s=this._isolatedNodes.length;if(s>0&&this._isolateRestoreLayout){var o=this._isolatedNodes[s-1];this._layout.layout(this,o,t.x,t.y,t.w,t.h,!0)}else{this._root&&this._layout.layout(this,this._root,t.x,t.y,t.w,t.h,!1);for(var n=0;n<s;n++){var a=this._isolatedNodes[n];this._layout.layout(this,a,t.x,t.y,t.w,t.h,!0)}}},N.prototype.Render=function(t,i){if(this.RenderBackground(t,N._BACKGROUND_INLINE_DEFAULT),this.RenderBreadcrumbs(t),this.RenderLegend(t),this.HasValidData()){this._groupTextLayer=new e.Container(this.getCtx()),t.addChild(this._groupTextLayer),this._isolatedNode?this._isolatedNode.render(t):this._root.hasChildren()?(this._root.renderChildren(t),this.UpdateAriaNavigation(this._root)):this._root.render(t),this._isolatedLayer=new e.Container(this.getCtx()),t.addChild(this._isolatedLayer),this._selectedLayer=new e.Container(this.getCtx()),t.addChild(this._selectedLayer),t.addChild(this._groupTextLayer),this._hoverEffect=new e.Rect(this.getCtx(),0,0,0,0),this._hoverEffect.setVisible(!1),this._hoverEffect.setMouseEnabled(!1),this._hoverEffect.setPixelHinting(!0),this._hoverEffect.setInvisibleFill(),t.addChild(this._hoverEffect);for(var s=0;s<this._isolatedNodes.length;s++){var o=this._isolatedNodes[s].getDisplayable();this._isolatedLayer.addChild(o)}}else this.RenderEmptyText(t)},N.prototype.OnAnimationEnd=function(){if(!this.AnimationStopped){this._container.removeChildren();var t=new e.Rectangle(0,0,this.Width,this.Height);this.Layout(t),this.Render(this._container),this.ReselectNodes()}N.superclass.OnAnimationEnd.call(this)},N.prototype.ReselectNodes=function(){for(var t=this._selectionHandler?this._selectionHandler.getSelection():[],e=0;e<t.length;e++)if(this._isolatedNodes.length>0){var i=this._isolatedNodes[this._isolatedNodes.length-1];(t[e]===i||t[e].isDescendantOf(i))&&t[e].setSelected(!0)}else t[e].setSelected(!0)},N.prototype.CreateKeyboardHandler=function(t){return new R(t)},N.prototype.CreateEventManager=function(t,e,i,s){return new I(t,e,i,s)},N.prototype.GetInitialFocusedItem=function(t){var e=this.__getLastIsolatedNode();return e?this.__getDefaultNavigable(o.getLeafNodes(e)):t?this.__getDefaultNavigable(o.getLeafNodes(t)):null},N.prototype.__showHoverEffect=function(t,e,i,s,o){this._hoverEffect.setX(t).setY(e).setWidth(i).setHeight(s),this._hoverEffect.setStroke(o),this._hoverEffect.setVisible(!0)},N.prototype.__hideHoverEffect=function(){this._hoverEffect.setVisible(!1)},N.prototype.__getGroupTextLayer=function(){return this._groupTextLayer},N.prototype.__moveToSelectedLayer=function(t){for(var e=0,i=this._selectedLayer.getNumChildren(),s=0;s<i;s++){var o=this._selectedLayer.getChildAt(s);t.zIndex>o.zIndex&&(e=s+1)}e<i?this._selectedLayer.addChildAt(t,e):this._selectedLayer.addChild(t)},N.prototype.__getNodeUnderPoint=function(t,e){return this._isolatedNodes.length>0?this._isolatedNodes[this._isolatedNodes.length-1].getNodeUnderPoint(t,e):this._root.getNodeUnderPoint(t,e)},N.prototype.__isolate=function(t){var i=this.getEventManager().getFocus();i&&i.hideKeyboardFocusEffect(),this._isolatedNodes.push(t),this.getOptions().isolatedNode=t.getId(),this.dispatchEvent(e.EventFactory.newTreemapIsolateEvent(t.getId())),this._isolateRestoreLayout=!0,this.Layout(new e.Rectangle(0,0,this.Width,this.Height)),this._isolateRestoreLayout=!1;var s=t.getDisplayable();this._isolatedLayer.addChild(s),this._renderIsolateRestore(t)},N.prototype.__restore=function(){this._restoreNode=this._isolatedNodes.pop(),this.getOptions().isolatedNode=this._isolatedNodes.length>0?this._isolatedNodes[this._isolatedNodes.length-1].getId():null;var t=this.getEventManager().getFocus();t&&t.hideKeyboardFocusEffect(),this.__setNavigableIdToFocus(this._restoreNode.getId()),this.dispatchEvent(e.EventFactory.newTreemapIsolateEvent()),this._isolateRestoreLayout=!0,this.Layout(new e.Rectangle(0,0,this.Width,this.Height)),this._isolateRestoreLayout=!1,this._renderIsolateRestore(this._restoreNode),this._restoreNode=null},N.prototype.__getLastIsolatedNode=function(){return this._isolatedNodes&&this._isolatedNodes.length>0?this._isolatedNodes[this._isolatedNodes.length-1]:null},N.prototype._renderIsolateRestore=function(t){if("none"!==this.getOptions().animationOnDataChange){for(var i=this._selectionHandler?this._selectionHandler.getSelection():[],s=0;s<i.length;s++)i[s].setSelected(!1);var o=t.getIsolateAnimation();this.Animation=new e.ParallelPlayable(this.getCtx(),o),this.Animation.setOnEnd(this.OnAnimationEnd,this),this.getEventManager().removeListeners(this),this.Animation.play()}else this.render(null,this.Width,this.Height,!0)},N.prototype._processInitialIsolate=function(t){if(t&&this._root){var i=this._root.getDescendantNodes();i.push(this._root);for(var s=0;s<i.length;s++)if(e.Obj.compareValues(this.getCtx(),i[s].getId(),t))return void this._isolatedNodes.push(i[s])}},N.prototype.__getDefaultNavigable=function(t){var e=this.getEventManager().getKeyboardHandler();return e?e.getDefaultNavigable(t):t&&t.length>0?t[0]:null},N.prototype.CreateNode=function(t){return new u(this,t)},N.prototype.getIsolatedNodes=function(){return this._isolatedNodes},N.prototype.getNodeContent=function(){return this._nodeContent},t.Sunburst=T,t.Treemap=N,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ojdvt-treeview.js.map