/**
 * @license
 * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","ojs/ojdvt-toolkit"],function(t,n){"use strict";const i=function(t,n,i){this.Init(t,n,i)};n.Obj.createSubclass(i,n.EventManager),i.EVENT_INFO_PANNED_KEY="panned",i.prototype.Init=function(t,n,e){i.superclass.Init.call(this,t,n,e),this._pzc=e,this._zoomAnimator=null,this._bPanning=!1,this._bPanned=!1,this._bZooming=!1,this._bDragging=!1,this._bMomentumPanning=!0},i._PAN_TOUCH_KEY="panTouch",i._ZOOM_TOUCH_KEY="zoomTouch",i._MOMENTUM_START_TIMER_INTERVAL=50,i.prototype.addListeners=function(t){i.superclass.addListeners.call(this,t),t.addEvtListener(n.MouseEvent.MOUSEWHEEL,this.OnMouseWheel,!1,this)},i.prototype.RemoveListeners=function(t){i.superclass.RemoveListeners.call(this,t),t.removeEvtListener(n.MouseEvent.MOUSEWHEEL,this.OnMouseWheel,!1,this)},i.prototype.OnMouseDown=function(t){if(this._bDragging=!1,this._bPanned=!1,t.button!=n.MouseEvent.RIGHT_CLICK_BUTTON){var i=this._callbackObj.GetRelativeMousePosition(t);this._mx=i.x,this._my=i.y,this._px=this._mx,this._py=this._my,this._bDown=!0,this._origPanX=this._callbackObj.getPanX(),this._origPanY=this._callbackObj.getPanY(),this._origZoom=this._callbackObj.getZoom(),this._bMomentumPanning&&(this._currTime=(new Date).getTime())}this._momentumTimer&&this._momentumTimer.isRunning()&&(this._momentumTimer.stop(),this._momentumTimer.reset())},i.prototype.OnMouseMove=function(t){var i=this._callbackObj.GetRelativeMousePosition(t);if(!(Math.abs(i.x-this._px)<=3&&Math.abs(i.y-this._py)<=3)){if(this._bDown){this._bDragging=!0;var e=(i=this._callbackObj.GetRelativeMousePosition(t)).x,o=i.y;if(t.ctrlKey){this._bZooming||(this._callback.call(this._callbackObj,n.EventFactory.newZoomEvent("dragZoomBegin")),this._bZooming=!0,this._callbackObj.SetElasticConstraints(!0));var s=this._py>=o?1:-1,a=this._origZoom*Math.pow(1+.01*s,Math.abs(this._py-o));this._callbackObj.isPanningEnabled()?this._callbackObj.zoomTo(a,this._px,this._py):this._callbackObj.zoomTo(a,null,null)}else this._handlePanMove(e,o);this._mx=e,this._my=o}this._callbackObj.setCursor(this._callbackObj.getCursor(this._bDown))}},i.prototype.OnMouseUp=function(t){this.PanZoomEnd(),i.superclass.OnMouseUp.call(this,t)},i.prototype.OnClick=function(t){(this._bDragging||this._bPanned)&&(this._bDragging=!1,this._bPanned=!1,n.EventManager.consumeEvent(t))},i.prototype.OnMouseOut=function(t){this._bDown&&(this._bPanning||this._bZooming)&&(t.relatedTarget&&null!=t.relatedTarget||this.OnMouseUp(t)),i.superclass.OnMouseOut.call(this,t)},i.prototype.OnMouseWheel=function(t){if(t.wheelDelta&&0!==t.wheelDelta&&this._callbackObj.isZoomingEnabled()){var i=this._callbackObj.getZoom();if(this._zoomAnimator){var e=this._zoomAnimator;this._zoomAnimator.stop(),i=this._callbackObj.getZoom(e),this._zoomAnimator=null,e=null}this._zoomAnimator=null;var o=t.wheelDelta,s=i*(1+this._callbackObj.getZoomIncrement()*o/Math.abs(o)),a=this._callbackObj.GetRelativeMousePosition(t);t.stopPropagation(),t.preventDefault(),this._callbackObj.isPanningEnabled()?this._callbackObj.zoomTo(s,a.x,a.y,this._zoomAnimator):this._callbackObj.zoomTo(s,null,null,this._zoomAnimator),this._zoomAnimator&&(n.Playable.appendOnEnd(this._zoomAnimator,this._clearZoomAnimator,this),this._zoomAnimator.play())}},i.prototype._clearZoomAnimator=function(){this._zoomAnimator=null},i.prototype._handleMomentumStartTimer=function(){},i.prototype._handleMomentumTimer=function(){var t=1-.04*this._momentumIterCount;t*=t;var n=this._momentumTimer.getInterval(),i=t*this._momentumXperMS*n,e=t*this._momentumYperMS*n;this._momentumDx+=i,this._momentumDy+=e;var o=this._origPanX+this._mx-this._px+this._momentumDx,s=this._origPanY+this._my-this._py+this._momentumDy;this._callbackObj.panTo(o,s);var a=!1;if(this._momentumIterCount>=24)a=!0;else{var h=this._callbackObj.getPanX(),r=this._callbackObj.getPanY(),m=this._pzc.getPanDirection();(Math.abs(h-o)>Math.abs(i)&&"y"!=m||Math.abs(r-s)>Math.abs(e)&&"x"!=m)&&(a=!0)}a?(this._momentumTimer.stop(),this._momentumTimer.reset(),this._callbackObj.SetElasticConstraints(!1)):this._momentumIterCount++},i.prototype.HandleImmediateTouchStartInternal=function(t){this._callbackObj.isZoomingEnabled()&&this.TouchManager.processAssociatedTouchAttempt(t,i._ZOOM_TOUCH_KEY,this.ZoomStartTouch,this),this._callbackObj.isPanningEnabled()&&this.TouchManager.processAssociatedTouchAttempt(t,i._PAN_TOUCH_KEY,this.PanStartTouch,this)},i.prototype.HandleImmediateTouchMoveInternal=function(t){this._callbackObj.isZoomingEnabled()&&this.TouchManager.processAssociatedTouchMove(t,i._ZOOM_TOUCH_KEY),this._callbackObj.isPanningEnabled()&&this.TouchManager.processAssociatedTouchMove(t,i._PAN_TOUCH_KEY),(this._callbackObj.isZoomingEnabled()||this._callbackObj.isPanningEnabled())&&t.preventDefault()},i.prototype.HandleImmediateTouchEndInternal=function(t){this._callbackObj.isZoomingEnabled()&&this.TouchManager.processAssociatedTouchEnd(t,i._ZOOM_TOUCH_KEY),this._callbackObj.isPanningEnabled()&&this.TouchManager.processAssociatedTouchEnd(t,i._PAN_TOUCH_KEY)},i.prototype.ZoomStartTouch=function(t,n){var e=this.TouchManager.getTouchIdsForObj(i._ZOOM_TOUCH_KEY);e.length<=1&&(this.TouchManager.saveProcessedTouch(n.identifier,i._ZOOM_TOUCH_KEY,null,i._ZOOM_TOUCH_KEY,i._ZOOM_TOUCH_KEY,this.ZoomMoveTouch,this.ZoomEndTouch,this),this._mx=n.pageX,this._my=n.pageY,this._px=this._mx,this._py=this._my,this._origPanX=this._callbackObj.getPanX(),this._origPanY=this._callbackObj.getPanY(),this._origZoom=this._callbackObj.getZoom(),this._origDist=null,e=this.TouchManager.getTouchIdsForObj(i._ZOOM_TOUCH_KEY),this._callbackObj.setCurrentTouchTargets(this.TouchManager.getStartTargetsByIds(e))),this._momentumTimer&&this._momentumTimer.isRunning()&&(this._momentumTimer.stop(),this._momentumTimer.reset())},i.prototype.ZoomMoveTouch=function(t,e){var o=this.TouchManager.getTouchIdsForObj(i._ZOOM_TOUCH_KEY);if(2==o.length){var s=this.TouchManager.getMultiTouchData(o);if(s){this._bZooming||(this._bZooming=!0,this.TouchManager.blockTouchHold(),this._callback.call(this._callbackObj,n.EventFactory.newZoomEvent("dragZoomBegin"))),this._callbackObj.SetElasticConstraints(!0),null==this._origDist&&(this._origDist=s.dist-s.dz);var a=this._origZoom*(s.dist/this._origDist),h=this._pzc.getCtx().pageToStageCoords(s.cx,s.cy);this.hideTooltip(),this._callbackObj.setCurrentTouchTargets(this.TouchManager.getStartTargetsByIds(o)),this._callbackObj.zoomTo(a,h.x,h.y),this._callbackObj.panBy(s.dcx,s.dcy)}}},i.prototype.ZoomEndTouch=function(t,e){this._bZooming&&(this._origDist=null,this.TouchManager.unblockTouchHold(),this._handleZoomEnd());var o=this.TouchManager.getTouchIdsForObj(i._ZOOM_TOUCH_KEY);this._callbackObj.setCurrentTouchTargets(this.TouchManager.getStartTargetsByIds(o)),0==o.length&&this._callback.call(this._callbackObj,n.EventFactory.newZoomEvent("zoomEnd",this._callbackObj.getZoom(),this._origZoom))},i.prototype.PanStartTouch=function(t,n){this._bZooming||this.TouchManager.getTouchIdsForObj(i._PAN_TOUCH_KEY).length<=1&&(this.TouchManager.saveProcessedTouch(n.identifier,i._PAN_TOUCH_KEY,null,i._PAN_TOUCH_KEY,i._PAN_TOUCH_KEY,this.PanMoveTouch,this.PanEndTouch,this),this._mx=n.pageX,this._my=n.pageY,this._px=this._mx,this._py=this._my,this._origPanX=this._callbackObj.getPanX(),this._origPanY=this._callbackObj.getPanY(),this._origZoom=this._callbackObj.getZoom(),this._bMomentumPanning&&(this._currTime=(new Date).getTime()));this._momentumTimer&&this._momentumTimer.isRunning()&&(this._momentumTimer.stop(),this._momentumTimer.reset())},i.prototype.PanMoveTouch=function(t,n){if(!this._bZooming&&1==this.TouchManager.getTouchIdsForObj(i._PAN_TOUCH_KEY).length){var e=n.pageX,o=n.pageY;this._handlePanMove(e,o),this._mx=e,this._my=o}},i.prototype.PanEndTouch=function(t,n){!this._bZooming&&this._bPanning&&(this._handlePanEnd(),this.SetEventInfo(t,"panned",!0))},i.prototype._handleZoomEnd=function(){this._callback.call(this._callbackObj,n.EventFactory.newZoomEvent("dragZoomEnd")),this._bZooming=!1,this._callbackObj.SetElasticConstraints(!1)},i.prototype._handlePanMove=function(t,e){this._bPanning||(this._callback.call(this._callbackObj,n.EventFactory.newPanEvent("dragPanBegin")),this._bPanning=!0,this._callbackObj.SetElasticConstraints(!0),this._bMomentumPanning&&(this._arLastNMouseMoves=[])),this._callbackObj.panTo(this._origPanX+t-this._px,this._origPanY+e-this._py),this._bMomentumPanning&&(this._lastTime=this._currTime,this._currTime=(new Date).getTime(),this._momentumStartTimer?(this._momentumStartTimer.isRunning()&&this._momentumStartTimer.stop(),this._momentumStartTimer.reset()):this._momentumStartTimer=new n.Timer(this._context,i._MOMENTUM_START_TIMER_INTERVAL,this._handleMomentumStartTimer,this,1),this._arLastNMouseMoves.push({dt:this._currTime-this._lastTime,dx:t-this._mx,dy:e-this._my}),this._arLastNMouseMoves.length>5&&this._arLastNMouseMoves.splice(0,1),this._momentumStartTimer.start())},i.prototype._handlePanEnd=function(){if(this._callback.call(this._callbackObj,n.EventFactory.newPanEvent("dragPanEnd")),this._bPanning=!1,this._bPanned=!0,this._momentumStartTimer&&this._momentumStartTimer.isRunning()){this._momentumStartTimer.stop(),this._momentumStartTimer.reset(),this._momentumTimer?this._momentumTimer.reset():this._momentumTimer=new n.Timer(this._context,i._MOMENTUM_START_TIMER_INTERVAL,this._handleMomentumTimer,this);for(var t=0,e=0,o=0,s=this._arLastNMouseMoves.length;this._arLastNMouseMoves.length>0;){var a=this._arLastNMouseMoves.pop();t+=a.dt,e+=a.dx,o+=a.dy}this._arLastNMouseMoves=null,this._momentumXperMS=e/t,this._momentumYperMS=o/t,this._momentumTimer.setInterval(Math.ceil(t/s)),this._momentumIterCount=1,this._momentumDx=0,this._momentumDy=0,this._pzc.isPanningEnabled()&&this._momentumTimer.start()}else this._callbackObj.SetElasticConstraints(!1)},i.prototype.PanZoomEnd=function(){this._bDown=!1,this._bDragging=!1,this._bPanning&&this._handlePanEnd(),this._bZooming&&this._handleZoomEnd(),this._callbackObj.setCursor(this._callbackObj.getCursor(this._bDown))},i.prototype.GetTouchResponse=function(){return this._pzc.isPanningEnabled()||this._pzc.isZoomingEnabled()?n.EventManager.TOUCH_RESPONSE_TOUCH_HOLD:n.EventManager.TOUCH_RESPONSE_AUTO},i.prototype.StoreInfoByEventType=function(t){return t!=i.EVENT_INFO_PANNED_KEY&&i.superclass.StoreInfoByEventType.call(this,t)};const e=function(t,n,i,e){this.Init(t,n,i,e)};n.Obj.createSubclass(e,n.Container),e.DEFAULT_PAN_INCREMENT=15,e.DEFAULT_ZOOM_INCREMENT=.05,e.DEFAULT_ANIMATION_DURATION=.5,e.DEFAULT_PADDING=20,e.prototype.Init=function(t,o,s,a){e.superclass.Init.call(this,t),this._view=a,this._ww=o,this._hh=s,this._px=0,this._py=0,this._mx=0,this._my=0,this._minPanX=null,this._maxPanX=null,this._minPanY=null,this._maxPanY=null,this._minZoom=.1,this._maxZoom=1,this._panIncrement=e.DEFAULT_PAN_INCREMENT,this._zoomIncrement=e.DEFAULT_ZOOM_INCREMENT,this._zoomToFitPadding=e.DEFAULT_PADDING,this._bPanningEnabled=!0,this._panDirection="auto",this._bZoomingEnabled=!0,this._bZoomToFitEnabled=!0,this._backgroundPane=new n.Rect(this.getCtx(),0,0,this._ww,this._hh),this.addChild(this._backgroundPane),this._backgroundPane.setInvisibleFill(),this._contentPane=new n.Container(this.getCtx()),this.addChild(this._contentPane),this._contentPane.setMatrix(new n.Matrix),this._animationDuration=e.DEFAULT_ANIMATION_DURATION,this._eventManager=new i(t,this.FireListener,this),this._eventManager.addListeners(this),this._clipIdSuffix=1,this.SetClipRect(o,s),this._bElasticConstraints=!1,this._elasticConstraintsAnim=null},e.prototype.setSize=function(t,n,i){this._ww=t,this._hh=n,i||(this._backgroundPane.setWidth(t),this._backgroundPane.setHeight(n),this.SetClipRect(t,n))},e.prototype.getSize=function(){return new n.Dimension(this._ww,this._hh)},e.prototype.SetClipRect=function(t,i){var e=new n.ClipPath("pzc");e.addRect(this.getTranslateX(),this.getTranslateY(),t,i),this.setClipPath(e)},e.prototype.getContentPane=function(){return this._contentPane},e.prototype.setContentPane=function(t){this._contentPane=t},e.prototype.getBackgroundPane=function(){return this._backgroundPane},e.prototype.getContentPaneMatrix=function(t){if(t){var n=t.getDestVal(this._contentPane,this._contentPane.getMatrix);if(n)return n}return this._contentPane.getMatrix()},e.prototype.getZoom=function(t){return this.getContentPaneMatrix(t).getA()},e.prototype.getPanX=function(t){return this.getContentPaneMatrix(t).getTx()},e.prototype.getPanY=function(t){return this.getContentPaneMatrix(t).getTy()},e.prototype.setZoomToFitPadding=function(t){this._zoomToFitPadding=t},e.prototype.getZoomToFitPadding=function(){return this._zoomToFitPadding},e.prototype.panBy=function(t,i,e,o){if(this.isPanningEnabled()){var s=this.getPanX(e),a=this.getPanY(e),h="y"==this.getPanDirection()?s:this.ConstrainPanX(s+t),r="x"==this.getPanDirection()?a:this.ConstrainPanY(a+i),m=h-s,_=r-a,c=null;e&&(c=e.getDestVal(this._contentPane,this._contentPane.getMatrix)),c||(c=this._contentPane.getMatrix()),c=c.translate(m,_);var l=this,u=function(){l.FirePanEvent("panning",h,r,s,a,e)},p=function(){l.FirePanEvent("panned",h,r,s,a,e)};e?(e.addProp(n.Animator.TYPE_MATRIX,this._contentPane,this._contentPane.getMatrix,this._contentPane.setMatrix,c),n.Playable.prependOnInit(e,u),n.Playable.appendOnEnd(e,p),o&&n.Playable.appendOnEnd(e,o)):(u(),this._contentPane.setMatrix(c),p(),o&&o())}},e.prototype.panTo=function(t,n,i){if(this.isPanningEnabled()){var e=t-this.getPanX(i),o=n-this.getPanY(i);this.panBy(e,o,i)}},e.prototype.zoomBy=function(t,i,e,o){if(this.isZoomingEnabled()){i||0===i||(i=this._ww/2),e||0===e||(e=this._hh/2);var s=this.getZoom(o),a=this.ConstrainZoom(s*t),h=a/s,r=null;o&&(r=o.getDestVal(this._contentPane,this._contentPane.getMatrix)),r||(r=this._contentPane.getMatrix()),r=r.scale(h,h,i,e);var m=this.ConstrainPanX(r.getTx())-r.getTx(),_=this.ConstrainPanY(r.getTy())-r.getTy();this.FireZoomEvent("adjustPanConstraints",a,s,o,i,e,m,_),m=this.ConstrainPanX(r.getTx())-r.getTx(),_=this.ConstrainPanY(r.getTy())-r.getTy(),r=r.translate(m,_);var c=this,l=function(){c.FireZoomEvent("zooming",a,s,o,i,e,m,_)},u=function(){c.FireZoomEvent("zoomed",c.getZoom(),s,o,i,e,m,_)};o?(o.addProp(n.Animator.TYPE_MATRIX,this._contentPane,this._contentPane.getMatrix,this._contentPane.setMatrix,r),n.Playable.prependOnInit(o,l),n.Playable.appendOnEnd(o,u)):(l(),this._contentPane.setMatrix(r),u())}},e.prototype.zoomTo=function(t,n,i,e){if(this.isZoomingEnabled()){var o=t/this.getZoom(e);this.zoomBy(o,n,i,e)}},e.prototype.center=function(t,n){var i=this.isPanningEnabled(),e=this.getPanDirection();this.setPanningEnabled(!0),this.setPanDirection("auto");var o=n;o||(o=this._contentPane.getDimensions());var s=(o.x+o.w/2)*this.getZoom(),a=(o.y+o.h/2)*this.getZoom(),h=this._ww/2-s,r=this._hh/2-a;this.panTo(h,r,t),this.setPanningEnabled(i),this.setPanDirection(e)},e.prototype.zoomToFit=function(t,i){if(this.isZoomToFitEnabled()){var e=this.isPanningEnabled(),o=this.getPanDirection(),s=this.isZoomingEnabled();this.setPanningEnabled(!0),this.setPanDirection("auto"),this.setZoomingEnabled(!0);try{var a=i||this._contentPane.getDimensions();if(!a)return;var h=(this._ww-2*this._zoomToFitPadding)/a.w,r=(this._hh-2*this._zoomToFitPadding)/a.h,m=Math.min(h,r);m=this.ConstrainZoom(m);var _=(a.x+a.w/2)*m,c=(a.y+a.h/2)*m,l=this._ww/2-_,u=this._hh/2-c,p=this.getZoom(t),g=this,b=function(){g.FireZoomEvent("zoomToFitBegin",null,null,t)},P=function(){g.FireZoomEvent("zoomToFitEnd",g.getZoom(),p,t)};t?n.Playable.prependOnInit(t,b):b(),this.zoomTo(m,0,0,t),this.panTo(l,u,t),t?n.Playable.appendOnEnd(t,P):P()}finally{this.setPanningEnabled(e),this.setPanDirection(o),this.setZoomingEnabled(s)}}},e.prototype.calcZoomToFitScale=function(t){t||(t=this._contentPane.getDimensions());var n=(this._ww-2*this._zoomToFitPadding)/t.w,i=(this._hh-2*this._zoomToFitPadding)/t.h,e=Math.min(n,i);return e=this.ConstrainZoom(e)},e.prototype.calcZoomToFitBounds=function(){var t=this._contentPane.getDimensions();return t.x-=this._zoomToFitPadding,t.y-=this._zoomToFitPadding,t.w+=2*this._zoomToFitPadding,t.h+=2*this._zoomToFitPadding,t},e.prototype.getViewport=function(){var t=this.localToStage(new n.Point(0,0)),i=this.localToStage(new n.Point(this._ww,this._hh)),e=this.getContentPane().stageToLocal(t),o=this.getContentPane().stageToLocal(i);return new n.Rectangle(e.x,e.y,o.x-e.x,o.y-e.y)},e.prototype.SetElasticConstraints=function(t){if(this._bElasticConstraints=t,t)this._elasticConstraintsAnim&&(this._elasticConstraintsAnim.isRunning()&&this._elasticConstraintsAnim.stop(),this._elasticConstraintsAnim=null);else{var i=this.getPanX(),e=this.getPanY(),o=this.getZoom();this._bElasticPan=i!=this.ConstrainPanX(i)||e!=this.ConstrainPanY(e),this._bElasticZoom=o!=this.ConstrainZoom(o),(this._bElasticPan||this._bElasticZoom)&&(this._elasticConstraintsAnim=new n.Animator(this.getCtx(),.4),this._elasticConstraintsAnim.setEasing(n.Easing.cubicOut),this._bElasticZoom&&this.zoomBy(1,.5*this._ww,.5*this._hh,this._elasticConstraintsAnim),this._bElasticPan&&this.panBy(0,0,this._elasticConstraintsAnim),n.Playable.appendOnEnd(this._elasticConstraintsAnim,this._elasticConstraintsAnimOnEnd,this),this._bElasticPan&&this.FirePanEvent("elasticAnimBegin",null,null,null,null,this._elasticConstraintsAnim),this._bElasticZoom&&this.FireZoomEvent("elasticAnimBegin",null,null,null,null,this._elasticConstraintsAnim),this._elasticConstraintsAnim.play())}},e.prototype.IsElasticConstraints=function(){return this._bElasticConstraints},e.prototype._elasticConstraintsAnimOnEnd=function(){this._elasticConstraintsAnim=null,this._bElasticPan&&this.FirePanEvent("elasticAnimEnd"),this._bElasticZoom&&this.FireZoomEvent("elasticAnimEnd")},e.prototype._panDampingFunc=function(t,n){var i=.01*n;return Math.sqrt(4*i*t)},e.prototype._zoomDampingFunc=function(t,n){var i=.002*n;return Math.sqrt(4*i*t)},e.prototype.ConstrainPanX=function(t){var n=t;if(null!=this._minPanX&&n<this._minPanX)if(this.IsElasticConstraints()){var i=this._minPanX-n;n=this._minPanX-this._panDampingFunc(i,this._ww)}else n=this._minPanX;if(null!=this._maxPanX&&n>this._maxPanX)if(this.IsElasticConstraints()){i=n-this._maxPanX;n=this._maxPanX+this._panDampingFunc(i,this._ww)}else n=this._maxPanX;return n},e.prototype.ConstrainPanY=function(t){var n=t;if(null!=this._minPanY&&n<this._minPanY)if(this.IsElasticConstraints()){var i=this._minPanY-n;n=this._minPanY-this._panDampingFunc(i,this._hh)}else n=this._minPanY;if(null!=this._maxPanY&&n>this._maxPanY)if(this.IsElasticConstraints()){i=n-this._maxPanY;n=this._maxPanY+this._panDampingFunc(i,this._hh)}else n=this._maxPanY;return n},e.prototype.ConstrainZoom=function(t){var n=Math.max(0,t);if(this._minZoom&&n<this._minZoom)if(this.IsElasticConstraints()){var i=this._minZoom-n;n=this._minZoom-this._zoomDampingFunc(i,this._maxZoom-this._minZoom)}else n=this._minZoom;if(this._maxZoom&&n>this._maxZoom)if(this.IsElasticConstraints()){i=n-this._maxZoom;n=this._maxZoom+this._zoomDampingFunc(i,this._maxZoom-this._minZoom)}else n=this._maxZoom;return n},e.RoundFloatForCompare=function(t){return Math.round(1e5*t)},e.prototype.GetRelativeMousePosition=function(t){return this.getCtx().pageToStageCoords(t.pageX,t.pageY)},e.prototype.FirePanEvent=function(t,i,e,o,s,a){var h=n.EventFactory.newPanEvent(t,i,e,o,s,a);this.FireListener(h)},e.prototype.FireZoomEvent=function(t,i,e,o,s,a,h,r){var m=n.EventFactory.newZoomEvent(t,i,e,o,new n.Point(s,a),h,r);return this.FireListener(m),m},e.prototype.zoomAndCenter=function(){this.FireZoomEvent("zoomAndCenter")},e.prototype.getNextZoomLevel=function(t){var n=t;return(n+=this.getZoomIncrement())>this.getMaxZoom()&&(n=this.getMaxZoom()),n},e.prototype.getPrevZoomLevel=function(t){var n=t;return(n-=this.getZoomIncrement())<this.getMinZoom()&&(n=this.getMinZoom()),n},e.prototype.setZoomIncrement=function(t){this._zoomIncrement=t},e.prototype.getZoomIncrement=function(){return this._zoomIncrement},e.prototype.setPanIncrement=function(t){this._panIncrement=t},e.prototype.getPanIncrement=function(){return this._panIncrement},e.prototype.setMinZoom=function(t){this._minZoom=t},e.prototype.getMinZoom=function(){return this._minZoom},e.prototype.setMaxZoom=function(t){t<0&&(t=1),this._maxZoom=t},e.prototype.getMaxZoom=function(){return this._maxZoom},e.prototype.setMinPanX=function(t){this._minPanX=t},e.prototype.getMinPanX=function(){return this._minPanX},e.prototype.setMaxPanX=function(t){this._maxPanX=t},e.prototype.getMaxPanX=function(){return this._maxPanX},e.prototype.setMinPanY=function(t){this._minPanY=t},e.prototype.getMinPanY=function(){return this._minPanY},e.prototype.setMaxPanY=function(t){this._maxPanY=t},e.prototype.getMaxPanY=function(){return this._maxPanY},e.prototype.setAnimationDuration=function(t){this._animationDuration=t},e.prototype.getAnimationDuration=function(){return this._animationDuration},e.prototype.setPanningEnabled=function(t){this._bPanningEnabled=t},e.prototype.isPanningEnabled=function(){return this._bPanningEnabled},e.prototype.setPanDirection=function(t){this._panDirection=t},e.prototype.getPanDirection=function(){return this._panDirection},e.prototype.setZoomingEnabled=function(t){this._bZoomingEnabled=t},e.prototype.isZoomingEnabled=function(){return this._bZoomingEnabled},e.prototype.setZoomToFitEnabled=function(t){this._bZoomToFitEnabled=t},e.prototype.isZoomToFitEnabled=function(){return this._bZoomToFitEnabled},e.prototype.setCurrentTouchTargets=function(t){this._currTargets=t},e.prototype.getCurrentTouchTargets=function(){return this._currTargets},e.prototype.resetTouchTargets=function(){n.Agent.isTouchDevice()&&(this._currTargets=null,this._eventManager.TouchManager.reset())},e.prototype.panZoomEnd=function(){this._eventManager.PanZoomEnd()},e.prototype.setInteractionEnabled=function(t){t?this._eventManager.addListeners(this):this._eventManager.removeListeners(this)},e.prototype.destroy=function(){this._elasticConstraintsAnim&&(this._elasticConstraintsAnim.stop(!0),this._elasticConstraintsAnim=null),this._eventManager&&(this._eventManager.removeListeners(this),this._eventManager.destroy(),this._eventManager=null),this.setClipPath(null),e.superclass.destroy.call(this)},e.prototype.getCursor=function(t){return this._bPanningEnabled?t?n.ToolkitUtils.getGrabbingCursor():n.ToolkitUtils.getGrabCursor():"inherit"};const o=function(t,n){this.Init(t,n)};n.Obj.createSubclass(o,n.KeyboardHandler),o.prototype.Init=function(t,n){o.superclass.Init.call(this,n),this._component=t},o.prototype.processKeyDown=function(t){var i=t.keyCode,e=this._component.getPanZoomCanvas();if(i==n.KeyboardEvent.PAGE_UP)t.ctrlKey||t.shiftKey?e.panBy(e.getPanIncrement(),0):e.panBy(0,e.getPanIncrement()),t.preventDefault();else if(i==n.KeyboardEvent.PAGE_DOWN)t.ctrlKey||t.shiftKey?e.panBy(-e.getPanIncrement(),0):e.panBy(0,-e.getPanIncrement()),t.preventDefault();else if(n.KeyboardEvent.isEquals(t)||n.KeyboardEvent.isPlus(t))e.zoomTo(e.getZoom()+e.getZoomIncrement());else if(n.KeyboardEvent.isMinus(t)||n.KeyboardEvent.isUnderscore(t))e.zoomTo(e.getZoom()-e.getZoomIncrement());else{if(i!=n.KeyboardEvent.ZERO&&i!=n.KeyboardEvent.NUMPAD_ZERO||t.ctrlKey||t.shiftKey)return o.superclass.processKeyDown.call(this,t);e.zoomToFit()}};const s=function(t,n,i){this.Init(t,n,i)};n.Obj.createSubclass(s,n.BaseComponent),s.prototype.Init=function(t,i,e){s.superclass.Init.call(this,t,i,e),this._bSupportsVectorEffects=!(("ie"===n.Agent.browser||"edge"===n.Agent.browser)&&n.Agent.version<=11),this._resourcesMap=null,this._panAnimator=null,this._panningInterrupted=!1},s.prototype.getPanZoomCanvas=function(){return this._panZoomCanvas},s.prototype.render=function(t,n,i){this.Width=n,this.Height=i,this._isResize=!t,this.IsResize()&&!this.getPanZoomCanvas()||(this.PreRender(),this.IsResize()||this.SetOptions(t),this.Render(t,n,i),this.UpdateAriaAttributes())},s.prototype.supportsVectorEffects=function(){return this._bSupportsVectorEffects},s.prototype.HandlePanEvent=function(t){},s.prototype.HandleZoomEvent=function(t){},s.prototype.IsResize=function(){return this._isResize},s.prototype.PreRender=function(){},s.prototype.Render=function(){this.IsResize()?this._panZoomCanvas.setSize(this.getWidth(),this.getHeight()):(this._panZoomCanvas&&(this.removeChild(this._panZoomCanvas),this._panZoomCanvas=null),this._panZoomCanvas=new e(this.getCtx(),this.getWidth(),this.getHeight(),this),this._panZoomCanvas.addEvtListener("dvtPan",this.HandlePanEvent,!1,this),this._panZoomCanvas.addEvtListener("dvtZoom",this.HandleZoomEvent,!1,this),this.addChild(this._panZoomCanvas));var t=new n.ClipPath("comp");t.addRect(this.getTranslateX(),this.getTranslateY(),this.getWidth(),this.getHeight()),this.setClipPath(t)},s.prototype.SetOptions=function(t){this.Options=this.Defaults?this.Defaults.calcOptions(t):t},s.prototype.destroy=function(){this._panZoomCanvas&&(this._panZoomCanvas.destroy(),this._panZoomCanvas=null),s.superclass.destroy.call(this)},s.prototype.ensureObjInViewport=function(t,i){if(this._panZoomCanvas.isPanningEnabled()){this._panAnimator&&(this._panningInterrupted=!0,this._panAnimator.stop());var e=this.Width,o=this.Height,s=i.getKeyboardBoundingBox(this.getCtx().getStage()),a=new n.Rectangle(0,0,e,o);if(!a.getUnion(s).equals(a)){var h=0,r=0,m=s.w,_=s.h,c=s.x,l=s.y;m<=e?c<0?h=c:c+m>e&&(h=c+m-e):h=c+.5*m-.5*e,_<=o?l<0?r=l:l+_>o&&(r=l+_-o):r=l+.5*_-.5*o;var u=new n.Animator(this.getCtx(),this.getAnimationDuration());this._panAnimator=u;var p=this;this.getPanZoomCanvas().panBy(-h,-r,u,function(){p._panAnimator=null,p.getEventManager().showFocusEffect(t,i),p._panningInterrupted=!1}),u.play()}}},s.prototype.isPanning=function(){return null!=this._panAnimator||this._panningInterrupted},t.PanZoomCanvas=e,t.PanZoomCanvasEventManager=i,t.PanZoomCanvasKeyboardHandler=o,t.PanZoomComponent=s,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ojdvt-panzoomcanvas.js.map