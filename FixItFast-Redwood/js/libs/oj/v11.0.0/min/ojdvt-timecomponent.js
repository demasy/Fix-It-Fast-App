/**
 * @license
 * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","ojs/ojdvt-toolkit","ojs/ojtimeaxis-toolkit"],function(t,e,i){"use strict";var s=new Object;e.Obj.createSubclass(s,e.Obj),s._DEFAULT_TIME_DIR_SCROLLBAR_STYLE="height: 3px; width: 3px; color: #9E9E9E; background-color: #F0F0F0",s._DEFAULT_CONTENT_DIR_SCROLLBAR_STYLE="height: 3px; width: 3px; color: #9E9E9E; background-color: #F0F0F0",s._SCROLLBAR_PADDING=4,s.getTimeDirScrollbarStyle=function(){return new e.CSSStyle(s._DEFAULT_TIME_DIR_SCROLLBAR_STYLE)},s.getContentDirScrollbarStyle=function(){return new e.CSSStyle(s._DEFAULT_CONTENT_DIR_SCROLLBAR_STYLE)},s.getScrollbarPadding=function(){return s._SCROLLBAR_PADDING};const n=function(t,e,i){this.Init(t,e,i)};e.Obj.createSubclass(n,e.BaseComponent),n.ZOOM_BY_VALUE=1.5,n.SCROLL_LINE_HEIGHT=15,n.WHEEL_UNITS_PER_LINE=40,n.prototype.Init=function(t,e,i){n.superclass.Init.call(this,t,e,i),this._virtualize=!1},n.prototype.render=function(t,e,i){if(t){this._resources=t._resources,null==this._resources&&(this._resources=[]),this.SetOptions(t);var s=this.Options.dragMode;this.SetPanningEnabled("pan"===s||null==s,!0),this.SetMarqueeEnabled("select"===s&&"multiple"===this.Options.selectionMode,!0)}if(this.Width=e,this.Height=i,this.Options){var n=this.Parse(this.Options);this._applyParsedProperties(n)}},n.prototype.SetOptions=function(t){this.Options=this.Defaults.calcOptions(t);var i=new Date(t.start).getTime(),s=new Date(t.end).getTime(),n=new Date(t.viewportStart).getTime(),o=new Date(t.viewportEnd).getTime();n>=i&&n<s||(this._viewStartTime=null,this.Options.viewportStart=""),o>i&&o<=s||(this._viewEndTime=null,this.Options.viewportEnd=""),e.Agent.isEnvironmentTest()&&(this.Options.animationOnDisplay="none",this.Options.animationOnDataChange="none")},n.prototype.clearComponent=function(){this._canvas&&this._canvas.removeChildren()},n.prototype._applyParsedProperties=function(t){this._start=t.start,this._end=t.end,this._inlineStyle=t.inlineStyle,this._timeDirScrollbar=t.timeDirScrollbar,this._contentDirScrollbar=t.contentDirScrollbar,this.applyStyleValues()},n.sanitizeData=function(t,i){var s,n;if("series"===i||"row"===i){var o="series"===i?"items":"tasks";if(t[o].length>0)return t[o][0]._noTemplate?((s=e.JsonUtils.clone(t,null,{itemProp:!0}))[o]=s[o].map(function(t){return t._itemData}),s):t[o][0]._itemData?((s=e.JsonUtils.clone(t,null,{itemProp:!0}))[o]=s[o].map(function(t){return delete(n=e.JsonUtils.clone(t))._itemData,n}),s):t}else{if(t._noTemplate)return t._itemData;if(t._itemData)return delete(n=e.JsonUtils.clone(t))._itemData,n}return t},n.prototype.applyStyleValues=function(){this._style&&this._style.parseInlineStyle(this._inlineStyle)},n.prototype.isDndEnabled=function(){return!1},n.prototype.isAnimationEnabled=function(){return!1},n.prototype.getAdjustedStartTime=function(){return this._start},n.prototype.getAdjustedEndTime=function(){return this._end},n.prototype.getContentLength=function(){return this._contentLength},n.prototype.setContentLength=function(t){this._canvasLength<t?this._contentLength=t:this._contentLength=this._canvasLength,this._virtualize||(this._fetchStartPos=0,this._fetchEndPos=this._contentLength)},n.prototype.getCanvasSize=function(){return this._canvasSize},n.prototype.getCanvasLength=function(){return this._canvasLength},n.prototype.isRTL=function(){return e.Agent.isRightToLeft(this.getCtx())},n.prototype.isVertical=function(){return this._isVertical},n.prototype.getTimeAxis=function(){return null},n.prototype.prepareViewportLength=function(){if(this.setRelativeStartPos(0),this._viewStartTime&&this._viewEndTime){if((o=this._viewEndTime-this._viewStartTime)>0){var t=this._canvasLength/o;this.setContentLength(t*(this._end-this._start)),this.setRelativeStartPos(t*(this._start-this._viewStartTime))}}else{var e=this.getTimeAxis(),i=e.getZoomLevelLengths()[e._zoomLevelOrder],s=this._start,n=this._end;if(null==this._viewStartTime)if(null!=this._viewEndTime){this._viewStartTime=this._viewEndTime-this._canvasLength/i*(n-s),this._viewStartTime<this._start&&(this._viewStartTime=this._start);var o=this._viewEndTime-this._viewStartTime;t=this._canvasLength/o;this.setContentLength(t*(this._end-this._start)),this.setRelativeStartPos(t*(this._start-this._viewStartTime))}else this._viewStartTime=this._start,this.setRelativeStartPos(0),this._viewEndTime=this._canvasLength/i*(n-s)+this._viewStartTime,this._viewEndTime>this._end&&(this._viewEndTime=this._end);else this._viewEndTime=this._canvasLength/i*(n-s)+this._viewStartTime,this._viewEndTime>this._end&&(this._viewEndTime=this._end),o=this._viewEndTime-this._viewStartTime,t=this._canvasLength/o,this.setContentLength(t*(this._end-this._start)),this.setRelativeStartPos(t*(this._start-this._viewStartTime))}},n.prototype.renderTimeZoomCanvas=function(t){this._timeZoomCanvas?this._timeZoomCanvas.setClipPath(null):this._timeZoomCanvas=new e.Container(this.getCtx(),"iCanvas");var i=new e.ClipPath;this.isVertical()?(i.addRect(this._startX,this._startY,this._canvasSize,this._canvasLength),this._timeZoomCanvas.setTranslateX(this._startX),this._timeZoomCanvas.setTranslateY(this._startY+this.getAbsoluteStartPos())):(i.addRect(this._startX,this._startY,this._canvasLength,this._canvasSize),this._timeZoomCanvas.setTranslateX(this._startX+this.getAbsoluteStartPos()),this._timeZoomCanvas.setTranslateY(this._startY)),t.setClipPath(i),this._timeZoomCanvas.getParent()!=t&&t.addChild(this._timeZoomCanvas)},n.prototype.getTimeZoomCanvas=function(){return this._timeZoomCanvas},n.prototype.renderZoomControls=function(t){var s=this.getCtx(),n=this.getTimeAxis(),o=this.Options.translations,a=t.zoomInProps,r=a.imageSize,h=a.class,l=a.posX,c=a.posY;if(null==this.zoomin){var _=e.ToolkitUtils.getIconStyle(s,h);this.zoomin=new e.TransientButton(s,_,r,this.EventManager,this.EventManager.HandleZoomInClick),this.EventManager.associate(this.zoomin,this.zoomin)}var p=t.zoomOutProps;r=p.imageSize,h=p.class;var u=p.posX,g=p.posY;if(null==this.zoomout){_=e.ToolkitUtils.getIconStyle(s,h);this.zoomout=new e.TransientButton(s,_,r,this.EventManager,this.EventManager.HandleZoomOutClick),this.EventManager.associate(this.zoomout,this.zoomout)}this.zoomin.setTooltip(o.tooltipZoomIn),this.zoomout.setTooltip(o.tooltipZoomOut),this.zoomin.hide(),this.zoomout.hide(),i.TimeAxisUtils.supportsTouch()&&(e.ToolkitUtils.setAttrNullNS(this.zoomin.getElem(),"role","button"),e.ToolkitUtils.setAttrNullNS(this.zoomin.getElem(),"aria-label",o.tooltipZoomIn),e.ToolkitUtils.setAttrNullNS(this.zoomout.getElem(),"role","button"),e.ToolkitUtils.setAttrNullNS(this.zoomout.getElem(),"aria-label",o.tooltipZoomOut)),this.zoomin.setTranslateX(l),this.zoomout.setTranslateX(u),this.zoomin.setTranslateY(c),this.zoomout.setTranslateY(g),this.zoomin.getParent()!=this._canvas&&this._canvas.addChild(this.zoomin),this.zoomout.getParent()!=this._canvas&&this._canvas.addChild(this.zoomout);var m=this.getContentLength();m>=n.getMaxContentLength()&&this.disableZoomButton(!0),this._canvasLength>=m&&this.disableZoomButton(!1)},n.prototype.HandleMouseWheel=function(t){e.EventManager.consumeEvent(t);var i=t.wheelDelta,s=t.getNativeEvent();if(this.hasValidOptions()&&(null!=s.wheelDeltaX?t.wheelDeltaX=s.wheelDeltaX/n.WHEEL_UNITS_PER_LINE:null!=s.deltaX&&(s.deltaMode==s.DOM_DELTA_LINE?t.wheelDeltaX=-s.deltaX:s.deltaMode==s.DOM_DELTA_PIXEL&&(t.wheelDeltaX=-s.deltaX/n.SCROLL_LINE_HEIGHT)),i)){var o=this.getCtx().getStageAbsolutePosition();if(this._isVertical)var a=t.pageY-o.y-this.getStartYOffset();else a=t.pageX-o.x-this.getStartXOffset();var r=(this._end-this._start)/this.getContentLength();if(this.isRTL()&&!this._isVertical)var h=this._viewEndTime-r*a;else h=r*a+this._viewStartTime;t.zoomTime=h,t.zoomCompLoc=a,t.zoomWheelDelta=.02*i+1}},n.prototype.handleZoomWheel=function(t,e,i,s){var n=(this._viewEndTime-this._viewStartTime)/(this._end-this._start)*this.getContentLength();this.setContentLength(t);var o=n/this.getContentLength()*(this._end-this._start);if(e){var a=(this._end-this._start)/this.getContentLength();this.isRTL()&&!this._isVertical?(this._viewEndTime=e+i*a,this._viewEndTime>this._end&&(this._viewEndTime=this._end),this._viewStartTime=this._viewEndTime-o,this._viewStartTime<this._start&&(this._viewStartTime=this._start,this._viewEndTime=this._viewStartTime+o,this._viewEndTime>this._end&&(this._viewEndTime=this._end))):(this._viewStartTime=e-i*a,this._viewStartTime<this._start&&(this._viewStartTime=this._start),this._viewEndTime=this._viewStartTime+o,this._viewEndTime>this._end&&(this._viewEndTime=this._end,this._viewStartTime=this._viewEndTime-o,this._viewStartTime<this._start&&(this._viewStartTime=this._start))),this.setRelativeStartPos(1/a*(this._start-this._viewStartTime))}else this._viewStartTime=this._start,this._viewEndTime=this._viewStartTime+o,this._viewEndTime>this._end&&(this._viewEndTime=this._end),this.setRelativeStartPos(0);this.applyTimeZoomCanvasPosition()},n.prototype.zoomBy=function(t){var e=(1/t-1)/2+1;if(this._isVertical)var i=this.Height/2;else i=this.Width/2;var s=(this._end-this._start)/this.getContentLength()*i+this._viewStartTime;this.handleZoomWheel(this.getContentLength()*e,s,i,!0)},n.prototype.beginPinchZoom=function(t,e,i,s){this._isVertical?this._initialPinchZoomLoc=Math.sqrt((e-s)*(e-s))+(e<s?e:s):this._initialPinchZoomLoc=Math.sqrt((t-i)*(t-i))+(t<i?t:i);var n=(this._end-this._start)/this.getContentLength();this.isRTL()&&!this._isVertical?this._initialPinchZoomTime=this._viewEndTime-n*this._initialPinchZoomLoc:this._initialPinchZoomTime=n*this._initialPinchZoomLoc+this._viewStartTime,this._initialPinchZoomDist=Math.sqrt((t-i)*(t-i)+(e-s)*(e-s)),this._initialPinchZoomLength=this.getContentLength()},n.prototype.contPinchZoom=function(t,e,i,s){var n=Math.sqrt((t-i)*(t-i)+(e-s)*(e-s));n!=this._initialPinchZoomDist&&(this._triggerViewportChange=!0);var o=n/this._initialPinchZoomDist*this._initialPinchZoomLength;this.handleZoomWheel(o,this._initialPinchZoomTime,this._initialPinchZoomLoc,!1)},n.prototype.endPinchZoom=function(){this._initialPinchZoomDist=null,this._initialPinchZoomLoc=null,this._initialPinchZoomLength=null,this._initialPinchZoomTime=null,this._triggerViewportChange&&(this._triggerViewportChange=!1,this.dispatchEvent(this.createViewportChangeEvent()))},n.prototype.SetPanningEnabled=function(t,e){var i=this.getOptions().dragMode;this._panningEnabled=!(!e&&"pan"!==i&&null!=i)&&t},n.prototype.IsPanningEnabled=function(){return this._panningEnabled},n.prototype.SetMarqueeEnabled=function(t,e){e||this.isMarqueeSelectEnabled()?this._marqueeEnabled=t:this._marqueeEnabled=!1},n.prototype.IsMarqueeEnabled=function(){return this._marqueeEnabled},n.prototype.isMarqueeSelectEnabled=function(){return"select"===this.getOptions().dragMode&&"multiple"===this.getOptions().selectionMode},n.prototype.panZoomCanvasBy=function(t){if(this._isVertical){var e=this._timeZoomCanvas.getTranslateY()-t,i=-(this.getContentLength()-this._canvasLength-this._startY),s=this._startY;e<i?e=i:e>s&&(e=s),this._timeZoomCanvas.setTranslateY(e);var n=e-this._startY;this.setAbsoluteStartPos(n);var o=this.getContentLength()/(this._end-this._start),a=this._viewEndTime-this._viewStartTime;this._viewStartTime=this._start-n/o,this._viewEndTime=this._viewStartTime+a,this._viewEndTime>this._end&&(this._viewEndTime=this._end)}else{var r=this._timeZoomCanvas.getTranslateX()-t,h=-(this.getContentLength()-this._canvasLength-this._startX),l=this._startX;r<h?r=h:r>l&&(r=l),this._timeZoomCanvas.setTranslateX(r),this.setAbsoluteStartPos(r-this._startX),n=this.getRelativeStartPos(),o=this.getContentLength()/(this._end-this._start),a=this._viewEndTime-this._viewStartTime,this._viewStartTime=this._start-n/o,this._viewEndTime=this._viewStartTime+a,this._viewEndTime>this._end&&(this._viewEndTime=this._end)}},n.prototype.handleZoom=function(t){t?this.zoomBy(1/n.ZOOM_BY_VALUE):this.zoomBy(n.ZOOM_BY_VALUE)},n.prototype.enableZoomButton=function(t){t?this.zoomin.setEnabled(!0):this.zoomout.setEnabled(!0)},n.prototype.disableZoomButton=function(t){t?(this.zoomin.setEnabled(!1),this.zoomin.setCursor(null)):(this.zoomout.setEnabled(!1),this.zoomout.setCursor(null))},n.prototype.applyTimeZoomCanvasPosition=function(){this._isVertical?this._timeZoomCanvas.setTranslateY(this._startY+this.getAbsoluteStartPos()):this._timeZoomCanvas.setTranslateX(this._startX+this.getAbsoluteStartPos())},n.prototype.getAbsoluteStartPos=function(){return this._startPos},n.prototype.setAbsoluteStartPos=function(t){this._startPos=t},n.prototype.getRelativeStartPos=function(){return this.isRTL()&&!this._isVertical?this._canvasLength-this.getContentLength()-this._startPos:this._startPos},n.prototype.setRelativeStartPos=function(t){this.isRTL()&&!this._isVertical?this._startPos=this._canvasLength-this.getContentLength()-t:this._startPos=t},n.prototype.getStartXOffset=function(){return this._startX},n.prototype.setStartXOffset=function(t){this._startX=t},n.prototype.getStartYOffset=function(){return this._startY},n.prototype.setStartYOffset=function(t){this._startY=t},n.prototype.getGraphicalAreaBounds=function(){return this.isVertical()?new e.Rectangle(this._startX,this._startY,this._canvasSize,this._canvasLength):new e.Rectangle(this._startX,this._startY,this._canvasLength,this._canvasSize)},n.prototype.isTimeDirScrollbarOn=function(){return!0},n.prototype.isContentDirScrollbarOn=function(){return!0},n.prototype.getTimeDirScrollbar=function(){return this.timeDirScrollbar},n.prototype.getContentDirScrollbar=function(t){return t?this.contentDirScrollbar[t]:this.contentDirScrollbar},n.prototype.setTimeDirScrollbar=function(t){this.timeDirScrollbar=t},n.prototype.setContentDirScrollbar=function(t,e){null!=e?(null==this.contentDirScrollbar&&(this.contentDirScrollbar=[]),this.contentDirScrollbar[e]=t):this.contentDirScrollbar=t},n.prototype.getScrollbarPadding=function(){return s._SCROLLBAR_PADDING},n.prototype.getTimeDirScrollbarStyle=function(){return s.getTimeDirScrollbarStyle()},n.prototype.getContentDirScrollbarStyle=function(){return s.getContentDirScrollbarStyle()},n.prototype.HandleEvent=function(t,e){"dvtSimpleScrollbar"==t.type&&(t=this.processScrollbarEvent(t,e)),t&&this.dispatchEvent(t)},n.prototype.processScrollbarEvent=function(t,e){if(e==this.timeDirScrollbar){var i=t.newMin,s=t.newMax;this._viewStartTime=i,this._viewEndTime=s;var n=this.getContentLength()/(this._end-this._start);this.setRelativeStartPos(n*(this._start-this._viewStartTime)),this.applyTimeZoomCanvasPosition();var o=this.createViewportChangeEvent();this.dispatchEvent(o)}},n.prototype.processEvent=function(t){t&&this.dispatchEvent(t)},n.prototype.createViewportChangeEvent=function(){return null},n.prototype.getViewportStartTime=function(){return this._viewStartTime},n.prototype.setViewportStartTime=function(t){this._viewStartTime=t},n.prototype.getViewportEndTime=function(){return this._viewEndTime},n.prototype.setViewportEndTime=function(t){this._viewEndTime=t},n.prototype.HandleKeyDown=function(t){},n.prototype.HandleMouseDown=function(t){},n.prototype.HandleFocus=function(t){null!=this.zoomin&&this.zoomin._onFocus(t),null!=this.zoomout&&this.zoomout._onFocus(t)},n.prototype.HandleBlur=function(t){null!=this.zoomin&&this.zoomin._onBlur(t),null!=this.zoomout&&this.zoomout._onBlur(t)},n.prototype.beginDragPan=function(t,e){this._currentX=t,this._currentY=e},n.prototype.endDragPan=function(){this.endPan()},n.prototype.setPanCursorDown=function(){this.setCursor(e.ToolkitUtils.getGrabbingCursor())},n.prototype.setPanCursorUp=function(){this.setCursor(e.ToolkitUtils.getGrabCursor())},n.prototype.registerAndConstructGlassPane=function(){if(this._glassPaneUsageStack||(this._glassPaneUsageStack=[]),!this._glassPane){var t=this.getGraphicalAreaBounds();this._glassPane=new e.Rect(this.getCtx(),t.x,t.y,t.w,t.h),this._glassPane.setInvisibleFill()}this._glassPaneUsageStack.push(1)},n.prototype.installGlassPane=function(){return!this._glassPaneDrawn&&(this.addChild(this._glassPane),this._glassPaneDrawn=!0,!0)},n.prototype.unregisterAndDestroyGlassPane=function(){this._glassPaneUsageStack.pop(),this._glassPaneDrawn&&0===this._glassPaneUsageStack.length&&(this.removeChild(this._glassPane),this._glassPaneDrawn=!1)},n.prototype.HandleTouchEnd=function(t){"none"!=this._selectionMode&&this.handleShapeClick(t,"multiple"==this._selectionMode)},n.prototype.handleShapeClick=function(t){},n.prototype.HandleMouseClick=function(t){this.handleShapeClick(t,t.ctrlKey&&"multiple"==this._selectionMode)},n.prototype.endPan=function(){this._triggerViewportChange&&(this._triggerViewportChange=!1,this.dispatchEvent(this.createViewportChangeEvent()))},n.prototype.contDragPan=function(t,e){if(this._currentX&&this._currentY){var i=this._currentX-t,s=this._currentY-e;return(0!=i||0!=s)&&(this._triggerViewportChange=!0,this._currentX=t,this._currentY=e,this.panBy(i,s),!0)}return!1},n.prototype.panBy=function(t,e){this.panZoomCanvasBy(t)};const o=function(t){this.Init(t.getCtx(),t.processEvent,t,t),this._comp=t,this._isDragPanning=!1,this._isPinchZoom=!1};e.Obj.createSubclass(o,e.EventManager),o.GECKO_MOUSEWHEEL="wheel",o.prototype.addListeners=function(t){o.superclass.addListeners.call(this,t),e.SvgDocumentUtils.addDragListeners(this._comp,this._onDragStart,this._onDragMove,this._onDragEnd,this),e.Agent.isTouchDevice()||("firefox"===e.Agent.browser?t.addEvtListener(o.GECKO_MOUSEWHEEL,this.OnMouseWheel,!1,this):t.addEvtListener(e.MouseEvent.MOUSEWHEEL,this.OnMouseWheel,!1,this))},o.prototype.RemoveListeners=function(t){o.superclass.RemoveListeners.call(this,t),e.Agent.isTouchDevice()||("firefox"===e.Agent.browser?t.removeEvtListener(o.GECKO_MOUSEWHEEL,this.OnMouseWheel,!1,this):t.removeEvtListener(e.MouseEvent.MOUSEWHEEL,this.OnMouseWheel,!1,this))},o.prototype.OnFocus=function(t){o.superclass.OnFocus.call(this,t),this._comp.HandleFocus(t)},o.prototype.OnBlur=function(t){o.superclass.OnBlur.call(this,t),this._comp.HandleBlur(t)},o.prototype.OnKeyDown=function(t){o.superclass.OnKeyDown.call(this,t),this._comp.HandleKeyDown(t)},o.prototype.OnClick=function(t){o.superclass.OnClick.call(this,t),this._comp.HandleMouseClick(t)},o.prototype.PreOnMouseDown=function(t){o.superclass.PreOnMouseDown.call(this,t),this._comp.HandleMouseDown(t)},o.prototype.OnMouseWheel=function(t){this._comp.HandleMouseWheel(t)},o.prototype.OnTouchStartBubble=function(t){o.superclass.OnTouchStartBubble.call(this,t),this._comp.HandleTouchStart(t),this._comp.getCtx().getStage().getSVGRoot().parentNode.focus()},o.prototype.OnTouchEndBubble=function(t){o.superclass.OnTouchEndBubble.call(this,t),this._comp.HandleTouchEnd(t)},o.prototype._onDragStart=function(t){return!!this._comp.hasValidOptions()&&(e.Agent.isTouchDevice()?this._onTouchDragStart(t):this._onMouseDragStart(t))},o.prototype._onDragMove=function(t){return e.Agent.isTouchDevice()?this._onTouchDragMove(t):this._onMouseDragMove(t)},o.prototype._onDragEnd=function(t){return e.Agent.isTouchDevice()?this._onTouchDragEnd(t):this._onMouseDragEnd(t)},o.prototype._getRelativePosition=function(t,i){return this._stageAbsolutePosition||(this._stageAbsolutePosition=this._context.getStageAbsolutePosition()),new e.Point(t-this._stageAbsolutePosition.x,i-this._stageAbsolutePosition.y)},o.prototype._onMouseDragStart=function(t){if(t.button!=e.MouseEvent.RIGHT_CLICK_BUTTON){var i=this._getRelativePosition(t.pageX,t.pageY),s=this._getDragHandler(i);if(this._comp.IsPanningEnabled()){if(this._comp.getGraphicalAreaBounds().containsPoint(i.x,i.y)&&!this._isDragPanning)return this.hideTooltip(),this._comp.registerAndConstructGlassPane(),this._comp.setPanCursorDown(),this._comp.beginDragPan(i.x,i.y),this._isDragPanning=!0,!0}else if(s&&this._comp.IsMarqueeEnabled()){var n=s.processDragStart(i,t.ctrlKey);return n&&(n._relPos=i,this.ProcessMarqueeEvent(n)),this._comp.setCursor(s.getCursor(i)),!0}}return!1},o.prototype._onMouseDragMove=function(t){var e=this._getRelativePosition(t.pageX,t.pageY),i=this._getDragHandler();if(this._comp.IsPanningEnabled()&&this._comp.contDragPan(e.x,e.y)&&this._isDragPanning)this._comp.installGlassPane();else if(i&&this._comp.IsMarqueeEnabled()){var s=i.processDragMove(e,t.ctrlKey);s&&(s._relPos=e,this.ProcessMarqueeEvent(s))}},o.prototype._onMouseDragEnd=function(t){var e=this._getRelativePosition(t.pageX,t.pageY),i=this._getDragHandler();if(this._comp.IsPanningEnabled()&&this._isDragPanning)this._isDragPanning=!1,this._comp.endDragPan(),this._stageAbsolutePosition=null,this._comp.unregisterAndDestroyGlassPane(),this._comp.getGraphicalAreaBounds().containsPoint(e.x,e.y)?this._comp.setPanCursorUp():this._comp.setCursor("inherit");else if(i&&this._comp.IsMarqueeEnabled()){var s=i.processDragEnd(e,t.ctrlKey);s&&(s._relPos=e,this.ProcessMarqueeEvent(s)),this._comp.setCursor(i.getCursor(e))}},o.prototype.OnMouseMove=function(t){o.superclass.OnMouseMove.call(this,t);var e=this._getRelativePosition(t.pageX,t.pageY),i=this._getDragHandler();if(this._comp.getGraphicalAreaBounds().containsPoint(e.x,e.y)){if(this._comp.IsPanningEnabled())return void(this._isDragPanning?this._comp.setPanCursorDown():this._comp.setPanCursorUp());if(i)return void(this._comp.IsMarqueeEnabled()&&this._comp.setCursor(i.getCursor(e)))}this._comp.setCursor("inherit")},o.prototype._onTouchDragStart=function(t){var e=t.touches,i=this._comp.getGraphicalAreaBounds(),s=function(t){t.preventDefault(),this._comp.isDndEnabled()||t.stopPropagation()}.bind(this);if(1==e.length){var n=this._getRelativePosition(e[0].pageX,e[0].pageY),o=this._getDragHandler();if(i.containsPoint(n.x,n.y)){if(this._comp.IsPanningEnabled())return this._comp.beginDragPan(n.x,n.y),s(t),!0;if(o&&this._comp.IsMarqueeEnabled()){var a=o.processDragStart(n,!0);return a&&(a._relPos=n,this.ProcessMarqueeEvent(a)),this.getCtx().getTooltipManager().hideTooltip(),s(t),!0}}}else if(2==e.length){this._comp.IsPanningEnabled()&&this._comp.endDragPan(),this._isPinchZoom=!0;var r=this._getRelativePosition(e[0].pageX,e[0].pageY),h=this._getRelativePosition(e[1].pageX,e[1].pageY);if(i.containsPoint(r.x,r.y)&&i.containsPoint(h.x,h.y))return this._comp.beginPinchZoom(r.x,r.y,h.x,h.y),s(t),!0}return!1},o.prototype._onTouchDragMove=function(t){var e=t.touches;if(1==e.length){var i=this._getRelativePosition(e[0].pageX,e[0].pageY),s=this._getDragHandler();if(this._comp.IsPanningEnabled())this._comp.contDragPan(i.x,i.y),t.preventDefault();else if(s&&this._comp.IsMarqueeEnabled()){var n=s.processDragMove(i,!0);n&&(n._relPos=i,this.ProcessMarqueeEvent(n)),this.getCtx().getTooltipManager().hideTooltip(),t.preventDefault()}}else if(2==e.length){var o=this._getRelativePosition(e[0].pageX,e[0].pageY),a=this._getRelativePosition(e[1].pageX,e[1].pageY);this._comp.contPinchZoom(o.x,o.y,a.x,a.y),t.preventDefault()}},o.prototype._onTouchDragEnd=function(t){if(this._isPinchZoom)this._isPinchZoom=!1,this._comp.endPinchZoom(),t.preventDefault();else if(this._comp.IsPanningEnabled())this._comp.endDragPan(),t.preventDefault();else if(this._comp.IsMarqueeEnabled()){var e=this._getDragHandler();if(e)var i=e.processDragEnd(null,!0);i&&this.ProcessMarqueeEvent(i),t.preventDefault()}this._stageAbsolutePosition=null},o.prototype._getDragHandler=function(t){return t&&!this._comp.getGraphicalAreaBounds().containsPoint(t.x,t.y)?null:this._comp.isMarqueeSelectEnabled()?this._marqueeSelectHandler:null},o.prototype.setMarqueeSelectHandler=function(t){this._marqueeSelectHandler=t},o.prototype.ProcessMarqueeEvent=function(t){},o.prototype.cancelMarquee=function(t){this._comp.isMarqueeSelectEnabled()&&this._marqueeSelectHandler&&this._marqueeSelectHandler.cancelMarquee()},o.prototype.zoomBy=function(t){this._comp.zoomBy(t)},o.prototype.panBy=function(t,i){var s=t*this._comp._canvasLength*(e.Agent.isRightToLeft(this._context)?-1:1),n=i*this._comp._canvasSize;0!=s&&(this._comp._triggerViewportChange=!0),this._comp.panBy(s,n),this._comp.endPan()},o.prototype.HandleZoomInClick=function(t){this._comp.handleZoom(!0)},o.prototype.HandleZoomOutClick=function(t){this._comp.handleZoom(!1)},o.prototype.GetTouchResponse=function(){return e.EventManager.TOUCH_RESPONSE_TOUCH_HOLD};const a=function(t){this.Init(t)};e.Obj.createSubclass(a,e.KeyboardHandler),a.prototype.isSelectionEvent=function(t){return this.isNavigationEvent(t)&&!t.ctrlKey},a.prototype.isMultiSelectEvent=function(t){return t.keyCode==e.KeyboardEvent.SPACE&&t.ctrlKey},a.prototype.processKeyDown=function(t){if(e.KeyboardEvent.isPlus(t)||e.KeyboardEvent.isEquals(t))this._eventManager.HandleZoomInClick();else if(e.KeyboardEvent.isMinus(t)||e.KeyboardEvent.isUnderscore(t))this._eventManager.HandleZoomOutClick();else{var i=t.keyCode;i==e.KeyboardEvent.PAGE_UP?(t.shiftKey?this._eventManager.panBy(-.25,0):this._eventManager.panBy(0,-.25),e.EventManager.consumeEvent(t)):i==e.KeyboardEvent.PAGE_DOWN&&(t.shiftKey?this._eventManager.panBy(.25,0):this._eventManager.panBy(0,.25),e.EventManager.consumeEvent(t))}return a.superclass.processKeyDown.call(this,t)},t.TimeComponent=n,t.TimeComponentEventManager=o,t.TimeComponentKeyboardHandler=a,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ojdvt-timecomponent.js.map